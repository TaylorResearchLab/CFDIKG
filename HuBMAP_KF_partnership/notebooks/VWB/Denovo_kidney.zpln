{
  "paragraphs": [
    {
      "text": "%pyspark\nimport pandas as pd\npd.set_option('display.max_columns', None)\nimport numpy as np\nimport glob\nfrom collections import Counter\nimport matplotlib.pyplot as plt\nfrom matplotlib_venn import venn2\nimport io\nimport requests\nimport os\nfrom pyspark import SparkFiles\nfrom pyspark.sql import functions as F\nfrom pyspark.sql.functions import col,collect_list, concat, lit, when, monotonically_increasing_id, concat_ws \nfrom pyspark.sql.types import StringType",
      "user": "anonymous",
      "dateUpdated": "2022-09-16T15:52:01+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659442350763_2060251663",
      "id": "paragraph_1659442350763_2060251663",
      "dateCreated": "2022-08-02T12:12:30+0000",
      "dateStarted": "2022-09-16T15:52:01+0000",
      "dateFinished": "2022-09-16T15:53:35+0000",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:16258"
    },
    {
      "title": "Load Occurrences Table",
      "text": "%pyspark\n\nt_ocr = spark \\\n    .table('occurrences') \\\n    .where((F.col('study_id').isin('SD_NMVV8A1Y')))\n\nselect_ocr_cols = ['biospecimen_id', 'chromosome', 'start', 'end','reference', 'alternate', 'name', 'hgvsg','variant_class','is_proband','quality','info_dp']\n\nt_ocr_select = t_ocr.select(select_ocr_cols).withColumn('unique_variant_id',concat(col(\"chromosome\"), lit(\":\"),\n                                                   col(\"start\"),lit(':'),col('reference'),lit(':'),col('alternate')))\nt_ocr_select.count()",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T12:02:05+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "945290109"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=0",
              "$$hashKey": "object:17787"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=1",
              "$$hashKey": "object:17788"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=2",
              "$$hashKey": "object:17789"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=3",
              "$$hashKey": "object:17790"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=4",
              "$$hashKey": "object:17791"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=5",
              "$$hashKey": "object:17792"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=6",
              "$$hashKey": "object:17793"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=7",
              "$$hashKey": "object:17794"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=8",
              "$$hashKey": "object:17795"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=9",
              "$$hashKey": "object:17796"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=10",
              "$$hashKey": "object:17797"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=11",
              "$$hashKey": "object:17798"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=12",
              "$$hashKey": "object:17799"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=13",
              "$$hashKey": "object:17800"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=14",
              "$$hashKey": "object:17801"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=15",
              "$$hashKey": "object:17802"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=16",
              "$$hashKey": "object:17803"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=17",
              "$$hashKey": "object:17804"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=18",
              "$$hashKey": "object:17805"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=19",
              "$$hashKey": "object:17806"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=20",
              "$$hashKey": "object:17807"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=21",
              "$$hashKey": "object:17808"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=22",
              "$$hashKey": "object:17809"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=23",
              "$$hashKey": "object:17810"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=24",
              "$$hashKey": "object:17811"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=25",
              "$$hashKey": "object:17812"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=26",
              "$$hashKey": "object:17813"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=27",
              "$$hashKey": "object:17814"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=28",
              "$$hashKey": "object:17815"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=29",
              "$$hashKey": "object:17816"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=30",
              "$$hashKey": "object:17817"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=31",
              "$$hashKey": "object:17818"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=32",
              "$$hashKey": "object:17819"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=33",
              "$$hashKey": "object:17820"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=34",
              "$$hashKey": "object:17821"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=35",
              "$$hashKey": "object:17822"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=36",
              "$$hashKey": "object:17823"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=37",
              "$$hashKey": "object:17824"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=38",
              "$$hashKey": "object:17825"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=39",
              "$$hashKey": "object:17826"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=40",
              "$$hashKey": "object:17827"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=41",
              "$$hashKey": "object:17828"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=42",
              "$$hashKey": "object:17829"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=43",
              "$$hashKey": "object:17830"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=44",
              "$$hashKey": "object:17831"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659442443016_2095558806",
      "id": "paragraph_1659442443016_2095558806",
      "dateCreated": "2022-08-02T12:14:03+0000",
      "dateStarted": "2022-09-14T12:02:13+0000",
      "dateFinished": "2022-09-14T12:11:59+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16259"
    },
    {
      "text": "%pyspark\n\nt_ocr_KUTD = spark \\\n    .table('occurrences') \\\n    .where((F.col('study_id').isin('SD_NMVV8A1Y'))) # Kidney and Urinary Tract Defects Cohort Study ID\n\n#bs_id_KUTD = t_ocr_KUTD.select('biospecimen_id').distinct().toPandas()['biospecimen_id']\n",
      "user": "anonymous",
      "dateUpdated": "2022-09-15T11:54:34+0000",
      "progress": 68,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659626530339_1257278019",
      "id": "paragraph_1659626530339_1257278019",
      "dateCreated": "2022-08-04T15:22:10+0000",
      "dateStarted": "2022-09-14T12:03:35+0000",
      "dateFinished": "2022-09-14T12:11:59+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16260"
    },
    {
      "text": "%pyspark\n#t_ocr_CHD = spark \\\n#    .table('occurrences') \\\n#    .where((F.col('study_id').isin('SD_PREASA7S'))) # Congenital Heart Defects Cohort Study ID\n    \n#bs_id_CHD = t_ocr_CHD.select('biospecimen_id').distinct().toPandas()['biospecimen_id']",
      "user": "anonymous",
      "dateUpdated": "2022-09-13T21:59:16+0000",
      "progress": 97,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-9.ec2.internal:4040/jobs/job?id=129",
              "$$hashKey": "object:18097"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659635018163_341449842",
      "id": "paragraph_1659635018163_341449842",
      "dateCreated": "2022-08-04T17:43:38+0000",
      "dateStarted": "2022-08-04T17:45:22+0000",
      "dateFinished": "2022-08-04T17:47:00+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16261"
    },
    {
      "title": "Query Occurrences Table for De Novo variants",
      "text": "%pyspark\ndenovos = t_ocr_select.where((col('is_hi_conf_denovo') == True) & (col('is_proband') == True) ) #  | (col('Impact') == 'High')\ndenovos.count()",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T12:02:19+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "165741"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=45",
              "$$hashKey": "object:18155"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659442442555_1127437842",
      "id": "paragraph_1659442442555_1127437842",
      "dateCreated": "2022-08-02T12:14:02+0000",
      "dateStarted": "2022-09-14T12:11:59+0000",
      "dateFinished": "2022-09-14T12:12:26+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16262"
    },
    {
      "text": "%pyspark\n#denovo_bs_id = denovos.select('biospecimen_id').distinct().toPandas()['biospecimen_id']\n#denovo_bs_id",
      "user": "anonymous",
      "dateUpdated": "2022-09-13T21:59:36+0000",
      "progress": 68,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659635484623_178351735",
      "id": "paragraph_1659635484623_178351735",
      "dateCreated": "2022-08-04T17:51:24+0000",
      "dateStarted": "2022-08-04T17:53:24+0000",
      "dateFinished": "2022-08-04T17:53:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16263"
    },
    {
      "title": "Load Consequences Table",
      "text": "%pyspark\nt_csq = spark \\\n    .table('consequences') \\\n    .withColumnRenamed('name', 'rsID')\\\n    .drop('variant_class')\\\n    .where( (F.array_contains( F.col('study_ids'),'SD_NMVV8A1Y' )) & (F.col('original_canonical') == 'true')) \n\nt_csq_select = t_csq.select(['chromosome','start', 'reference','alternate','rsID','impact','symbol'\n                                ,'biotype','hgvsc','hgvsg','feature_type','strand','consequences'])\\\n                                .withColumn('unique_variant_id',concat(col(\"chromosome\"), lit(\":\"),\n                                 col(\"start\"),lit(':'),col('reference'),lit(':'),col('alternate')))\n\n#gene_var_map = t_csq_select.select('unique_variant_id','symbol').drop_duplicates(['unique_variant_id'])\nt_csq_select.count()",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T12:02:23+0000",
      "progress": 99,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "14557392"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=46",
              "$$hashKey": "object:18255"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659442441845_2007513184",
      "id": "paragraph_1659442441845_2007513184",
      "dateCreated": "2022-08-02T12:14:01+0000",
      "dateStarted": "2022-09-14T12:12:00+0000",
      "dateFinished": "2022-09-14T12:12:49+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16264"
    },
    {
      "title": "Get CADD scores for all protein coding vars gt20",
      "text": "%pyspark\n\n# get all pc vars\nall_pcs = t_csq_select.where(col('biotype') == 'protein_coding')\n    \nall_pcs_snps = all_pcs.where(  ~( (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1) ) )    \nall_pcs_indels = all_pcs.where(  (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1)  )\n\n# score snps\ncadd_snps_gt20= spark.read.parquet(\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/cadd_scores_gt20/cadd_gt20_snps_2.parquet\")\nall_pcs_snps_gt20_scored = all_pcs_snps.join(cadd_snps_gt20.select('unique_variant_id','cadd_score'),'unique_variant_id','left')\nall_pcs_snps_gt20_scored_nonNUll = all_pcs_snps_gt20_scored.where(~col('cadd_score').isNull())\n#print(all_pcs_snps_gt20_scored_nonNUll.count())\n\n# score indels\ncadd_indels_gt20= spark.read.parquet(\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/cadd_scores_gt20/cadd_gt20_gnomAD_all_chroms.parquet\")\nall_pcs_indels_gt20_scored = all_pcs_indels.join(cadd_indels_gt20.select('unique_variant_id','cadd_score'),'unique_variant_id','left')\nall_pcs_indels_gt20_scored_nonNUll = all_pcs_indels_gt20_scored.where(~col('cadd_score').isNull())\n#print(all_pcs_indels_gt20_scored_nonNUll.count())\n\n# union\nall_pcs_gt20_scored = all_pcs_snps_gt20_scored_nonNUll.union(all_pcs_indels_gt20_scored_nonNUll)\n\n# get all proband variants\npbs = t_ocr_select.where(col('is_proband') == True).drop('chromosome','start','reference','alternate','hgvsg')\n\n# join together so we have all proband protein coding variants (not just a unique list of pc vars)\nall_pcs_gt20_perPerson = pbs.join(all_pcs_gt20_scored,'unique_variant_id','left')\n\nall_pcs_gt20_perPerson_nonNull = all_pcs_gt20_perPerson.where(~col('cadd_score').isNull())\n#all_pcs_gt20_perPerson_nonNull.show()\n#all_pcs_gt20_perPerson_nonNull.count()\n\n# add identifiier cols\nall_pcs_gt20_perPerson_nonNull = all_pcs_gt20_perPerson_nonNull.withColumn('High_Impact_boolean',lit(0))\\\n                                                .withColumn('DeNovo_boolean',lit(0))\\\n                                                .withColumn('gt20_boolean',lit(1))\nall_pcs_gt20_perPerson_nonNull.count()",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T12:03:19+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "291284"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=47",
              "$$hashKey": "object:18313"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=48",
              "$$hashKey": "object:18314"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=50",
              "$$hashKey": "object:18315"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659626326232_779290455",
      "id": "paragraph_1659626326232_779290455",
      "dateCreated": "2022-08-04T15:18:46+0000",
      "dateStarted": "2022-09-14T12:12:26+0000",
      "dateFinished": "2022-09-14T12:14:49+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16265"
    },
    {
      "title": "Use Consequences table to filter De Novo variants for High and Moderate Impact only",
      "text": "%pyspark\ndenovos_hiMod = denovos.join(t_csq_select.select('unique_variant_id','impact','biotype','consequences'),'unique_variant_id','left')\\\n                                                      .where( (col('impact') == 'HIGH') | (col('impact') == 'MODERATE'))\n                                                      \n#denovos_hiMod = denovos_hiMod.drop_duplicates(['unique_variant_id'])                                                      \nprint(denovos_hiMod.count())\ndenovos_hiMod.show(5)",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T12:19:40+0000",
      "progress": 99,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "719\n+-----------------+--------------+----------+---------+---------+---------+---------+----------+-------------------+-------------+----------+-------+-------+--------+--------------+------------------+\n|unique_variant_id|biospecimen_id|chromosome|    start|      end|reference|alternate|      name|              hgvsg|variant_class|is_proband|quality|info_dp|  impact|       biotype|      consequences|\n+-----------------+--------------+----------+---------+---------+---------+---------+----------+-------------------+-------------+----------+-------+-------+--------+--------------+------------------+\n|  17:21703655:C:T|   BS_G91Y4285|        17| 21703655| 21703656|        C|        T|      null|chr17:g.21703655C>T|          SNV|      true|  91.25|    159|MODERATE|protein_coding|[missense_variant]|\n|  17:21703655:C:T|   BS_1K4A5PQ4|        17| 21703655| 21703656|        C|        T|      null|chr17:g.21703655C>T|          SNV|      true| 102.25|    125|MODERATE|protein_coding|[missense_variant]|\n|  5:141201351:C:A|   BS_1K4A5PQ4|         5|141201351|141201352|        C|        A|      null|chr5:g.141201351C>A|          SNV|      true| 104.25|    146|MODERATE|protein_coding|[missense_variant]|\n|   11:1017900:G:T|   BS_KPA7TQ14|        11|  1017900|  1017901|        G|        T|rs77920671| chr11:g.1017900G>T|          SNV|      true| 209.25|    441|MODERATE|protein_coding|[missense_variant]|\n|  20:41164168:A:C|   BS_6GVEAVTX|        20| 41164168| 41164169|        A|        C|      null|chr20:g.41164168A>C|          SNV|      true|  88.25|    123|MODERATE|protein_coding|[missense_variant]|\n+-----------------+--------------+----------+---------+---------+---------+---------+----------+-------------------+-------------+----------+-------+-------+--------+--------------+------------------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=53",
              "$$hashKey": "object:18381"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=54",
              "$$hashKey": "object:18382"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=55",
              "$$hashKey": "object:18383"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=56",
              "$$hashKey": "object:18384"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659442440884_879107650",
      "id": "paragraph_1659442440884_879107650",
      "dateCreated": "2022-08-02T12:14:00+0000",
      "dateStarted": "2022-09-14T12:19:40+0000",
      "dateFinished": "2022-09-14T12:22:00+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16266"
    },
    {
      "title": "Score De Novo SNPs",
      "text": "%pyspark\ndenovos_hiMod_SNPs = denovos_hiMod.where(  ~( (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1) ) )\nchroms = ['1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '22', '3', '4', '5', '6', '7','8', '9', 'X','Y']\n\nfor n,CHROM in enumerate(chroms):\n    cadd_chrom = spark.read.parquet(f\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/cadd_scores/cadd_chrom_files_parquet/chr{CHROM}\")\n\n    cadd_chrom = cadd_chrom.select(col(\"0\").alias(\"chromosome\"), col(\"1\").alias(\"start\"),col(\"2\").alias(\"reference\"),col(\"3\").alias(\"alternate\"),\n                                   col('5').alias(\"CADD_score\")).withColumn('unique_variant_id',concat(col(\"chromosome\"), lit(\":\"),\n                                   col(\"start\"),lit(':'),col('reference'),lit(':'),col('alternate')))\n         \n    denovos_hiMod_SNPs_chrom = denovos_hiMod_SNPs.where(col(\"chromosome\") == CHROM)\n    \n    print(f\"Joining CADD scores for chromosome {CHROM} ({denovos_hiMod_SNPs_chrom.count()} x {cadd_chrom.count()})...\",end=\"\")\n    \n    deNovo_results_chrom = denovos_hiMod_SNPs_chrom.join(cadd_chrom.select('unique_variant_id','cadd_score'), ['unique_variant_id'], \"left\")\n    \n    print(f\"Done...Result is {deNovo_results_chrom.count()} rows long.\")\n    \n    if n == 0: deNovo_SNPs_full =  deNovo_results_chrom\n    else: deNovo_SNPs_full = deNovo_SNPs_full.union(deNovo_results_chrom)",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T16:09:46+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Joining CADD scores for chromosome 1 (35 x 691443036)...Done...Result is 35 rows long.\nJoining CADD scores for chromosome 10 (12 x 399788886)...Done...Result is 12 rows long.\nJoining CADD scores for chromosome 11 (166 x 403601226)...Done...Result is 166 rows long.\nJoining CADD scores for chromosome 12 (53 x 399413448)...Done...Result is 53 rows long.\nJoining CADD scores for chromosome 13 (3 x 293949375)...Done...Result is 3 rows long.\nJoining CADD scores for chromosome 14 (28 x 271704447)...Done...Result is 28 rows long.\nJoining CADD scores for chromosome 15 (8 x 253923975)...Done...Result is 8 rows long.\nJoining CADD scores for chromosome 16 (12 x 245417829)...Done...Result is 12 rows long.\nJoining CADD scores for chromosome 17 (18 x 248760612)...Done...Result is 18 rows long.\nJoining CADD scores for chromosome 18 (11 x 240268815)...Done...Result is 11 rows long.\nJoining CADD scores for chromosome 19 (71 x 175322274)...Done...Result is 71 rows long.\nJoining CADD scores for chromosome 2 (21 x 721644684)...Done...Result is 21 rows long.\nJoining CADD scores for chromosome 20 (2 x 191832771)...Done...Result is 2 rows long.\nJoining CADD scores for chromosome 22 (12 x 117479331)...Done...Result is 12 rows long.\nJoining CADD scores for chromosome 3 (34 x 594300405)...Done...Result is 34 rows long.\nJoining CADD scores for chromosome 4 (11 x 569258001)...Done...Result is 11 rows long.\nJoining CADD scores for chromosome 5 (16 x 543796134)...Done...Result is 16 rows long.\nJoining CADD scores for chromosome 6 (35 x 510235566)...Done...Result is 35 rows long.\nJoining CADD scores for chromosome 7 (101 x 476910393)...Done...Result is 101 rows long.\nJoining CADD scores for chromosome 8 (11 x 434304408)...Done...Result is 11 rows long.\nJoining CADD scores for chromosome 9 (15 x 365371650)...Done...Result is 15 rows long.\nJoining CADD scores for chromosome X (1 x 464679087)...Done...Result is 1 rows long.\nJoining CADD scores for chromosome Y (0 x 79245129)...Done...Result is 0 rows long.\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=167",
              "$$hashKey": "object:18454"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=168",
              "$$hashKey": "object:18455"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=169",
              "$$hashKey": "object:18456"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=170",
              "$$hashKey": "object:18457"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=171",
              "$$hashKey": "object:18458"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=172",
              "$$hashKey": "object:18459"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=173",
              "$$hashKey": "object:18460"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=174",
              "$$hashKey": "object:18461"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=175",
              "$$hashKey": "object:18462"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=176",
              "$$hashKey": "object:18463"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=177",
              "$$hashKey": "object:18464"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=178",
              "$$hashKey": "object:18465"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=179",
              "$$hashKey": "object:18466"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=180",
              "$$hashKey": "object:18467"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=181",
              "$$hashKey": "object:18468"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=182",
              "$$hashKey": "object:18469"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=183",
              "$$hashKey": "object:18470"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=184",
              "$$hashKey": "object:18471"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=185",
              "$$hashKey": "object:18472"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=186",
              "$$hashKey": "object:18473"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=187",
              "$$hashKey": "object:18474"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=188",
              "$$hashKey": "object:18475"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=189",
              "$$hashKey": "object:18476"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=190",
              "$$hashKey": "object:18477"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=191",
              "$$hashKey": "object:18478"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=192",
              "$$hashKey": "object:18479"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=193",
              "$$hashKey": "object:18480"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=194",
              "$$hashKey": "object:18481"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=195",
              "$$hashKey": "object:18482"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=196",
              "$$hashKey": "object:18483"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=197",
              "$$hashKey": "object:18484"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=198",
              "$$hashKey": "object:18485"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=199",
              "$$hashKey": "object:18486"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=200",
              "$$hashKey": "object:18487"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=201",
              "$$hashKey": "object:18488"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=202",
              "$$hashKey": "object:18489"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=203",
              "$$hashKey": "object:18490"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=204",
              "$$hashKey": "object:18491"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=205",
              "$$hashKey": "object:18492"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=206",
              "$$hashKey": "object:18493"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=207",
              "$$hashKey": "object:18494"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=208",
              "$$hashKey": "object:18495"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=209",
              "$$hashKey": "object:18496"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=210",
              "$$hashKey": "object:18497"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=211",
              "$$hashKey": "object:18498"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=212",
              "$$hashKey": "object:18499"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=213",
              "$$hashKey": "object:18500"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=214",
              "$$hashKey": "object:18501"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=215",
              "$$hashKey": "object:18502"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=216",
              "$$hashKey": "object:18503"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=217",
              "$$hashKey": "object:18504"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=218",
              "$$hashKey": "object:18505"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=219",
              "$$hashKey": "object:18506"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=220",
              "$$hashKey": "object:18507"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=221",
              "$$hashKey": "object:18508"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=222",
              "$$hashKey": "object:18509"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=223",
              "$$hashKey": "object:18510"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=224",
              "$$hashKey": "object:18511"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=225",
              "$$hashKey": "object:18512"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=226",
              "$$hashKey": "object:18513"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=227",
              "$$hashKey": "object:18514"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=228",
              "$$hashKey": "object:18515"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=229",
              "$$hashKey": "object:18516"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=230",
              "$$hashKey": "object:18517"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=231",
              "$$hashKey": "object:18518"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=232",
              "$$hashKey": "object:18519"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=233",
              "$$hashKey": "object:18520"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=234",
              "$$hashKey": "object:18521"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=235",
              "$$hashKey": "object:18522"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=236",
              "$$hashKey": "object:18523"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=237",
              "$$hashKey": "object:18524"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=238",
              "$$hashKey": "object:18525"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=239",
              "$$hashKey": "object:18526"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=240",
              "$$hashKey": "object:18527"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=241",
              "$$hashKey": "object:18528"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=242",
              "$$hashKey": "object:18529"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=243",
              "$$hashKey": "object:18530"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=244",
              "$$hashKey": "object:18531"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=245",
              "$$hashKey": "object:18532"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=246",
              "$$hashKey": "object:18533"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=247",
              "$$hashKey": "object:18534"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=248",
              "$$hashKey": "object:18535"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=249",
              "$$hashKey": "object:18536"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=250",
              "$$hashKey": "object:18537"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=251",
              "$$hashKey": "object:18538"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=252",
              "$$hashKey": "object:18539"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=253",
              "$$hashKey": "object:18540"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=254",
              "$$hashKey": "object:18541"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=255",
              "$$hashKey": "object:18542"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=257",
              "$$hashKey": "object:18543"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=258",
              "$$hashKey": "object:18544"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=260",
              "$$hashKey": "object:18545"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659570270082_1323578921",
      "id": "paragraph_1659570270082_1323578921",
      "dateCreated": "2022-08-03T23:44:30+0000",
      "dateStarted": "2022-09-14T16:09:46+0000",
      "dateFinished": "2022-09-14T17:00:46+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16267"
    },
    {
      "title": "Score De Novo Indels",
      "text": "%pyspark\ndenovos_hiMod_indels = denovos_hiMod.where(  (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1)  )\ncadd_gnomad_chrom = spark.read.parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/cadd_scores/cadd_gnomad_all.parquet')\n'''\nfor n,CHROM in enumerate(chroms):\n\n    cadd_chrom =  cadd_gnomad_chrom.where(col('chromosome') == CHROM)\n    denovos_hiMod_indels_chrom = denovos_hiMod_indels.where(col('chromosome') == CHROM)\n\n    num2join = denovos_hiMod_indels_chrom.count()\n    print(f'Joining CADD scores for chromosome {CHROM} ({cadd_chrom.count()} x {denovos_hiMod_indels_chrom.count()})...',end='')\n    \n    deNovo_results_chrom = denovos_hiMod_indels_chrom.join(cadd_chrom.select('unique_variant_id','cadd_score'), [\"unique_variant_id\"], \"left\")\n    \n    print(f'Done...Result is {deNovo_results_chrom.count()} rows long.')\n    \n    if n == 0: deNovo_indels_full =  deNovo_results_chrom\n    else: deNovo_indels_full = deNovo_indels_full.union(deNovo_results_chrom)'''",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T16:09:50+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "'\\nfor n,CHROM in enumerate(chroms):\\n\\n    cadd_chrom =  cadd_gnomad_chrom.where(col(\\'chromosome\\') == CHROM)\\n    denovos_hiMod_indels_chrom = denovos_hiMod_indels.where(col(\\'chromosome\\') == CHROM)\\n\\n    num2join = denovos_hiMod_indels_chrom.count()\\n    print(f\\'Joining CADD scores for chromosome {CHROM} ({cadd_chrom.count()} x {denovos_hiMod_indels_chrom.count()})...\\',end=\\'\\')\\n    \\n    deNovo_results_chrom = denovos_hiMod_indels_chrom.join(cadd_chrom.select(\\'unique_variant_id\\',\\'cadd_score\\'), [\"unique_variant_id\"], \"left\")\\n    \\n    print(f\\'Done...Result is {deNovo_results_chrom.count()} rows long.\\')\\n    \\n    if n == 0: deNovo_indels_full =  deNovo_results_chrom\\n    else: deNovo_indels_full = deNovo_indels_full.union(deNovo_results_chrom)'"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=261",
              "$$hashKey": "object:18967"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659570269446_1690772648",
      "id": "paragraph_1659570269446_1690772648",
      "dateCreated": "2022-08-03T23:44:29+0000",
      "dateStarted": "2022-09-14T16:09:51+0000",
      "dateFinished": "2022-09-14T17:00:48+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16268"
    },
    {
      "text": "%pyspark\n\ndeNovo_indels_full = denovos_hiMod_indels.join(cadd_gnomad_chrom.select('unique_variant_id','cadd_score'), [\"unique_variant_id\"], \"left\")\ndeNovo_indels_full.count()",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T16:10:07+0000",
      "progress": 90,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "34"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=262",
              "$$hashKey": "object:19025"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659641041762_1023381273",
      "id": "paragraph_1659641041762_1023381273",
      "dateCreated": "2022-08-04T19:24:01+0000",
      "dateStarted": "2022-09-14T17:00:46+0000",
      "dateFinished": "2022-09-14T17:01:51+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16269"
    },
    {
      "text": "%pyspark\n\nassert list(deNovo_indels_full.columns) == list(deNovo_SNPs_full.columns)\n\ndeNovos_scored = deNovo_SNPs_full.union(deNovo_indels_full)\ndeNovos_scored = deNovos_scored.withColumn('DeNovo_boolean', lit(1))\n\nprint(deNovos_scored.count())\ndeNovos_scored.show(3)",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T16:10:11+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "710\n+-----------------+--------------+----------+--------+--------+---------+---------+-----------+------------------+-------------+----------+-------+-------+--------+--------------+------------------+----------+--------------+\n|unique_variant_id|biospecimen_id|chromosome|   start|     end|reference|alternate|       name|             hgvsg|variant_class|is_proband|quality|info_dp|  impact|       biotype|      consequences|cadd_score|DeNovo_boolean|\n+-----------------+--------------+----------+--------+--------+---------+---------+-----------+------------------+-------------+----------+-------+-------+--------+--------------+------------------+----------+--------------+\n|   1:88983554:T:A|   BS_CET1373K|         1|88983554|88983555|        T|        A|rs200727134|chr1:g.88983554T>A|          SNV|      true| 200.25|    138|MODERATE|protein_coding|[missense_variant]|     9.035|             1|\n|   1:40824150:G:A|   BS_VGWDQ3F9|         1|40824150|40824151|        G|        A|       null|chr1:g.40824150G>A|          SNV|      true| 835.25|    144|MODERATE|protein_coding|[missense_variant]|      23.2|             1|\n|   1:88983241:T:C|   BS_ZF69BK6Q|         1|88983241|88983242|        T|        C|       null|chr1:g.88983241T>C|          SNV|      true| 117.25|    125|MODERATE|protein_coding|[missense_variant]|     17.75|             1|\n+-----------------+--------------+----------+--------+--------+---------+---------+-----------+------------------+-------------+----------+-------+-------+--------+--------------+------------------+----------+--------------+\nonly showing top 3 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=264",
              "$$hashKey": "object:19083"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=265",
              "$$hashKey": "object:19084"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=266",
              "$$hashKey": "object:19085"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=267",
              "$$hashKey": "object:19086"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=268",
              "$$hashKey": "object:19087"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659570268966_1701981163",
      "id": "paragraph_1659570268966_1701981163",
      "dateCreated": "2022-08-03T23:44:28+0000",
      "dateStarted": "2022-09-14T17:00:48+0000",
      "dateFinished": "2022-09-14T17:29:14+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16270"
    },
    {
      "title": "Query Consequences Table for High Impact variants",
      "text": "%pyspark\n'''   ALREADY FOUND HIGH IIMPACT VARIANTS AND SCORED THEM, SAVED AS ~/tables/hiImpact_scored_KUTD.parquet\n\nhighImpact = t_csq_select.where(col('impact') == 'HIGH').drop('hgvsc','hgvsg','feature_type','strand')\nprint(highImpact.count())\nhighImpact.show(3)'''",
      "user": "anonymous",
      "dateUpdated": "2022-09-15T11:56:56+0000",
      "progress": 75,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659570268546_2095165641",
      "id": "paragraph_1659570268546_2095165641",
      "dateCreated": "2022-08-03T23:44:28+0000",
      "dateStarted": "2022-09-14T12:28:23+0000",
      "dateFinished": "2022-09-14T12:28:58+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16271"
    },
    {
      "title": "Find CADD scores for high impact snps",
      "text": "%pyspark\n\n'''   ALREADY FOUND HIGH IIMPACT VARIANTS AND SCORED THEM, SAVED AS ~/tables/hiImpact_scored_KUTD.parquet\n\nhighImpact_SNPs = highImpact.where(  ~( (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1) ) )\nchroms = ['1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '22', '3', '4', '5', '6', '7','8', '9', 'X','Y']\n\nfor n,CHROM in enumerate(chroms):\n    cadd_chrom = spark.read.parquet(f\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/cadd_scores/cadd_chrom_files_parquet/chr{CHROM}\")\n\n    cadd_chrom = cadd_chrom.select(col(\"0\").alias(\"chromosome\"), col(\"1\").alias(\"start\"),col(\"2\").alias(\"reference\"),col(\"3\").alias(\"alternate\"),\n                                   col('5').alias(\"CADD_score\")).withColumn('unique_variant_id',concat(col(\"chromosome\"), lit(\":\"),\n                                   col(\"start\"),lit(':'),col('reference'),lit(':'),col('alternate')))\n         \n    highImpact_SNPs_chrom = highImpact_SNPs.where(col(\"chromosome\") == CHROM)\n    hiImpact_results_chrom = highImpact_SNPs_chrom.join(cadd_chrom.select('unique_variant_id','cadd_score'), ['unique_variant_id'], \"left\")\n    if n == 0: hiImpact_SNPs_full =  hiImpact_results_chrom\n    else: hiImpact_SNPs_full = hiImpact_SNPs_full.union(hiImpact_results_chrom)\n    \nprint(highImpact_SNPs.count())\nprint(hiImpact_SNPs_full.count())'''",
      "user": "anonymous",
      "dateUpdated": "2022-09-15T11:59:37+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=60",
              "$$hashKey": "object:19193"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=61",
              "$$hashKey": "object:19194"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=62",
              "$$hashKey": "object:19195"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=63",
              "$$hashKey": "object:19196"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=64",
              "$$hashKey": "object:19197"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=65",
              "$$hashKey": "object:19198"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=66",
              "$$hashKey": "object:19199"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=67",
              "$$hashKey": "object:19200"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=68",
              "$$hashKey": "object:19201"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=69",
              "$$hashKey": "object:19202"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=70",
              "$$hashKey": "object:19203"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=71",
              "$$hashKey": "object:19204"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=72",
              "$$hashKey": "object:19205"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=73",
              "$$hashKey": "object:19206"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=74",
              "$$hashKey": "object:19207"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=75",
              "$$hashKey": "object:19208"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=76",
              "$$hashKey": "object:19209"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=77",
              "$$hashKey": "object:19210"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=78",
              "$$hashKey": "object:19211"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=79",
              "$$hashKey": "object:19212"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=80",
              "$$hashKey": "object:19213"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=81",
              "$$hashKey": "object:19214"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=82",
              "$$hashKey": "object:19215"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663107337500_584528599",
      "id": "paragraph_1663107337500_584528599",
      "dateCreated": "2022-09-13T22:15:37+0000",
      "dateStarted": "2022-09-14T12:29:08+0000",
      "dateFinished": "2022-09-14T12:29:19+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16272"
    },
    {
      "title": "Find CADD scores for high impact indels",
      "text": "%pyspark\n'''   ALREADY FOUND HIGH IIMPACT VARIANTS AND SCORED THEM, SAVED AS ~/tables/hiImpact_scored_KUTD.parquet\n\nhighImpact_indels = highImpact.where(  (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1)  )\nchroms = ['1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '22', '3', '4', '5', '6', '7','8', '9', 'X','Y']\n\nfor n,CHROM in enumerate(chroms):\n    cadd_chrom = spark.read.parquet(f\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/cadd_scores/cadd_chrom_files_parquet/chr{CHROM}\")\n\n    cadd_chrom = cadd_chrom.select(col(\"0\").alias(\"chromosome\"), col(\"1\").alias(\"start\"),col(\"2\").alias(\"reference\"),col(\"3\").alias(\"alternate\"),\n                                   col('5').alias(\"CADD_score\")).withColumn('unique_variant_id',concat(col(\"chromosome\"), lit(\":\"),\n                                   col(\"start\"),lit(':'),col('reference'),lit(':'),col('alternate')))\n         \n    highImpact_indels_chrom = highImpact_indels.where(col(\"chromosome\") == CHROM)\n    hiImpact_results_chrom = highImpact_indels_chrom.join(cadd_chrom.select('unique_variant_id','cadd_score'), ['unique_variant_id'], \"left\")\n\n    if n == 0: hiImpact_indels_full =  hiImpact_results_chrom\n    else: hiImpact_indels_full = hiImpact_indels_full.union(hiImpact_results_chrom) \nprint(highImpact_indels.count())\nprint(hiImpact_indels_full.count())\nhiImpact_indels_full.where(col('cadd_score').isNull()).count()'''\n\n#hiImpact_scored = hiImpact_SNPs_full.union(hiImpact_indels_full)\n#hiImpact_scored.count()\n\n#hiImpact_scored.repartition(200,'unique_variant_id').write.mode('overwrite').parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/hiImpact_scored_KUTD.parquet')",
      "user": "anonymous",
      "dateUpdated": "2022-09-15T11:59:48+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=131",
              "$$hashKey": "object:19351"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=132",
              "$$hashKey": "object:19352"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=133",
              "$$hashKey": "object:19353"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=134",
              "$$hashKey": "object:19354"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=135",
              "$$hashKey": "object:19355"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=136",
              "$$hashKey": "object:19356"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=137",
              "$$hashKey": "object:19357"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=138",
              "$$hashKey": "object:19358"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=139",
              "$$hashKey": "object:19359"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=140",
              "$$hashKey": "object:19360"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=141",
              "$$hashKey": "object:19361"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=142",
              "$$hashKey": "object:19362"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=143",
              "$$hashKey": "object:19363"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=144",
              "$$hashKey": "object:19364"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=145",
              "$$hashKey": "object:19365"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=146",
              "$$hashKey": "object:19366"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=147",
              "$$hashKey": "object:19367"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=148",
              "$$hashKey": "object:19368"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=149",
              "$$hashKey": "object:19369"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=150",
              "$$hashKey": "object:19370"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=151",
              "$$hashKey": "object:19371"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=152",
              "$$hashKey": "object:19372"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=153",
              "$$hashKey": "object:19373"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663107365963_536071802",
      "id": "paragraph_1663107365963_536071802",
      "dateCreated": "2022-09-13T22:16:05+0000",
      "dateStarted": "2022-09-14T15:39:21+0000",
      "dateFinished": "2022-09-14T15:39:32+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16273"
    },
    {
      "title": "Load in cadd-scored high impact variants",
      "text": "%pyspark\nhighImpact_CADD_scores = spark.read.parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/hiImpact_scored_KUTD.parquet')\nprint(highImpact_CADD_scores.count())\nhighImpact_CADD_scores.show(5)\n",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T16:03:08+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "3656\n+--------------------+----------+---------+--------------------+---------+-----------+------+----------+--------------------+--------------------+----------+\n|   unique_variant_id|chromosome|    start|           reference|alternate|       rsID|impact|    symbol|             biotype|        consequences|cadd_score|\n+--------------------+----------+---------+--------------------+---------+-----------+------+----------+--------------------+--------------------+----------+\n|     2:108381845:C:T|         2|108381845|                   C|        T| rs77662685|  HIGH|   SULT1C4|      protein_coding|       [stop_gained]|      35.0|\n|     8:142682113:G:A|         8|142682113|                   G|        A|rs138377917|  HIGH|      PSCA|      protein_coding|       [stop_gained]|      46.0|\n|2:153208061:ATTTT...|         2|153208061|ATTTTTTTTTTTTTTTT...|        A| rs70977588|  HIGH|AC079150.2|processed_pseudogene|[transcript_ablat...|      null|\n|     2:65020984:GA:G|         2| 65020984|                  GA|        G|       null|  HIGH|    SLC1A4|      protein_coding|[frameshift_variant]|      null|\n|    14:103574113:G:T|        14|103574113|                   G|        T|       null|  HIGH|AL139300.1|      protein_coding|       [stop_gained]|      39.0|\n+--------------------+----------+---------+--------------------+---------+-----------+------+----------+--------------------+--------------------+----------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=159",
              "$$hashKey": "object:19519"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=160",
              "$$hashKey": "object:19520"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=161",
              "$$hashKey": "object:19521"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659570267392_1618320488",
      "id": "paragraph_1659570267392_1618320488",
      "dateCreated": "2022-08-03T23:44:27+0000",
      "dateStarted": "2022-09-14T16:03:08+0000",
      "dateFinished": "2022-09-14T16:03:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16274"
    },
    {
      "title": "Merge scored High Impact variants with Occurrences table so we can have variants per person",
      "text": "%pyspark\n\n#highImpact_perPerson_probands_pc = highImpact_perPerson_probands.where( (col('biotype') == 'protein_coding') )\n#print(highImpact_perPerson_probands_pc.count())\n\n#high_impact_perPerson_scored = highImpact_CADD_scores.select('unique_variant_id','cadd_score').join(highImpact_perPerson_probands_pc,'unique_variant_id','right')\n#print(high_impact_perPerson_scored.count())\n\nhigh_impact_perPerson_scored = t_ocr_select.where(col('is_proband') == True)\\\n                                            .drop('chromosome','start','end','reference','alternate')\\\n                                            .join(highImpact_CADD_scores,'unique_variant_id','right')\n                                            \nprint(high_impact_perPerson_scored.count())\n\nhigh_impact_perPerson_scored = high_impact_perPerson_scored.withColumn('High_Impact_boolean',lit(1))\\\n                                                           .withColumn('DeNovo_boolean',lit(0))\\\n                                                           .withColumn('gt20_boolean',lit(0))\n",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T16:05:43+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "30892\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=100",
              "$$hashKey": "object:19587"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659570672932_348818929",
      "id": "paragraph_1659570672932_348818929",
      "dateCreated": "2022-08-03T23:51:12+0000",
      "dateStarted": "2022-09-14T12:52:01+0000",
      "dateFinished": "2022-09-14T12:52:49+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16275"
    },
    {
      "text": "%pyspark\n\n#denovos_scored_kutd = spark.read.parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/denovos_scored_KIDNEY.parquet/')\n#print(denovos_scored_kutd.count())\n#denovos_scored_kutd.show()\n",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T16:09:34+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663171653497_1251967805",
      "id": "paragraph_1663171653497_1251967805",
      "dateCreated": "2022-09-14T16:07:33+0000",
      "dateStarted": "2022-09-14T16:09:34+0000",
      "dateFinished": "2022-09-14T16:09:34+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16276"
    },
    {
      "text": "%pyspark\ngene_var_map = t_csq_select.select('unique_variant_id','symbol').drop_duplicates(['unique_variant_id'])\n\ndeNovos_scored_sym = deNovos_scored.join(gene_var_map,'unique_variant_id','left')\n#print(deNovos_scored_sym.count())\n#print(deNovos_scored_sym.where(col('symbol').isNull()).count())",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T18:56:32+0000",
      "progress": 98,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "710\n0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=270",
              "$$hashKey": "object:19687"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=272",
              "$$hashKey": "object:19688"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659707072614_402942526",
      "id": "paragraph_1659707072614_402942526",
      "dateCreated": "2022-08-05T13:44:32+0000",
      "dateStarted": "2022-09-14T18:23:39+0000",
      "dateFinished": "2022-09-14T18:52:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16277"
    },
    {
      "text": "%pyspark\ndeNovos_scored_sym = deNovos_scored_sym.withColumn('High_Impact_boolean',lit(0))\\\n                                    .withColumn('gt20_boolean',lit(0))\n                                    \n# join rsIDs in\ndeNovos_scored_sym_rsID = deNovos_scored_sym.join(t_csq_select.select('rsID','unique_variant_id'),'unique_variant_id','left') ",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T18:33:22+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663095398936_228702324",
      "id": "paragraph_1663095398936_228702324",
      "dateCreated": "2022-09-13T18:56:38+0000",
      "dateStarted": "2022-09-14T18:33:22+0000",
      "dateFinished": "2022-09-14T18:52:53+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16278"
    },
    {
      "text": "%pyspark\nall_pcs_gt20_perPerson_nonNull = all_pcs_gt20_perPerson_nonNull.drop('end','feature_type', 'hgvsc','strand')\ndeNovos_scored_sym_rsID = deNovos_scored_sym_rsID.drop('end')",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T18:33:28+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663095430367_1199898653",
      "id": "paragraph_1663095430367_1199898653",
      "dateCreated": "2022-09-13T18:57:10+0000",
      "dateStarted": "2022-09-14T18:52:52+0000",
      "dateFinished": "2022-09-14T18:52:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16279"
    },
    {
      "text": "%pyspark\nset(all_pcs_gt20_perPerson_nonNull.columns) - set(deNovos_scored_sym_rsID.columns)",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T18:33:31+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "set()"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663095487532_1670742962",
      "id": "paragraph_1663095487532_1670742962",
      "dateCreated": "2022-09-13T18:58:07+0000",
      "dateStarted": "2022-09-14T18:52:53+0000",
      "dateFinished": "2022-09-14T18:52:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16280"
    },
    {
      "text": "%pyspark\nprint(all_pcs_gt20_perPerson_nonNull.count())\nprint(all_pcs_gt20_perPerson_nonNull.drop_duplicates(['biospecimen_id','unique_variant_id']).count())\n\nprint(deNovos_scored_sym_rsID.count())\nprint(deNovos_scored_sym_rsID.drop_duplicates(['biospecimen_id','unique_variant_id']).count())\n\nprint(high_impact_perPerson_scored.count())\nprint(high_impact_perPerson_scored.drop_duplicates(['biospecimen_id','unique_variant_id']).count())",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T18:33:51+0000",
      "progress": 95,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663095504707_1162255629",
      "id": "paragraph_1663095504707_1162255629",
      "dateCreated": "2022-09-13T18:58:24+0000",
      "dateStarted": "2022-09-14T18:52:54+0000",
      "dateFinished": "2022-09-14T19:11:14+0000",
      "status": "ABORT",
      "$$hashKey": "object:16281"
    },
    {
      "text": "%pyspark\nall_pcs_gt20_perPerson_nonNull = all_pcs_gt20_perPerson_nonNull.drop_duplicates(['biospecimen_id','unique_variant_id'])\ndeNovos_scored_sym_rsID = deNovos_scored_sym_rsID.drop_duplicates(['biospecimen_id','unique_variant_id'])\nhigh_impact_perPerson_scored = high_impact_perPerson_scored.drop_duplicates(['biospecimen_id','unique_variant_id'])",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:12:01+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663181800986_781713406",
      "id": "paragraph_1663181800986_781713406",
      "dateCreated": "2022-09-14T18:56:40+0000",
      "dateStarted": "2022-09-14T19:12:01+0000",
      "dateFinished": "2022-09-14T19:12:02+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16282"
    },
    {
      "text": "%pyspark\nc = ['unique_variant_id', 'cadd_score', 'biospecimen_id', 'name', 'hgvsg', 'variant_class', 'is_proband', 'quality', 'info_dp', 'chromosome',\n                     'start', 'reference', 'alternate', 'impact','rsID', 'symbol','biotype','consequences','DeNovo_boolean','High_Impact_boolean','gt20_boolean'] \n                     \n                     \nscored_variants = deNovos_scored_sym_rsID.select(c).union(high_impact_perPerson_scored.select(c))\nscored_variants = scored_variants.select(c).union(all_pcs_gt20_perPerson_nonNull.select(c))",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:12:03+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659442388134_795878053",
      "id": "paragraph_1659442388134_795878053",
      "dateCreated": "2022-08-02T12:13:08+0000",
      "dateStarted": "2022-09-14T19:12:03+0000",
      "dateFinished": "2022-09-14T19:12:04+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16283"
    },
    {
      "text": "%pyspark\nscored_variants_dedup = scored_variants.drop_duplicates(['biospecimen_id','unique_variant_id'])\nscored_variants_dedup.count()\n",
      "user": "anonymous",
      "dateUpdated": "2022-08-05T13:45:17+0000",
      "progress": 97,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "31686"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-90.ec2.internal:4040/jobs/job?id=167",
              "$$hashKey": "object:20012"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659570763703_1479295974",
      "id": "paragraph_1659570763703_1479295974",
      "dateCreated": "2022-08-03T23:52:43+0000",
      "dateStarted": "2022-08-05T14:13:56+0000",
      "dateFinished": "2022-08-05T14:45:43+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16284"
    },
    {
      "text": "%pyspark\nscored_variants.sample(1/1000).show()",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:12:48+0000",
      "progress": 3,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------+----------+--------------+-----------+-------------------+-------------+----------+-------+-------+----------+---------+---------+---------+--------+-----------+----------+--------------------+--------------------+--------------+-------------------+------------+\n|unique_variant_id|cadd_score|biospecimen_id|       name|              hgvsg|variant_class|is_proband|quality|info_dp|chromosome|    start|reference|alternate|  impact|       rsID|    symbol|             biotype|        consequences|DeNovo_boolean|High_Impact_boolean|gt20_boolean|\n+-----------------+----------+--------------+-----------+-------------------+-------------+----------+-------+-------+----------+---------+---------+---------+--------+-----------+----------+--------------------+--------------------+--------------+-------------------+------------+\n|   1:16649606:G:A|     18.84|   BS_S5EHYVTB|rs201089581| chr1:g.16649606G>A|          SNV|      true| 338.25|    280|         1| 16649606|        G|        A|    HIGH|rs201089581|    MST1P2|unprocessed_pseud...|[splice_acceptor_...|             1|                  0|           0|\n|  3:195786512:T:A|     0.637|   BS_2NGQFV40| rs80123784|chr3:g.195786512T>A|          SNV|      true| 370.08|    140|         3|195786512|        T|        A|MODERATE| rs80123784|      MUC4|      protein_coding|  [missense_variant]|             1|                  0|           0|\n|  6:135060213:A:G|     12.18|   BS_58HZ7ANK| rs11759077|chr6:g.135060213A>G|          SNV|      true|2973.89|    111|         6|135060213|        A|        G|    HIGH| rs11759077|AL353596.1|           antisense|[splice_acceptor_...|             0|                  1|           0|\n|   6:32530124:C:T|      27.6|   BS_2NGQFV40| rs79192142| chr6:g.32530124C>T|          SNV|      true| 1327.4|    200|         6| 32530124|        C|        T|    HIGH| rs79192142|  HLA-DRB5|      protein_coding|[splice_donor_var...|             0|                  1|           0|\n|  19:54595758:G:T|      33.0|   BS_H8F5CQQK|rs150508449|chr19:g.54595758G>T|          SNV|      true|2786.13|    184|        19| 54595758|        G|        T|    HIGH|rs150508449|    LILRA1|      protein_coding|       [stop_gained]|             0|                  1|           0|\n|  11:22480071:A:G|      13.3|   BS_6G6HCJTF| rs62621361|chr11:g.22480071A>G|          SNV|      true| 252.25|     81|        11| 22480071|        A|        G|    HIGH| rs62621361| LINC01495|             lincRNA|[splice_donor_var...|             0|                  1|           0|\n|  6:32521974:GC:G|      null|   BS_ZWZ9AK3Z|       null|               null|         null|      true| 432.55|     88|         6| 32521974|       GC|        G|    HIGH|       null|  HLA-DRB5|      protein_coding|[frameshift_variant]|             0|                  1|           0|\n|  5:144474088:G:T|      42.0|   BS_ZWZ9AK3Z|       null|chr5:g.144474088G>T|          SNV|      true|  12.25|    118|         5|144474088|        G|        T|    HIGH|       null|    KCTD16|      protein_coding|       [stop_gained]|             0|                  1|           0|\n|   1:63170150:T:A|     4.216|   BS_R2JY33KB|  rs7519254| chr1:g.63170150T>A|          SNV|      true| 946.12|    120|         1| 63170150|        T|        A|    HIGH|  rs7519254| LINC00466|             lincRNA|[splice_donor_var...|             0|                  1|           0|\n|   12:6160496:C:T|     12.72|   BS_S5EHYVTB| rs11064063| chr12:g.6160496C>T|          SNV|      true| 191.25|     96|        12|  6160496|        C|        T|    HIGH| rs11064063|AC005845.1|             lincRNA|[splice_donor_var...|             0|                  1|           0|\n|  11:41821394:G:C|      0.43|   BS_J7ZSM0EE|  rs1877022|chr11:g.41821394G>C|          SNV|      true| 695.12|     86|        11| 41821394|        G|        C|    HIGH|  rs1877022| LINC01499|             lincRNA|[splice_donor_var...|             0|                  1|           0|\n|  22:15749799:C:G|     6.354|   BS_681E1FR1|       null|chr22:g.15749799C>G|          SNV|      true|1334.93|    249|        22| 15749799|        C|        G|    HIGH|       null|  GRAMD4P2|processed_pseudogene|[splice_acceptor_...|             0|                  1|           0|\n|  19:57131414:C:A|      35.0|   BS_CET1373K|  rs9973206|chr19:g.57131414C>A|          SNV|      true|3399.69|    105|        19| 57131414|        C|        A|    HIGH|  rs9973206|     USP29|      protein_coding|       [stop_gained]|             0|                  1|           0|\n|  12:29521087:G:T|     4.396|   BS_SZXW3854|    rs53024|chr12:g.29521087G>T|          SNV|      true|1939.94|    102|        12| 29521087|        G|        T|    HIGH|    rs53024|AC009320.1|           antisense|[splice_donor_var...|             0|                  1|           0|\n|  6:32521977:TG:T|      null|   BS_XNPGZ8S0|       null| chr6:g.32521978del|     deletion|      true|1506.93|    164|         6| 32521977|       TG|        T|    HIGH|       null|  HLA-DRB5|      protein_coding|[frameshift_variant]|             0|                  1|           0|\n|  5:143559437:G:A|     7.657|   BS_RF110T9C|  rs6878628|chr5:g.143559437G>A|          SNV|      true|2936.94|    165|         5|143559437|        G|        A|    HIGH|  rs6878628|AC016598.2|             lincRNA|[splice_donor_var...|             0|                  1|           0|\n| 14:50911872:CT:C|      null|   BS_GAME99ZD| rs11356035|chr14:g.50911875del|     deletion|      true|3089.89|    108|        14| 50911872|       CT|        C|    HIGH| rs11356035|      PYGL|      protein_coding|[splice_acceptor_...|             0|                  1|           0|\n|  1:161599629:C:G|     9.258|   BS_52R8EXWE|   rs430178|chr1:g.161599629C>G|          SNV|      true| 498.84|     58|         1|161599629|        C|        G|    HIGH|   rs430178|    FCGR2C|      protein_coding|[splice_acceptor_...|             0|                  1|           0|\n|  6:149797919:A:C|     15.04|   BS_KPA7TQ14|       null|chr6:g.149797919A>C|          SNV|      true| 449.25|    110|         6|149797919|        A|        C|    HIGH|       null|AL355312.2|           antisense|[splice_donor_var...|             0|                  1|           0|\n|  7:100779751:G:A|      27.7|   BS_51DQSTNC|   rs482308|chr7:g.100779751G>A|          SNV|      true| 675.25|    133|         7|100779751|        G|        A|    HIGH|   rs482308|       ZAN|      protein_coding|[splice_donor_var...|             0|                  1|           0|\n+-----------------+----------+--------------+-----------+-------------------+-------------+----------+-------+-------+----------+---------+---------+---------+--------+-----------+----------+--------------------+--------------------+--------------+-------------------+------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=280",
              "$$hashKey": "object:20070"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=281",
              "$$hashKey": "object:20071"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=282",
              "$$hashKey": "object:20072"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=283",
              "$$hashKey": "object:20073"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=284",
              "$$hashKey": "object:20074"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663182743617_543297084",
      "id": "paragraph_1663182743617_543297084",
      "dateCreated": "2022-09-14T19:12:23+0000",
      "dateStarted": "2022-09-14T19:12:49+0000",
      "dateFinished": "2022-09-14T19:32:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16285"
    },
    {
      "text": "%pyspark\nscored_variants.count()",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:12:58+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "279730"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=286",
              "$$hashKey": "object:20148"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663182773020_1593169747",
      "id": "paragraph_1663182773020_1593169747",
      "dateCreated": "2022-09-14T19:12:53+0000",
      "dateStarted": "2022-09-14T19:12:58+0000",
      "dateFinished": "2022-09-14T19:49:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16286"
    },
    {
      "text": "%pyspark\nscored_variants = scored_variants.withColumn('eqtl_boolean',lit(0))",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:53:02+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663184200060_1206133243",
      "id": "paragraph_1663184200060_1206133243",
      "dateCreated": "2022-09-14T19:36:40+0000",
      "dateStarted": "2022-09-14T19:53:02+0000",
      "dateFinished": "2022-09-14T19:53:02+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16287"
    },
    {
      "text": "%pyspark\n#scored_variants_dedup.write.mode('overwrite').partitionBy(\"chromosome\").parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/scored_variants_KIDNEY.parquet') # .repartitionByRange(20, \"chromosome\", \"start\")",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:13:08+0000",
      "progress": 100,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-90.ec2.internal:4040/jobs/job?id=169",
              "$$hashKey": "object:20238"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659641501045_1922422019",
      "id": "paragraph_1659641501045_1922422019",
      "dateCreated": "2022-08-04T19:31:41+0000",
      "dateStarted": "2022-08-05T14:49:38+0000",
      "dateFinished": "2022-08-05T15:53:27+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16288"
    },
    {
      "text": "%pyspark\n#scored_variants_dedup.repartitionByRange(20, \"chromosome\", \"start\").write.mode('overwrite').partitionBy(\"chromosome\").parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/scored_variants_KIDNEY_2.parquet') #",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:13:12+0000",
      "progress": 2,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-90.ec2.internal:4040/jobs/job?id=171",
              "$$hashKey": "object:20286"
            },
            {
              "jobUrl": "http://ip-10-12-3-90.ec2.internal:4040/jobs/job?id=172",
              "$$hashKey": "object:20287"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659641500075_1545739363",
      "id": "paragraph_1659641500075_1545739363",
      "dateCreated": "2022-08-04T19:31:40+0000",
      "dateStarted": "2022-08-05T15:09:39+0000",
      "dateFinished": "2022-08-05T16:09:46+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16289"
    },
    {
      "text": "%sh\naws s3 ls s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/CHD_all_unique_variants.parquet/\n",
      "user": "anonymous",
      "dateUpdated": "2022-08-05T18:38:21+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659724624256_1435356118",
      "id": "paragraph_1659724624256_1435356118",
      "dateCreated": "2022-08-05T18:37:04+0000",
      "dateStarted": "2022-08-05T18:37:37+0000",
      "dateFinished": "2022-08-05T18:37:37+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16290"
    },
    {
      "title": "Combine eQTL variants",
      "text": "%pyspark\neqtl_highImpact = spark.read.parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/eqtl_highImpact_scored_july8.parquet')\n#print(eqtl_highImpact.count())\neqtls = eqtl_highImpact.where(col('eqtl_boolean') == 1)\n#print(eqtls.count())\n#e = eqtl_highImpact.select('cadd_score').toPandas()\n#e.hist(bins=50)\n#z.show(plt)\nc = ['unique_variant_id', 'cadd_score', 'biospecimen_id', 'name', 'hgvsg', 'variant_class', 'is_proband', 'quality', 'info_dp', 'chromosome',\n                     'start', 'reference', 'alternate',  'symbol']\n                     \neqtls_perPerson = eqtls.drop('alternate','reference','start','chromosome').join(\n                                    t_ocr_select.where(col('is_proband') == True ),'unique_variant_id','left')\\\n                                    .drop_duplicates(['biospecimen_id','unique_variant_id']).select(c)\nprint(eqtls_perPerson.count())\neqtls_perPerson.show()",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:53:43+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "15286170\n+--------------------+--------------------+--------------+----+-----+-------------+----------+-------+-------+----------+-----+---------+---------+--------------+\n|   unique_variant_id|          cadd_score|biospecimen_id|name|hgvsg|variant_class|is_proband|quality|info_dp|chromosome|start|reference|alternate|        symbol|\n+--------------------+--------------------+--------------+----+-----+-------------+----------+-------+-------+----------+-----+---------+---------+--------------+\n|    10:115789769:A:G|               5.709|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|         PNLIP|\n|    10:116783496:C:T|               0.115|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|         GFRA1|\n|    10:126209324:A:G|               1.199|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|         DHX32|\n|     10:22487678:A:C|               11.44|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|  RP11-573G6.6|\n|     10:22816294:T:C|               1.683|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|        DNAJC1|\n|     10:27056989:C:T|               8.888|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|     LINC00264|\n|     10:43999301:G:A|0.006999999999999999|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|        CAP1P2|\n|     10:47440038:G:A|               9.849|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|       AGAP13P|\n|      10:5934831:A:G|               3.838|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|       NRBF2P5|\n|     10:67833868:G:A|               3.916|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|       HNRNPH3|\n|     10:68057769:C:T|               0.454|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|       HNRNPH3|\n|     10:69419584:G:A|               0.389|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|       CALM2P2|\n|     10:69827032:C:T|  3.2960000000000003|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|           HK1|\n|     10:70080763:T:G|               9.016|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|      EIF4EBP2|\n|     10:73939296:A:G|               1.976|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|       SNORA11|\n|     10:79386961:A:G|               4.939|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|RP11-479O17.12|\n|     10:86666302:C:T|               2.776|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|        FAM35A|\n|     10:88105124:T:C|0.018000000000000002|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|          KLLN|\n|10:92127881:A:AAA...|               8.354|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null| RP11-402D21.2|\n|   10:96416397:TGC:T|               2.728|          null|null| null|         null|      null|   null|   null|      null| null|     null|     null|    ENTPD1-AS1|\n+--------------------+--------------------+--------------+----+-----+-------------+----------+-------+-------+----------+-----+---------+---------+--------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=334",
              "$$hashKey": "object:20391"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=335",
              "$$hashKey": "object:20392"
            },
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=336",
              "$$hashKey": "object:20393"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1661096888189_1991463777",
      "id": "paragraph_1661096888189_1991463777",
      "dateCreated": "2022-08-21T15:48:08+0000",
      "dateStarted": "2022-09-14T19:53:43+0000",
      "dateFinished": "2022-09-14T19:55:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16291"
    },
    {
      "text": "%pyspark\neqtls_perPerson = eqtls_perPerson.withColumn('DeNovo_boolean',lit(0))\\\n                                .withColumn('High_Impact_boolean',lit(0))\\\n                                .withColumn('gt20_boolean',lit(0)) #\\.withColumn('eqtl_boolean',lit(1))",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:55:57+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663183890117_2060165313",
      "id": "paragraph_1663183890117_2060165313",
      "dateCreated": "2022-09-14T19:31:30+0000",
      "dateStarted": "2022-09-14T19:55:57+0000",
      "dateFinished": "2022-09-14T19:55:57+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16292"
    },
    {
      "text": "%pyspark\neqtls_perPerson_dropna = eqtls_perPerson.where(~col('biospecimen_id').isNull())\neqtls_perPerson_dropna.count()\n",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:56:09+0000",
      "progress": 68,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "15201517"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=338",
              "$$hashKey": "object:20501"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1661097495865_2078303669",
      "id": "paragraph_1661097495865_2078303669",
      "dateCreated": "2022-08-21T15:58:15+0000",
      "dateStarted": "2022-09-14T19:56:09+0000",
      "dateFinished": "2022-09-14T19:56:45+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16293"
    },
    {
      "text": "%pyspark\neqtls_perPerson_dropna = eqtls_perPerson_dropna.withColumn('eqtl_boolean',lit(1))",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T19:59:47+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663185576627_500804078",
      "id": "paragraph_1663185576627_500804078",
      "dateCreated": "2022-09-14T19:59:36+0000",
      "dateStarted": "2022-09-14T19:59:47+0000",
      "dateFinished": "2022-09-14T19:59:48+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16294"
    },
    {
      "text": "%pyspark\neqtls_perPerson_dropna =  eqtls_perPerson_dropna.withColumn('biotype',lit('NA'))\\\n                                                    .withColumn('consequences',F.array([]))\\\n                                                    .withColumn('impact',lit('NA'))",
      "user": "anonymous",
      "dateUpdated": "2022-09-15T12:05:52+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663185612411_2000782933",
      "id": "paragraph_1663185612411_2000782933",
      "dateCreated": "2022-09-14T20:00:12+0000",
      "dateStarted": "2022-09-14T20:01:34+0000",
      "dateFinished": "2022-09-14T20:01:34+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16295"
    },
    {
      "text": "%pyspark\neqtls_perPerson_dropna.show(1)",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T20:52:50+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------+----------+--------------+---------+--------------------+-------------+----------+-------+-------+----------+---------+---------+---------+------------+--------------+-------------------+------------+------------+-------+------+----+\n|unique_variant_id|cadd_score|biospecimen_id|     name|               hgvsg|variant_class|is_proband|quality|info_dp|chromosome|    start|reference|alternate|      symbol|DeNovo_boolean|High_Impact_boolean|gt20_boolean|eqtl_boolean|biotype|impact|rsID|\n+-----------------+----------+--------------+---------+--------------------+-------------+----------+-------+-------+----------+---------+---------+---------+------------+--------------+-------------------+------------+------------+-------+------+----+\n| 10:100887424:A:G|      1.55|   BS_08NAFVFG|rs1886276|chr10:g.100887424A>G|          SNV|      true|3796.89|    144|        10|100887424|        A|        G|RP11-179B2.2|             0|                  0|           0|           1|     []|    NA|  NA|\n+-----------------+----------+--------------+---------+--------------------+-------------+----------+-------+-------+----------+---------+---------+---------+------------+--------------+-------------------+------------+------------+-------+------+----+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=349",
              "$$hashKey": "object:20643"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663185591572_1900492670",
      "id": "paragraph_1663185591572_1900492670",
      "dateCreated": "2022-09-14T19:59:51+0000",
      "dateStarted": "2022-09-14T20:52:50+0000",
      "dateFinished": "2022-09-14T20:53:42+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16296"
    },
    {
      "text": "%pyspark\n#scored_variants = scored_variants_kidney.union(eqtls_perPerson)\n\nce = ['unique_variant_id', 'cadd_score', 'biospecimen_id', 'name', 'hgvsg', 'variant_class', 'is_proband', 'quality', 'info_dp', 'chromosome',\n                     'start', 'reference', 'alternate', 'impact','rsID', 'symbol','biotype','consequences','DeNovo_boolean','High_Impact_boolean','gt20_boolean','eqtl_boolean'] \n                     \nscored_variants_final = scored_variants.select(ce).union(eqtls_perPerson_dropna.select(ce))#.drop_duplicates(['biospecimen_id','unique_variant_id'])\nscored_variants_final.count()",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T20:54:50+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "15481247"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=352",
              "$$hashKey": "object:20701"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1661097208297_156222768",
      "id": "paragraph_1661097208297_156222768",
      "dateCreated": "2022-08-21T15:53:28+0000",
      "dateStarted": "2022-09-14T20:54:50+0000",
      "dateFinished": "2022-09-14T21:12:01+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16297"
    },
    {
      "text": "%pyspark\nscored_variants_final.repartition(200, \"unique_variant_id\").write.mode('overwrite').parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/scored_variants_KIDNEY_w_eQTLs_sep14.parquet') #  .partitionBy(\"chromosome\")",
      "user": "anonymous",
      "dateUpdated": "2022-09-14T22:06:18+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-48.ec2.internal:4040/jobs/job?id=354",
              "$$hashKey": "object:20749"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1661102902526_2013472360",
      "id": "paragraph_1661102902526_2013472360",
      "dateCreated": "2022-08-21T17:28:22+0000",
      "dateStarted": "2022-09-14T22:06:18+0000",
      "dateFinished": "2022-09-14T22:28:46+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16298"
    },
    {
      "text": "%pyspark\n\n\nscored_variants_final = spark.read.parquet(\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/scored_variants_KIDNEY_w_eQTLs_sep14.parquet\")\nprint(scored_variants_final.count())\nscored_variants_final.show(3)",
      "user": "anonymous",
      "dateUpdated": "2022-09-15T12:11:42+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "15481247\n+-----------------+-------------------+--------------+-----------+-------------------+-------------+----------+-------+-------+----------+--------+---------+---------+------+-----------+--------+--------------------+--------------------+--------------+-------------------+------------+------------+\n|unique_variant_id|         cadd_score|biospecimen_id|       name|              hgvsg|variant_class|is_proband|quality|info_dp|chromosome|   start|reference|alternate|impact|       rsID|  symbol|             biotype|        consequences|DeNovo_boolean|High_Impact_boolean|gt20_boolean|eqtl_boolean|\n+-----------------+-------------------+--------------+-----------+-------------------+-------------+----------+-------+-------+----------+--------+---------+---------+------+-----------+--------+--------------------+--------------------+--------------+-------------------+------------+------------+\n|  10:46263509:C:T|              16.39|   BS_08NAFVFG| rs66825481|chr10:g.46263509C>T|          SNV|      true| 623.25|    133|        10|46263509|        C|        T|  HIGH| rs66825481|ANTXRLP1|unprocessed_pseud...|[splice_donor_var...|             0|                  1|           0|           0|\n|  12:52317765:G:T|               36.0|   BS_08NAFVFG|  rs2857667|chr12:g.52317765G>T|          SNV|      true|2087.63|    129|        12|52317765|        G|        T|  HIGH|  rs2857667|   KRT83|      protein_coding|       [stop_gained]|             0|                  1|           0|           0|\n|    16:536144:T:C|0.26899999999999996|   BS_08NAFVFG|rs113355794|  chr16:g.536144T>C|          SNV|      true|1195.12|    141|        16|  536144|        T|        C|  HIGH|rs113355794|  CAPN15|      protein_coding|[splice_donor_var...|             0|                  1|           0|           0|\n+-----------------+-------------------+--------------+-----------+-------------------+-------------+----------+-------+-------+----------+--------+---------+---------+------+-----------+--------+--------------------+--------------------+--------------+-------------------+------------+------------+\nonly showing top 3 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=1",
              "$$hashKey": "object:20807"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=2",
              "$$hashKey": "object:20808"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=3",
              "$$hashKey": "object:20809"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663185125707_593878601",
      "id": "paragraph_1663185125707_593878601",
      "dateCreated": "2022-09-14T19:52:05+0000",
      "dateStarted": "2022-09-15T12:11:42+0000",
      "dateFinished": "2022-09-15T12:11:58+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16299"
    },
    {
      "text": "%pyspark\nprint('Total De Novo.............',scored_variants_final.where(col('DeNovo_boolean') == 1).count()) # De Novo High/Moderate\nprint('Total VEP High Impact.....',scored_variants_final.where(col('High_Impact_boolean') == 1).count()) # VEP High Impact \nprint('Total CADD > 20...........',scored_variants_final.where(col('gt20_boolean') == 1).count()) # CADD greater than 20.0\nprint('Total eQTL................',scored_variants_final.where(col('eqtl_boolean') == 1).count()) # eQTLs\n\n",
      "user": "anonymous",
      "dateUpdated": "2022-09-15T12:23:16+0000",
      "progress": 47,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Total De Novo............. 710\nTotal VEP High Impact..... 30660\nTotal CADD > 20........... 248360\nTotal eQTL................ 15201517\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=23",
              "$$hashKey": "object:20875"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=24",
              "$$hashKey": "object:20876"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=25",
              "$$hashKey": "object:20877"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=26",
              "$$hashKey": "object:20878"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663185785147_1955425869",
      "id": "paragraph_1663185785147_1955425869",
      "dateCreated": "2022-09-14T20:03:05+0000",
      "dateStarted": "2022-09-15T12:23:16+0000",
      "dateFinished": "2022-09-15T12:23:21+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16300"
    },
    {
      "text": "%pyspark\nscored_variants_final.where(col('DeNovo_boolean') == 1).select('cadd_score').dropna().count() #.groupby('biospecimen_id').sum('cadd_score').show()",
      "user": "anonymous",
      "dateUpdated": "2022-09-15T12:36:19+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "705"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=48",
              "$$hashKey": "object:20948"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663243720861_164495760",
      "id": "paragraph_1663243720861_164495760",
      "dateCreated": "2022-09-15T12:08:40+0000",
      "dateStarted": "2022-09-15T12:36:19+0000",
      "dateFinished": "2022-09-15T12:36:20+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16301"
    },
    {
      "text": "%pyspark\nprint(100*(scored_variants_final.where(col('DeNovo_boolean') == 1).where(col('cadd_score').isNull()).count()/scored_variants_final.where(col('DeNovo_boolean') == 1).count()))\nprint(100*(scored_variants_final.where(col('High_Impact_boolean') == 1).where(col('cadd_score').isNull()).count()/scored_variants_final.where(col('High_Impact_boolean') == 1).count()))\nprint(100*(scored_variants_final.where(col('gt20_boolean') == 1).where(col('cadd_score').isNull()).count()/scored_variants_final.where(col('gt20_boolean') == 1).count()))\nprint(100*(scored_variants_final.where(col('eqtl_boolean') == 1).where(col('cadd_score').isNull()).count()/scored_variants_final.where(col('eqtl_boolean') == 1).count()))\n",
      "user": "anonymous",
      "dateUpdated": "2022-09-15T12:31:31+0000",
      "progress": 92,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "0.7042253521126761\n22.64840182648402\n0.0\n0.0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=39",
              "$$hashKey": "object:21006"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=40",
              "$$hashKey": "object:21007"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=41",
              "$$hashKey": "object:21008"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=42",
              "$$hashKey": "object:21009"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=43",
              "$$hashKey": "object:21010"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=44",
              "$$hashKey": "object:21011"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=45",
              "$$hashKey": "object:21012"
            },
            {
              "jobUrl": "http://ip-10-12-3-141.ec2.internal:4040/jobs/job?id=46",
              "$$hashKey": "object:21013"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1663243723597_149490299",
      "id": "paragraph_1663243723597_149490299",
      "dateCreated": "2022-09-15T12:08:43+0000",
      "dateStarted": "2022-09-15T12:31:31+0000",
      "dateFinished": "2022-09-15T12:31:42+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16302"
    },
    {
      "text": "%pyspark\nscored_variants_kidney = spark.read.parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/scored_variants_KIDNEY.parquet/')\nprint(scored_variants_kidney.count())\nscored_variants_kidney.show(3)",
      "user": "anonymous",
      "dateUpdated": "2022-08-24T17:41:31+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1660052284781_909377839",
      "id": "paragraph_1660052284781_909377839",
      "dateCreated": "2022-08-09T13:38:04+0000",
      "dateStarted": "2022-08-24T17:41:31+0000",
      "dateFinished": "2022-08-24T17:41:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16303"
    },
    {
      "text": "%pyspark\n'''from scipy.stats import gaussian_kde\nplt.figure()\ndensity = gaussian_kde(data[0])\nxs = np.linspace(0,8,200)\ndensity.covariance_factor = lambda : .25\ndensity._compute_covariance()\nplt.plot(xs,density(xs))\nplt.show()\nz.show(plt)\n\ndensity = gaussian_kde(data[1])\nxs = np.linspace(0,8,200)\ndensity.covariance_factor = lambda : .25\ndensity._compute_covariance()\nplt.plot(xs,density(xs),'g')\nplt.xlim([0,2])\nplt.show()\nz.show(plt)'''",
      "user": "anonymous",
      "dateUpdated": "2022-08-21T18:39:56+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1660052290978_923572620",
      "id": "paragraph_1660052290978_923572620",
      "dateCreated": "2022-08-09T13:38:10+0000",
      "dateStarted": "2022-08-21T18:39:27+0000",
      "dateFinished": "2022-08-21T18:39:28+0000",
      "status": "FINISHED",
      "$$hashKey": "object:16304"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2022-08-09T15:36:02+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1660059362393_2088505475",
      "id": "paragraph_1660059362393_2088505475",
      "dateCreated": "2022-08-09T15:36:02+0000",
      "status": "READY",
      "$$hashKey": "object:16305"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2022-08-09T15:36:03+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1660059363950_1404640425",
      "id": "paragraph_1660059363950_1404640425",
      "dateCreated": "2022-08-09T15:36:03+0000",
      "status": "READY",
      "$$hashKey": "object:16306"
    }
  ],
  "name": "Denovo_kidney",
  "id": "2H92PS5NW",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {},
  "path": "/gene_burden_testing/Denovo_kidney"
}