{
  "paragraphs": [
    {
      "text": "%pyspark\nimport pandas as pd\npd.set_option('display.max_columns', None)\nimport numpy as np\nimport glob\nfrom collections import Counter\nimport matplotlib.pyplot as plt\nimport io\nimport requests\nimport os\nfrom pyspark import SparkFiles\nfrom pyspark.sql import functions as F\nfrom pyspark.sql.functions import col,collect_list, concat, lit, when, monotonically_increasing_id, concat_ws \nfrom pyspark.sql.types import StringType",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:44:15+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654270535299_1602198009",
      "id": "paragraph_1654270535299_1602198009",
      "dateCreated": "2022-06-03T15:35:35+0000",
      "dateStarted": "2022-07-29T11:44:15+0000",
      "dateFinished": "2022-07-29T11:45:50+0000",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:32178"
    },
    {
      "text": "%md\n\n####  .12%  of the indels (9700 out of 8mil) are passing CADD score >= 20 filtering (gnomad v3 probably doesnt contain most of the indels in kids first? need to check)\n#### .46% of the SNPs are (161k out of 35mil) are passing CADD score >= 20 filtering\n\n\n#### star format for deletions in kids first -- replace star w/ first base of ref like the other data has. --ask jeremy\n\n#### 20% > kf, filter by common gnomad\n\n#### Do CADD filtering with eQTLs?    just get CADD scores\n\n#### CADD score >= 20 filtering removes a third of the HIGH Impact variants.\n### keep them and just get CADD score\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-01T12:13:47+0000",
      "progress": 0,
      "config": {
        "tableHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<h3>is it ok that only .12%  of the indels are getting picked up w/ CADD filtering? gnomad v3 probably doesnt contain most of the indels in kids first right? need to check</h3>\n<h3>star format for deletions in kids first &ndash; replace star w/ first base of ref like the other data has.</h3>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654775740888_1106233153",
      "id": "paragraph_1654775740888_1106233153",
      "dateCreated": "2022-06-09T11:55:40+0000",
      "dateStarted": "2022-06-09T12:02:33+0000",
      "dateFinished": "2022-06-09T12:02:37+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32179"
    },
    {
      "text": "%sh\naws s3 cp cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/variant_annotations.parquet s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/variant_annotations.parquet  --recursive\n\n\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-28T23:22:12+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658841207891_867063521",
      "id": "paragraph_1658841207891_867063521",
      "dateCreated": "2022-07-26T13:13:27+0000",
      "dateStarted": "2022-07-28T23:22:12+0000",
      "dateFinished": "2022-07-28T23:22:32+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32180"
    },
    {
      "text": "%pyspark\n# \nchd_BS_scored_vars = spark.read.parquet(\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/chd_scored_variant_files/CHD_BS_0302Y3N5_scored_variants.parquet\")\nprint(chd_BS_scored_vars.count())\nchd_BS_scored_vars.show(1)\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:44:23+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "145593\n+---------+---------+---------+---------+-----------------+-------+-------+---------------------+--------------------+------+----------+----------+------------+----------+\n|    start|      end|reference|alternate|unique_variant_id|   qual|INFO_DP|splitFromMultiAllelic|           genotypes|symbol|      rsID|cadd_score|eqtl_boolean|chromosome|\n+---------+---------+---------+---------+-----------------+-------+-------+---------------------+--------------------+------+----------+----------+------------+----------+\n|100285499|100285499|        G|        C|  1:100285499:G:C|1489.77|     45|                 true|[{BS_0302Y3N5, 99...|  RTCA|rs10875286|     0.417|           1|         1|\n+---------+---------+---------+---------+-----------------+-------+-------+---------------------+--------------------+------+----------+----------+------------+----------+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=0",
              "$$hashKey": "object:35617"
            },
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=1",
              "$$hashKey": "object:35618"
            },
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=2",
              "$$hashKey": "object:35619"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658838143306_183314554",
      "id": "paragraph_1658838143306_183314554",
      "dateCreated": "2022-07-26T12:22:23+0000",
      "dateStarted": "2022-07-29T11:44:36+0000",
      "dateFinished": "2022-07-29T11:46:18+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32181"
    },
    {
      "text": "%pyspark\nno_genes = chd_BS_scored_vars.where(col('symbol') == '')\nhas_genes = chd_BS_scored_vars.where(~(col('symbol') == ''))\nprint(no_genes.count())\nno_genes.show(1)",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:44:36+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "4822\n+---------+---------+---------+---------+-----------------+------+-------+---------------------+--------------------+------+----+----------+------------+----------+\n|    start|      end|reference|alternate|unique_variant_id|  qual|INFO_DP|splitFromMultiAllelic|           genotypes|symbol|rsID|cadd_score|eqtl_boolean|chromosome|\n+---------+---------+---------+---------+-----------------+------+-------+---------------------+--------------------+------+----+----------+------------+----------+\n|114139664|114139664|        G|        A|  1:114139664:G:A|341.77|     40|                 true|[{BS_0302Y3N5, 99...|      |    |      28.4|           0|         1|\n+---------+---------+---------+---------+-----------------+------+-------+---------------------+--------------------+------+----+----------+------------+----------+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=3",
              "$$hashKey": "object:35685"
            },
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=4",
              "$$hashKey": "object:35686"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658843528302_1649396970",
      "id": "paragraph_1658843528302_1649396970",
      "dateCreated": "2022-07-26T13:52:08+0000",
      "dateStarted": "2022-07-29T11:45:50+0000",
      "dateFinished": "2022-07-29T11:46:20+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32182"
    },
    {
      "text": "%pyspark\n'''t_csq = spark \\\n    .table('consequences') \\\n    .withColumnRenamed('name', 'rsID')\\\n    .drop('variant_class')\\\n    .where( (F.array_contains( F.col('study_ids'),'SD_PREASA7S' )) & (F.col('original_canonical') == 'true')) # & (F.col('study_ids').isin(study_id_list))\n    \nprint(t_csq.count())   # 205504922, 41879789 w/ original_canonical=true\n\nt_csq_select = t_csq.select(['chromosome','start','end', 'reference','alternate','rsID','impact','symbol'\n                                ,'biotype','hgvsc','hgvsg','feature_type','strand','consequences']) '''\n                                                \nt_csq_select = spark.read.parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/variant_annotations.parquet')  \nt_csq_select = t_csq_select.withColumn('unique_variant_id',concat(col(\"chromosome\"), lit(\":\"),col(\"start\"),\n                                                lit(':'),col('reference'),lit(':'),col('alternate'))) ",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:44:46+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=5",
              "$$hashKey": "object:35738"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658844075381_633190438",
      "id": "paragraph_1658844075381_633190438",
      "dateCreated": "2022-07-26T14:01:15+0000",
      "dateStarted": "2022-07-29T11:46:18+0000",
      "dateFinished": "2022-07-29T11:46:22+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32183"
    },
    {
      "text": "%pyspark\nj = t_csq_select.select('unique_variant_id','rsID','symbol').join(F.broadcast(no_genes.drop('symbol','rsID')),['unique_variant_id'],'right')\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:44:52+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658843527344_1893242842",
      "id": "paragraph_1658843527344_1893242842",
      "dateCreated": "2022-07-26T13:52:07+0000",
      "dateStarted": "2022-07-29T11:46:21+0000",
      "dateFinished": "2022-07-29T11:46:22+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32184"
    },
    {
      "text": "%pyspark\nprint(j.count())\nj.show(2)",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:45:00+0000",
      "progress": 96,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "4822\n+-----------------+----------+------+---------+---------+---------+---------+------+-------+---------------------+--------------------+----------+------------+----------+\n|unique_variant_id|      rsID|symbol|    start|      end|reference|alternate|  qual|INFO_DP|splitFromMultiAllelic|           genotypes|cadd_score|eqtl_boolean|chromosome|\n+-----------------+----------+------+---------+---------+---------+---------+------+-------+---------------------+--------------------+----------+------------+----------+\n| 11:132850353:T:C| rs2659615| OPCML|132850353|132850353|        T|        C|488.77|     39|                 true|[{BS_0302Y3N5, 99...|      20.5|           0|        11|\n| 11:133919097:T:C|rs12800905|IGSF9B|133919097|133919097|        T|        C|241.77|     19|                 true|[{BS_0302Y3N5, 99...|      22.5|           0|        11|\n+-----------------+----------+------+---------+---------+---------+---------+------+-------+---------------------+--------------------+----------+------------+----------+\nonly showing top 2 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=6",
              "$$hashKey": "object:35838"
            },
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=7",
              "$$hashKey": "object:35839"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658843526004_129762913",
      "id": "paragraph_1658843526004_129762913",
      "dateCreated": "2022-07-26T13:52:06+0000",
      "dateStarted": "2022-07-29T11:46:22+0000",
      "dateFinished": "2022-07-29T11:46:34+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32185"
    },
    {
      "text": "%pyspark\nju = j.select('unique_variant_id').toPandas()['unique_variant_id'].values\nprint(len(ju))\nprint(len(set(ju)))",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:45:05+0000",
      "progress": 73,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "4822\n4822\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=8",
              "$$hashKey": "object:35901"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658847951832_96610293",
      "id": "paragraph_1658847951832_96610293",
      "dateCreated": "2022-07-26T15:05:51+0000",
      "dateStarted": "2022-07-29T11:46:22+0000",
      "dateFinished": "2022-07-29T11:46:38+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32186"
    },
    {
      "text": "%pyspark\nno_genes_vars = no_genes.select('unique_variant_id').toPandas()['unique_variant_id'].values\nprint(len(no_genes_vars))\nprint(len(set(no_genes_vars)))",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:45:07+0000",
      "progress": 94,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "4822\n4822\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=9",
              "$$hashKey": "object:35959"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658848224989_819337173",
      "id": "paragraph_1658848224989_819337173",
      "dateCreated": "2022-07-26T15:10:24+0000",
      "dateStarted": "2022-07-29T11:46:35+0000",
      "dateFinished": "2022-07-29T11:46:39+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32187"
    },
    {
      "text": "%pyspark\nCounter(j.select('symbol').toPandas()['symbol'].values).most_common()",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T15:42:19+0000",
      "progress": 85,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658848719391_216243219",
      "id": "paragraph_1658848719391_216243219",
      "dateCreated": "2022-07-26T15:18:39+0000",
      "dateStarted": "2022-07-26T15:42:19+0000",
      "dateFinished": "2022-07-26T15:43:15+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32188"
    },
    {
      "text": "%pyspark\nCounter(j.drop_duplicates(['unique_variant_id']).select('symbol').toPandas()['symbol'].values).most_common()",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:32:38+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658848307457_1674132687",
      "id": "paragraph_1658848307457_1674132687",
      "dateCreated": "2022-07-26T15:11:47+0000",
      "dateStarted": "2022-07-26T18:32:38+0000",
      "dateFinished": "2022-07-26T18:33:20+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32189"
    },
    {
      "text": "%pyspark\nset(no_genes_vars).intersection(set(ju))",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T15:11:42+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "set()"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658848268880_1972999003",
      "id": "paragraph_1658848268880_1972999003",
      "dateCreated": "2022-07-26T15:11:08+0000",
      "dateStarted": "2022-07-26T15:11:22+0000",
      "dateFinished": "2022-07-26T15:11:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32190"
    },
    {
      "text": "%pyspark\nno_genes.show(1)",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T14:48:32+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------+---------+---------+---------+-----------------+------+-------+---------------------+--------------------+------+----+----------+------------+----------+\n|    start|      end|reference|alternate|unique_variant_id|  qual|INFO_DP|splitFromMultiAllelic|           genotypes|symbol|rsID|cadd_score|eqtl_boolean|chromosome|\n+---------+---------+---------+---------+-----------------+------+-------+---------------------+--------------------+------+----+----------+------------+----------+\n|114139664|114139664|        G|        A|  1:114139664:G:A|341.77|     40|                 true|[{BS_0302Y3N5, 99...|      |    |      28.4|           0|         1|\n+---------+---------+---------+---------+-----------------+------+-------+---------------------+--------------------+------+----+----------+------------+----------+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-249.ec2.internal:4040/jobs/job?id=73",
              "$$hashKey": "object:36153"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658846869852_1495831856",
      "id": "paragraph_1658846869852_1495831856",
      "dateCreated": "2022-07-26T14:47:49+0000",
      "dateStarted": "2022-07-26T14:48:32+0000",
      "dateFinished": "2022-07-26T14:49:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32191"
    },
    {
      "text": "%pyspark\nj = j.drop_duplicates(['unique_variant_id'])",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:47:45+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658854560681_2117861325",
      "id": "paragraph_1658854560681_2117861325",
      "dateCreated": "2022-07-26T16:56:00+0000",
      "dateStarted": "2022-07-29T11:47:45+0000",
      "dateFinished": "2022-07-29T11:47:45+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32192"
    },
    {
      "text": "%pyspark\n\ncols = [ 'chromosome','start', 'end', 'reference', 'alternate', 'unique_variant_id', 'qual',\n             'INFO_DP', 'splitFromMultiAllelic', 'genotypes', 'symbol', 'rsID', 'cadd_score', 'eqtl_boolean']\n             \nchd_BS_scored_vars_mapped = j.select(cols).union(has_genes.select(cols))\nchd_BS_scored_vars_mapped.show(1)",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:47:47+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+---------+---------+---------+---------+-----------------+------+-------+---------------------+--------------------+------+---------+----------+------------+\n|chromosome|    start|      end|reference|alternate|unique_variant_id|  qual|INFO_DP|splitFromMultiAllelic|           genotypes|symbol|     rsID|cadd_score|eqtl_boolean|\n+----------+---------+---------+---------+---------+-----------------+------+-------+---------------------+--------------------+------+---------+----------+------------+\n|        11|132850353|132850353|        T|        C| 11:132850353:T:C|488.77|     39|                 true|[{BS_0302Y3N5, 99...| OPCML|rs2659615|      20.5|           0|\n+----------+---------+---------+---------+---------+-----------------+------+-------+---------------------+--------------------+------+---------+----------+------------+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=10",
              "$$hashKey": "object:36253"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658843525821_1097344109",
      "id": "paragraph_1658843525821_1097344109",
      "dateCreated": "2022-07-26T13:52:05+0000",
      "dateStarted": "2022-07-29T11:47:48+0000",
      "dateFinished": "2022-07-29T11:47:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32193"
    },
    {
      "text": "%pyspark\nchd_BS_scored_vars_wgenes  = chd_BS_scored_vars_mapped.where(col('symbol').isNotNull())",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:47:51+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658864839552_2120292031",
      "id": "paragraph_1658864839552_2120292031",
      "dateCreated": "2022-07-26T19:47:19+0000",
      "dateStarted": "2022-07-29T11:47:51+0000",
      "dateFinished": "2022-07-29T11:47:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32194"
    },
    {
      "text": "%pyspark\n\ndf_join = chd_BS_scored_vars_wgenes\n\ndf_join = df_join.withColumn('calls', df_join.genotypes.getItem(0).getItem('6'))\ndf_join = df_join.withColumn('calls_str',concat(df_join.calls.getItem(0), lit(\":\"), df_join.calls.getItem(1) ))\ndf_join = df_join.withColumn('AdditiveGenotype',when(df_join.calls_str.contains('-')  ,-9)\\\n                      .otherwise(df_join.calls.getItem(0) + df_join.calls.getItem(1)))\n\n# Create Participant ID column (should just be one participant per file)\ndf_join = df_join.withColumn('participant_id', df_join.genotypes.getItem(0).getItem('0'))\ndf_join = df_join.withColumn('INFO_DP',df_join.genotypes.getItem(0).getItem('10'))\ndf_join = df_join.withColumn('qual',df_join.genotypes.getItem(0).getItem('1'))\ndf_join = df_join.withColumn('PL',df_join.genotypes.getItem(0).getItem('9'))\n\ndf_join = df_join.withColumn('AdditiveGenotype',when((df_join.INFO_DP < 15) | (df_join.qual < 25) ,-9)\\\n                      .otherwise(df_join.AdditiveGenotype))\ndf_join = df_join.where(~ ((df_join.splitFromMultiAllelic == 'true') & (df_join.alternate == '<NON_REF>') ))\n\n#df_join = df_join.sort(['chromosome','start'])\n#df_join = df_join.drop(*(\"splitFromMultiAllelic\")).dropDuplicates(['unique_variant_id','AdditiveGenotype'])\n\ndf_join = df_join.withColumn('PL_00',df_join.PL.getItem(0)).withColumn('PL_01',df_join.PL.getItem(1)).withColumn('PL_11',df_join.PL.getItem(2))\n\ndf_join = df_join.withColumn('AdditiveGenotype',when((df_join.PL_00 == 0) & (df_join.PL_01 == 0) &\\\n                                           (col('AdditiveGenotype') == 0 ),-9).otherwise(df_join.AdditiveGenotype))\n                                           \ndf_join = df_join.withColumn('AdditiveGenotype',when(((df_join.PL_00 == 0) & (df_join.PL_01 == 0) &\\\n                     (df_join.PL_11 == 0)) & (col('AdditiveGenotype') == 0 ) ,-9).otherwise(df_join.AdditiveGenotype))\n\ndf_join = df_join.drop(*(\"PL\",\"PL_00\",\"PL_01\",\"PL_11\"))",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:47:54+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658864353230_439145774",
      "id": "paragraph_1658864353230_439145774",
      "dateCreated": "2022-07-26T19:39:13+0000",
      "dateStarted": "2022-07-29T11:47:54+0000",
      "dateFinished": "2022-07-29T11:47:55+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32195"
    },
    {
      "text": "%pyspark\nchd_BS_scored_vars_wgenes = df_join.select('chromosome','start','end','reference','alternate',\n                                                'unique_variant_id','symbol','rsID','cadd_score','eqtl_boolean','AdditiveGenotype')",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:47:58+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658864367819_1949827200",
      "id": "paragraph_1658864367819_1949827200",
      "dateCreated": "2022-07-26T19:39:27+0000",
      "dateStarted": "2022-07-29T11:47:58+0000",
      "dateFinished": "2022-07-29T11:47:58+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32196"
    },
    {
      "text": "%pyspark\nCounter(chd_BS_scored_vars_mapped.drop_duplicates(['unique_variant_id']).select('symbol').toPandas()['symbol'].values).most_common()",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:35:09+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658860501239_1863897694",
      "id": "paragraph_1658860501239_1863897694",
      "dateCreated": "2022-07-26T18:35:01+0000",
      "dateStarted": "2022-07-26T18:35:09+0000",
      "dateFinished": "2022-07-26T18:35:51+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32197"
    },
    {
      "text": "%pyspark\n\n# get the frequency of each gene\ndf = chd_BS_scored_vars_wgenes.toPandas()\ndf['cadd_score'] = df['cadd_score'].astype(np.float64)\n\nsymbol_freqs = dict(Counter(df['symbol']))\nsymbol_freq_df = pd.DataFrame.from_dict(symbol_freqs,orient='index',columns=['frequency']) \nsymbol_freq_df.index.name = 'symbol'\nsymbol_freq_df.head(3)",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:48:03+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>frequency</th>\n    </tr>\n    <tr>\n      <th>symbol</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>OPCML</th>\n      <td>12</td>\n    </tr>\n    <tr>\n      <th>IGSF9B</th>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>TYR</th>\n      <td>2</td>\n    </tr>\n  </tbody>\n</table>\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=11",
              "$$hashKey": "object:36475"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658850221932_2036638584",
      "id": "paragraph_1658850221932_2036638584",
      "dateCreated": "2022-07-26T15:43:41+0000",
      "dateStarted": "2022-07-29T11:48:03+0000",
      "dateFinished": "2022-07-29T11:48:11+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32198"
    },
    {
      "text": "%pyspark\ngene_scores = df[['symbol','cadd_score']].groupby('symbol').sum()\ndf_genes = gene_scores.join(symbol_freq_df).sort_values('cadd_score',ascending=False)\ndf_genes['symbol'] = df_genes.index\ndf_genes = df_genes.reset_index(drop=True)\ndf_genes['cadd_score_gene_agg'] = df_genes['cadd_score']\ndf_genes.drop('cadd_score',axis=1,inplace=True)\ndf_genes.head(5)\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:48:06+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>frequency</th>\n      <th>symbol</th>\n      <th>cadd_score_gene_agg</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>24</td>\n      <td>GXYLT1</td>\n      <td>567.150</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>29</td>\n      <td>HLA-DRB1</td>\n      <td>521.350</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>28</td>\n      <td>PABPC3</td>\n      <td>471.970</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>18</td>\n      <td>HLA-DRB5</td>\n      <td>468.060</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>23</td>\n      <td>KCNJ12</td>\n      <td>461.607</td>\n    </tr>\n  </tbody>\n</table>\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658859949923_153376794",
      "id": "paragraph_1658859949923_153376794",
      "dateCreated": "2022-07-26T18:25:49+0000",
      "dateStarted": "2022-07-29T11:48:06+0000",
      "dateFinished": "2022-07-29T11:48:11+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32199"
    },
    {
      "text": "%pyspark\n\n# merge the variants back in\nrejoin = df_genes.merge(df,on='symbol',how='right')\nprint(rejoin.shape)\nrejoin.head(1)",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:52:47+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "(144704, 13)\n\n"
          },
          {
            "type": "HTML",
            "data": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>frequency</th>\n      <th>symbol</th>\n      <th>cadd_score_gene_agg</th>\n      <th>chromosome</th>\n      <th>start</th>\n      <th>end</th>\n      <th>reference</th>\n      <th>alternate</th>\n      <th>unique_variant_id</th>\n      <th>rsID</th>\n      <th>cadd_score</th>\n      <th>eqtl_boolean</th>\n      <th>AdditiveGenotype</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>12</td>\n      <td>OPCML</td>\n      <td>94.121</td>\n      <td>11</td>\n      <td>132850353</td>\n      <td>132850353</td>\n      <td>T</td>\n      <td>C</td>\n      <td>11:132850353:T:C</td>\n      <td>rs2659615</td>\n      <td>20.5</td>\n      <td>0</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658865822631_1283527833",
      "id": "paragraph_1658865822631_1283527833",
      "dateCreated": "2022-07-26T20:03:42+0000",
      "dateStarted": "2022-07-29T11:52:48+0000",
      "dateFinished": "2022-07-29T11:52:48+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32200"
    },
    {
      "text": "%pyspark\ndf_genes = rejoin",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:53:23+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658867005372_1464696256",
      "id": "paragraph_1658867005372_1464696256",
      "dateCreated": "2022-07-26T20:23:25+0000",
      "dateStarted": "2022-07-29T11:53:23+0000",
      "dateFinished": "2022-07-29T11:53:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32201"
    },
    {
      "text": "%pyspark\ngenome_bed = spark.read.csv('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/gene_regions_refseq',header=True,sep='\\t')\ngenome_bed = genome_bed.withColumn('symbol',col('name2')).drop('name2')\ngenome_bed.show(1)\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:53:31+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+--------------+-----+------+--------+--------+--------+--------+---------+--------------------+--------------------+-----+------------+----------+--------------------+--------+\n|#bin|          name|chrom|strand| txStart|   txEnd|cdsStart|  cdsEnd|exonCount|          exonStarts|            exonEnds|score|cdsStartStat|cdsEndStat|          exonFrames|  symbol|\n+----+--------------+-----+------+--------+--------+--------+--------+---------+--------------------+--------------------+-----+------------+----------+--------------------+--------+\n|   0|NM_001276352.2| chr1|     -|67092164|67134970|67093579|67127240|        9|67092164,67096251...|67093604,67096321...|    0|        cmpl|      cmpl|2,1,0,1,2,0,0,-1,-1,|C1orf141|\n+----+--------------+-----+------+--------+--------+--------+--------+---------+--------------------+--------------------+-----+------------+----------+--------------------+--------+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=12",
              "$$hashKey": "object:36681"
            },
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=13",
              "$$hashKey": "object:36682"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658859953468_746771312",
      "id": "paragraph_1658859953468_746771312",
      "dateCreated": "2022-07-26T18:25:53+0000",
      "dateStarted": "2022-07-29T11:53:31+0000",
      "dateFinished": "2022-07-29T11:53:32+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32202"
    },
    {
      "text": "%pyspark\ngenome_bed_select = genome_bed.select(['chrom','txStart','txEnd','cdsStart','cdsEnd','symbol'])\nprint(genome_bed_select.count())\n\ngenome_bed_noDups = genome_bed_select.dropDuplicates(['symbol'])\nprint(genome_bed_noDups.count())\n\ngenome_bed_noDups = genome_bed_noDups.withColumn('txDiff',col('txEnd') - col('txStart'))\ngenome_bed_noDups.show(3)",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T11:53:35+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "172809\n38537\n+--------------------+--------+--------+--------+--------+------+-------+\n|               chrom| txStart|   txEnd|cdsStart|  cdsEnd|symbol| txDiff|\n+--------------------+--------+--------+--------+--------+------+-------+\n|               chr16|70252294|70289509|70289509|70289509| AARS1|37215.0|\n|chr16_KI270853v1_alt| 1807490| 1881466| 1808058| 1877819| ABCC6|73976.0|\n|                chr5|81309044|81358614|81310974|81347811|ACOT12|49570.0|\n+--------------------+--------+--------+--------+--------+------+-------+\nonly showing top 3 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=14",
              "$$hashKey": "object:36744"
            },
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=15",
              "$$hashKey": "object:36745"
            },
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=16",
              "$$hashKey": "object:36746"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658861484717_794302697",
      "id": "paragraph_1658861484717_794302697",
      "dateCreated": "2022-07-26T18:51:24+0000",
      "dateStarted": "2022-07-29T11:53:35+0000",
      "dateFinished": "2022-07-29T11:53:37+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32203"
    },
    {
      "text": "%pyspark\n# How much coverage do we have for our list of genes?\nbed_genes = genome_bed_noDups.select('symbol').collect()\nmy_genes = set(list(np.unique(df_genes['symbol']))) # 30988\nbed_genes = set(list(np.unique([i[0] for i in bed_genes])))\nlen(bed_genes.intersection(my_genes))",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T12:02:18+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "18270"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=17",
              "$$hashKey": "object:36812"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658861482987_2059666525",
      "id": "paragraph_1658861482987_2059666525",
      "dateCreated": "2022-07-26T18:51:22+0000",
      "dateStarted": "2022-07-29T12:02:18+0000",
      "dateFinished": "2022-07-29T12:02:19+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32204"
    },
    {
      "text": "%pyspark\ndf_Gene_spark = spark.createDataFrame(df_genes)   # How did CADD_score get so many decimals?\n\nnormed = genome_bed_noDups.select(['symbol','txDiff']).join(df_Gene_spark,['symbol'])\n\nnormed = normed.withColumn('normed_CADD_score', F.round(1000*(col('cadd_score_gene_agg')/col('txDiff')),3 )).drop('hgvsc','hgvsg','strand')\n\nnormed.sort('normed_CADD_score',ascending=False).show(50)",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T12:03:01+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------+---------+-------------------+----------+---------+---------+---------+---------+-------------------+-----------+------------------+------------+----------------+-----------------+\n| symbol|txDiff|frequency|cadd_score_gene_agg|chromosome|    start|      end|reference|alternate|  unique_variant_id|       rsID|        cadd_score|eqtl_boolean|AdditiveGenotype|normed_CADD_score|\n+-------+------+---------+-------------------+----------+---------+---------+---------+---------+-------------------+-----------+------------------+------------+----------------+-----------------+\n|MIR4273|  84.0|        7| 161.79999999999998|         3| 75738118| 75738118|        G|        A|     3:75738118:G:A|       null|              21.5|           0|               1|          1926.19|\n|MIR4273|  84.0|        7| 161.79999999999998|         3| 75738425| 75738425|        A|        G|     3:75738425:A:G|rs141348932|              22.5|           0|               1|          1926.19|\n|MIR4273|  84.0|        7| 161.79999999999998|         3| 75737533| 75737533|        G|        T|     3:75737533:G:T|rs201345045|              22.3|           0|               1|          1926.19|\n|MIR4273|  84.0|        7| 161.79999999999998|         3| 75737201| 75737201|        G|        A|     3:75737201:G:A|rs140870505|              22.7|           0|               1|          1926.19|\n|MIR4273|  84.0|        7| 161.79999999999998|         3| 75738339| 75738339|        A|        T|     3:75738339:A:T|rs201399274|              25.1|           0|               1|          1926.19|\n|MIR4273|  84.0|        7| 161.79999999999998|         3| 75737024| 75737024|        C|        A|     3:75737024:C:A|rs144353922|              24.9|           0|               1|          1926.19|\n|MIR4273|  84.0|        7| 161.79999999999998|         3| 75737252| 75737252|        A|        T|     3:75737252:A:T|rs150272782|              22.8|           0|               1|          1926.19|\n|MIR4752|  72.0|        3|               67.5|        19| 54279359| 54279359|        T|        C|    19:54279359:T:C|       null|              22.9|           0|               1|            937.5|\n|MIR4752|  72.0|        3|               67.5|        19| 54279045| 54279046|       AG|        A|   19:54279045:AG:A|       null|              22.5|           0|               1|            937.5|\n|MIR4752|  72.0|        3|               67.5|        19| 54279040| 54279040|        G|        A|    19:54279040:G:A|       null|              22.1|           0|               1|            937.5|\n|MIR7705|  57.0|        2|               51.5|         8|100706737|100706737|        G|        A|    8:100706737:G:A| rs62513921|              26.2|           0|               0|          903.509|\n|MIR7705|  57.0|        2|               51.5|         8|100706776|100706776|        G|        A|    8:100706776:G:A| rs62513924|              25.3|           0|               0|          903.509|\n|SNORA63| 135.0|       20|             90.696|         3|186967511|186967511|        A|        G|    3:186967511:A:G| rs12495023|             1.204|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         1| 36972175| 36972175|        T|        C|     1:36972175:T:C|   rs575605|             8.626|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|185806391|185806391|        C|        A|    3:185806391:C:A| rs73175579|             6.349|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|183326714|183326718|    GTGTA|        G|3:183326714:GTGTA:G| rs67823358|4.5939999999999985|           1|               2|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|186297127|186297129|      CTT|        C|  3:186297127:CTT:C| rs10574880|             0.541|           1|               2|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|187245342|187245342|        G|        T|    3:187245342:G:T|   rs710462|             3.452|           1|               2|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|184300100|184300100|        T|        C|    3:184300100:T:C| rs55782344|             4.199|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|187177876|187177877|       TG|        T|   3:187177876:TG:T|rs773441661|             0.607|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|186335823|186335823|        C|        T|    3:186335823:C:T| rs13071528|             0.096|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|186312608|186312608|        C|        T|    3:186312608:C:T|  rs2268817|             0.033|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|186997531|186997531|        G|        A|    3:186997531:G:A| rs35376994|              2.66|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|183210988|183210988|        G|        A|    3:183210988:G:A|  rs6787284|             2.995|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|187737983|187737983|        A|        G|    3:187737983:A:G|  rs6762219|             15.09|           1|               2|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|186786359|186786359|        T|        C|    3:186786359:T:C|   rs266718|             8.546|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|187740033|187740033|        G|        A|    3:187740033:G:A|  rs6775438|             15.06|           1|               2|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|187055655|187055655|        G|        A|    3:187055655:G:A|  rs7638437|              2.62|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|186234981|186234981|        C|     CCAA| 3:186234981:C:CCAA| rs76024805|             1.969|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|186994188|186994188|        A|        G|    3:186994188:A:G|  rs9851084|             7.816|           1|               1|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|186991016|186991016|        A|        G|    3:186991016:A:G|   rs759602|             2.141|           1|               2|          671.822|\n|SNORA63| 135.0|       20|             90.696|         3|187235438|187235438|        C|        G|    3:187235438:C:G|   rs850313|2.0980000000000003|           1|               2|          671.822|\n|SNORD61|  73.0|        2|               48.2|         X|136874249|136874249|        A|        G|    X:136874249:A:G| rs76876438|              24.6|           0|               1|          660.274|\n|SNORD61|  73.0|        2|               48.2|         X|136874308|136874308|        C|        T|    X:136874308:C:T| rs35899675|              23.6|           0|               1|          660.274|\n|MIR1249|  66.0|        1|               32.0|        22| 45205788| 45205791|     CATA|        C| 22:45205788:CATA:C|       null|              32.0|           0|               1|          484.848|\n|SNORD68|  72.0|        8| 31.400000000000002|        16| 88754125| 88754125|        T|        C|    16:88754125:T:C| rs12596437|             1.262|           1|               1|          436.111|\n|SNORD68|  72.0|        8| 31.400000000000002|        16| 89094965| 89094965|        T|        C|    16:89094965:T:C|  rs4782334|             8.861|           1|               1|          436.111|\n|SNORD68|  72.0|        8| 31.400000000000002|        16| 88710995| 88710995|        T|        C|    16:88710995:T:C| rs11076703|              0.87|           1|               1|          436.111|\n|SNORD68|  72.0|        8| 31.400000000000002|        16| 89506257| 89506257|        A|        G|    16:89506257:A:G| rs57696383|             8.844|           1|               1|          436.111|\n|SNORD68|  72.0|        8| 31.400000000000002|        16| 89536656| 89536656|        A|        G|    16:89536656:A:G|   rs647747|             4.665|           1|               1|          436.111|\n|SNORD68|  72.0|        8| 31.400000000000002|        16| 90007911| 90007911|        G|        T|    16:90007911:G:T| rs79458284|             0.593|           1|               1|          436.111|\n|SNORD68|  72.0|        8| 31.400000000000002|        16| 90069870| 90069870|        A|        G|    16:90069870:A:G|  rs7200083|             6.135|           1|               1|          436.111|\n|SNORD68|  72.0|        8| 31.400000000000002|        16| 90042424| 90042424|        C|        T|    16:90042424:C:T|  rs2241035|              0.17|           1|               2|          436.111|\n|MIR4521|  60.0|        1|               22.3|        17|  8190006|  8190006|        C|        G|     17:8190006:C:G|rs150061068|              22.3|           0|               1|          371.667|\n|MIR6891|  93.0|        3| 34.412000000000006|         6| 31359847| 31359847|        G|        A|     6:31359847:G:A| rs74762609|             5.472|           1|               1|          370.022|\n|MIR6891|  93.0|        3| 34.412000000000006|         6| 31353908| 31353908|        A|        C|     6:31353908:A:C|  rs1058026|              6.34|           1|               1|          370.022|\n|MIR6891|  93.0|        3| 34.412000000000006|         6| 31356822| 31356822|        T|        G|     6:31356822:T:G|  rs1050538|              22.6|           0|              -9|          370.022|\n|MIR6513|  64.0|        1|               22.6|         2|218282080|218282080|        G|        A|    2:218282080:G:A|  rs2292553|              22.6|           0|               1|          353.125|\n|MIR6832|  72.0|        1|               23.5|         6| 31636814| 31636814|        C|        T|     6:31636814:C:T|    rs10885|              23.5|           0|               1|          326.389|\n|MIR5696|  85.0|        1|               26.2|         2|101308173|101308173|        T|        C|    2:101308173:T:C|rs143827530|              26.2|           0|               1|          308.235|\n+-------+------+---------+-------------------+----------+---------+---------+---------+---------+-------------------+-----------+------------------+------------+----------------+-----------------+\nonly showing top 50 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=19",
              "$$hashKey": "object:36870"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658861566877_18288876",
      "id": "paragraph_1658861566877_18288876",
      "dateCreated": "2022-07-26T18:52:46+0000",
      "dateStarted": "2022-07-29T12:03:01+0000",
      "dateFinished": "2022-07-29T12:03:21+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32205"
    },
    {
      "text": "%pyspark\nnormed.drop_duplicates(['symbol']).sort('normed_CADD_score',ascending=False).select('symbol','normed_CADD_score').show(10)",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T12:08:39+0000",
      "progress": 27,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+-----------------+\n| symbol|normed_CADD_score|\n+-------+-----------------+\n|MIR4273|          1926.19|\n|MIR4752|            937.5|\n|MIR7705|          903.509|\n|SNORA63|          671.822|\n|SNORD61|          660.274|\n|MIR1249|          484.848|\n|SNORD68|          436.111|\n|MIR4521|          371.667|\n|MIR6891|          370.022|\n|MIR6513|          353.125|\n+-------+-----------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=25",
              "$$hashKey": "object:36928"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659012474541_2404653",
      "id": "paragraph_1659012474541_2404653",
      "dateCreated": "2022-07-28T12:47:54+0000",
      "dateStarted": "2022-07-29T12:08:40+0000",
      "dateFinished": "2022-07-29T12:08:41+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32206"
    },
    {
      "text": "%pyspark\n#  Get rid of MicroRNA's (starts with MIR) microRNAs and Small nucleolar RNAs (snoRNAs)\nnormed_filter = normed.where(~ (col('symbol').startswith('MIR')) | ((col('symbol').startswith('SNO'))) )",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T12:03:51+0000",
      "progress": 100,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658863762457_463154578",
      "id": "paragraph_1658863762457_463154578",
      "dateCreated": "2022-07-26T19:29:22+0000",
      "dateStarted": "2022-07-29T12:03:51+0000",
      "dateFinished": "2022-07-29T12:03:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32207"
    },
    {
      "text": "%pyspark\nnormed_filter = normed_filter.withColumn('cadd_score_gene_agg',F.round(col('cadd_score_gene_agg'),3)).drop('reference','alternate','start','txDiff')",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T12:15:02+0000",
      "progress": 100,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658861920704_1883174757",
      "id": "paragraph_1658861920704_1883174757",
      "dateCreated": "2022-07-26T18:58:40+0000",
      "dateStarted": "2022-07-29T12:15:02+0000",
      "dateFinished": "2022-07-29T12:15:03+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32208"
    },
    {
      "text": "%pyspark\n.repartitionByRange(10, \"chromosome\", \"start\").write\\\n      .mode('overwrite')\\\n      .partitionBy(\"chromosome\")\\\n       .parquet(\"tcsq_variant_gene_mappings.parquet\")",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T12:11:34+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658861566186_1581710560",
      "id": "paragraph_1658861566186_1581710560",
      "dateCreated": "2022-07-26T18:52:46+0000",
      "status": "READY",
      "$$hashKey": "object:32209"
    },
    {
      "text": "%pyspark\nnormed_filter.show()",
      "user": "anonymous",
      "dateUpdated": "2022-07-29T12:15:14+0000",
      "progress": 100,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+---------+-------------------+----------+---------+--------------------+-----------+------------------+------------+----------------+-----------------+\n|symbol|frequency|cadd_score_gene_agg|chromosome|      end|   unique_variant_id|       rsID|        cadd_score|eqtl_boolean|AdditiveGenotype|normed_CADD_score|\n+------+---------+-------------------+----------+---------+--------------------+-----------+------------------+------------+----------------+-----------------+\n| OPCML|       12|             94.121|        11|132850353|    11:132850353:T:C|  rs2659615|              20.5|           0|               1|            0.083|\n| OPCML|       12|             94.121|        11|132831611|    11:132831611:T:C| rs11223233|              20.2|           0|               1|            0.083|\n| OPCML|       12|             94.121|        11|132836662|    11:132836662:T:C| rs73041427|              21.1|           0|               1|            0.083|\n| OPCML|       12|             94.121|        11|132830846|    11:132830846:T:C| rs11601136|              21.6|           0|               1|            0.083|\n| OPCML|       12|             94.121|        11|133921459|    11:133921459:C:T| rs11223621|             3.248|           1|               1|            0.083|\n| OPCML|       12|             94.121|        11|134373553|    11:134373553:C:T|  rs3741098|             0.604|           1|               1|            0.083|\n| OPCML|       12|             94.121|        11|133469980|    11:133469980:A:G|  rs7481898|             0.476|           1|               2|            0.083|\n| OPCML|       12|             94.121|        11|133075504|    11:133075504:A:G| rs11223357|             2.674|           1|               1|            0.083|\n| OPCML|       12|             94.121|        11|132547358|    11:132547358:A:G|  rs6590643|             0.119|           1|               1|            0.083|\n| OPCML|       12|             94.121|        11|132888453|    11:132888453:T:C|  rs1027798|             0.191|           1|               1|            0.083|\n| OPCML|       12|             94.121|        11|133458846|11:133458846:T:TACAC|rs766549488|             0.565|           1|               1|            0.083|\n| OPCML|       12|             94.121|        11|132895998|    11:132895998:T:C| rs12799692|             2.844|           1|               1|            0.083|\n|IGSF9B|        6|              26.47|        11|133919097|    11:133919097:T:C| rs12800905|              22.5|           0|               1|            0.437|\n|IGSF9B|        6|              26.47|        11|133520574|    11:133520574:G:C|  rs7108670|              1.01|           1|               1|            0.437|\n|IGSF9B|        6|              26.47|        11|134357507|    11:134357507:A:G|  rs7103356|             0.032|           1|               1|            0.437|\n|IGSF9B|        6|              26.47|        11|134126584|    11:134126584:C:T|  rs4937867|1.4069999999999998|           1|               1|            0.437|\n|IGSF9B|        6|              26.47|        11|134218788|    11:134218788:G:A|  rs1031381|             0.411|           1|               1|            0.437|\n|IGSF9B|        6|              26.47|        11|133930324|    11:133930324:C:A|  rs1682859|              1.11|           1|               1|            0.437|\n|   TYR|        2|              38.91|        11| 89284793|     11:89284793:G:A|  rs1126809|              27.2|           0|               1|            0.331|\n|   TYR|        2|              38.91|        11| 89042605|     11:89042605:A:C| rs16924543|             11.71|           1|               1|            0.331|\n+------+---------+-------------------+----------+---------+--------------------+-----------+------------------+------------+----------------+-----------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-71.ec2.internal:4040/jobs/job?id=33",
              "$$hashKey": "object:37112"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658861565760_581914935",
      "id": "paragraph_1658861565760_581914935",
      "dateCreated": "2022-07-26T18:52:45+0000",
      "dateStarted": "2022-07-29T12:15:14+0000",
      "dateFinished": "2022-07-29T12:15:15+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32210"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:52:44+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658861564683_1109154476",
      "id": "paragraph_1658861564683_1109154476",
      "dateCreated": "2022-07-26T18:52:44+0000",
      "status": "READY",
      "$$hashKey": "object:32211"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-28T23:38:51+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659051531593_1498099352",
      "id": "paragraph_1659051531593_1498099352",
      "dateCreated": "2022-07-28T23:38:51+0000",
      "status": "READY",
      "$$hashKey": "object:32212"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-28T23:38:50+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659051530831_726096268",
      "id": "paragraph_1659051530831_726096268",
      "dateCreated": "2022-07-28T23:38:50+0000",
      "status": "READY",
      "$$hashKey": "object:32213"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-28T23:38:49+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1659051529846_551390471",
      "id": "paragraph_1659051529846_551390471",
      "dateCreated": "2022-07-28T23:38:49+0000",
      "status": "READY",
      "$$hashKey": "object:32214"
    },
    {
      "text": "%pyspark\nsnps = spark.read.csv(\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/results_chd_cadd/snp_cadd_gt20.csv\")\nsnps = snps.select(col(\"_c0\").alias(\"chromosome\"), col(\"_c1\").alias(\"start\"),\ncol(\"_c2\").alias(\"reference\"),col(\"_c3\").alias(\"alternate\"),col('_c4').alias('CADD_score'))\nprint(snps.count())\nsnps.show(5)",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T19:16:16+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "161265\n+----------+-------+---------+---------+----------+\n|chromosome|  start|reference|alternate|CADD_score|\n+----------+-------+---------+---------+----------+\n|         1| 999900|        G|        T|      24.5|\n|         1|1712339|        T|        G|      23.0|\n|         1|3126040|        A|        G|      22.4|\n|         1|3142245|        C|        G|      20.7|\n|         1|7970951|        G|        A|        31|\n+----------+-------+---------+---------+----------+\nonly showing top 5 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=0",
              "$$hashKey": "object:37338"
            },
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=1",
              "$$hashKey": "object:37339"
            },
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=2",
              "$$hashKey": "object:37340"
            },
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=3",
              "$$hashKey": "object:37341"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654270572647_1202102597",
      "id": "paragraph_1654270572647_1202102597",
      "dateCreated": "2022-06-03T15:36:12+0000",
      "dateStarted": "2022-06-16T19:16:30+0000",
      "dateFinished": "2022-06-16T19:18:06+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32215"
    },
    {
      "text": "%pyspark\n# read in indel variants that have been merged w/ CADD scores (gt 20)\nnonsnps = spark.read.csv(\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/results_chd_cadd/NON_snp_cadd_gt20.csv\")\nprint(nonsnps.count())\n\nnonsnps = nonsnps.select(col(\"_c0\").alias(\"chromosome\"), col(\"_c1\").alias(\"start\"),\n                        col(\"_c2\").alias(\"reference\"),col(\"_c3\").alias(\"alternate\"),col('_c4').alias('CADD_score'))\n#nonsnps.show()",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T19:16:19+0000",
      "progress": 95,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "9743\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=4",
              "$$hashKey": "object:37411"
            },
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=5",
              "$$hashKey": "object:37412"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654623391940_1106041414",
      "id": "paragraph_1654623391940_1106041414",
      "dateCreated": "2022-06-07T17:36:31+0000",
      "dateStarted": "2022-06-16T19:17:44+0000",
      "dateFinished": "2022-06-16T19:18:08+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32216"
    },
    {
      "text": "%pyspark\n# concatenate snps and non-snps results\nvariants_cadd = snps.union(nonsnps)\n\nprint(variants_cadd.count())\n#variants_cadd.show(3)",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T19:16:22+0000",
      "progress": 98,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "171008\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=6",
              "$$hashKey": "object:37474"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654623554680_1071847968",
      "id": "paragraph_1654623554680_1071847968",
      "dateCreated": "2022-06-07T17:39:14+0000",
      "dateStarted": "2022-06-16T19:18:06+0000",
      "dateFinished": "2022-06-16T19:18:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32217"
    },
    {
      "text": "%pyspark\n'''study_id_list = ['SD_PREASA7S']\nt_ocr = spark \\\n    .table('occurrences') \\\n    .where((F.col('study_id').isin(study_id_list)) &  (F.col('is_proband') == 'true' ) )\n                     \nt_ocr.count()'''",
      "user": "anonymous",
      "dateUpdated": "2022-06-08T23:30:02+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "2209273359"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=6",
              "$$hashKey": "object:37532"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=7",
              "$$hashKey": "object:37533"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=8",
              "$$hashKey": "object:37534"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=9",
              "$$hashKey": "object:37535"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=10",
              "$$hashKey": "object:37536"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=11",
              "$$hashKey": "object:37537"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=12",
              "$$hashKey": "object:37538"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=13",
              "$$hashKey": "object:37539"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=14",
              "$$hashKey": "object:37540"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=15",
              "$$hashKey": "object:37541"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=16",
              "$$hashKey": "object:37542"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=17",
              "$$hashKey": "object:37543"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=18",
              "$$hashKey": "object:37544"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=19",
              "$$hashKey": "object:37545"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=20",
              "$$hashKey": "object:37546"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=21",
              "$$hashKey": "object:37547"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=22",
              "$$hashKey": "object:37548"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=23",
              "$$hashKey": "object:37549"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=24",
              "$$hashKey": "object:37550"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=25",
              "$$hashKey": "object:37551"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=26",
              "$$hashKey": "object:37552"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=27",
              "$$hashKey": "object:37553"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=28",
              "$$hashKey": "object:37554"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=29",
              "$$hashKey": "object:37555"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=30",
              "$$hashKey": "object:37556"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=31",
              "$$hashKey": "object:37557"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=32",
              "$$hashKey": "object:37558"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=33",
              "$$hashKey": "object:37559"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=34",
              "$$hashKey": "object:37560"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=35",
              "$$hashKey": "object:37561"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=36",
              "$$hashKey": "object:37562"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=37",
              "$$hashKey": "object:37563"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=38",
              "$$hashKey": "object:37564"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=39",
              "$$hashKey": "object:37565"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=40",
              "$$hashKey": "object:37566"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=41",
              "$$hashKey": "object:37567"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=42",
              "$$hashKey": "object:37568"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=43",
              "$$hashKey": "object:37569"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=44",
              "$$hashKey": "object:37570"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=45",
              "$$hashKey": "object:37571"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=46",
              "$$hashKey": "object:37572"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=47",
              "$$hashKey": "object:37573"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=48",
              "$$hashKey": "object:37574"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=49",
              "$$hashKey": "object:37575"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=50",
              "$$hashKey": "object:37576"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=51",
              "$$hashKey": "object:37577"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=52",
              "$$hashKey": "object:37578"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=53",
              "$$hashKey": "object:37579"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=54",
              "$$hashKey": "object:37580"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=55",
              "$$hashKey": "object:37581"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=56",
              "$$hashKey": "object:37582"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=57",
              "$$hashKey": "object:37583"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=58",
              "$$hashKey": "object:37584"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=59",
              "$$hashKey": "object:37585"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=60",
              "$$hashKey": "object:37586"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=61",
              "$$hashKey": "object:37587"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=62",
              "$$hashKey": "object:37588"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=63",
              "$$hashKey": "object:37589"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=64",
              "$$hashKey": "object:37590"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=65",
              "$$hashKey": "object:37591"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=66",
              "$$hashKey": "object:37592"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=67",
              "$$hashKey": "object:37593"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=68",
              "$$hashKey": "object:37594"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=69",
              "$$hashKey": "object:37595"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=70",
              "$$hashKey": "object:37596"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=71",
              "$$hashKey": "object:37597"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=72",
              "$$hashKey": "object:37598"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=73",
              "$$hashKey": "object:37599"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=74",
              "$$hashKey": "object:37600"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=75",
              "$$hashKey": "object:37601"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=76",
              "$$hashKey": "object:37602"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=77",
              "$$hashKey": "object:37603"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=78",
              "$$hashKey": "object:37604"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=79",
              "$$hashKey": "object:37605"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=80",
              "$$hashKey": "object:37606"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=81",
              "$$hashKey": "object:37607"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=82",
              "$$hashKey": "object:37608"
            },
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=83",
              "$$hashKey": "object:37609"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654355891718_1552735645",
      "id": "paragraph_1654355891718_1552735645",
      "dateCreated": "2022-06-04T15:18:11+0000",
      "dateStarted": "2022-06-05T14:10:58+0000",
      "dateFinished": "2022-06-05T14:19:31+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32218"
    },
    {
      "text": "%pyspark\n# FOR SAVING THE GENE-VARIANT MAPPINGS BY CHROM SO I CAN SAVE THEM AS CSV AND TRANSFER TO CAVATICA\nchroms = [str(c) for c in list(range(4,23))] + ['X','Y']\n\nfor CHROM in chroms:\n    print(CHROM)\n    t_csq_select_chr_pandas = t_csq_select.where(col('chromosome').isin([CHROM]))\n    t_csq_select_chr_pandas.toPandas().to_csv(f'tcsq_variant_gene_mappings_july27_chrom{CHROM}.csv')\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-28T12:17:54+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658924445380_114012613",
      "id": "paragraph_1658924445380_114012613",
      "dateCreated": "2022-07-27T12:20:45+0000",
      "dateStarted": "2022-07-27T12:39:46+0000",
      "dateFinished": "2022-07-27T12:58:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32219"
    },
    {
      "text": "%sh\n\ncp tcsq_variant_gene_mappings_july27_chromY.csv ~/cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-27T13:16:31+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658925275119_304522527",
      "id": "paragraph_1658925275119_304522527",
      "dateCreated": "2022-07-27T12:34:35+0000",
      "dateStarted": "2022-07-27T13:16:31+0000",
      "dateFinished": "2022-07-27T13:16:32+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32220"
    },
    {
      "text": "%pyspark\nt_csq_select_chr1to3 = t_csq_select.where(col('chromosome').isin(['1','2','3']))\n\nprint(t_csq_select_chr1to3.count())\n#.write.parquet(\n#          \"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/tcsq_variant_gene_mappings_july25_chroms1to6.parquet\")",
      "user": "anonymous",
      "dateUpdated": "2022-07-25T20:02:38+0000",
      "progress": 96,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "9328844\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-58.ec2.internal:4040/jobs/job?id=56",
              "$$hashKey": "object:38059"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658777238739_1391484521",
      "id": "paragraph_1658777238739_1391484521",
      "dateCreated": "2022-07-25T19:27:18+0000",
      "dateStarted": "2022-07-25T20:02:38+0000",
      "dateFinished": "2022-07-25T20:02:46+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32221"
    },
    {
      "text": "%pyspark\nj = spark.read.parquet(\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/tcsq_variant_gene_mappings_july13.parquet\")\nprint(j.count())\nj.show()\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-25T19:03:12+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "lineNumbers": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656948536347_1641340501",
      "id": "paragraph_1656948536347_1641340501",
      "dateCreated": "2022-07-04T15:28:56+0000",
      "dateStarted": "2022-07-25T19:02:42+0000",
      "dateFinished": "2022-07-25T19:02:53+0000",
      "status": "ERROR",
      "$$hashKey": "object:32222"
    },
    {
      "text": "%pyspark\nt_csq_select.repartitionByRange(60, \"chromosome\", \"start\").write\\\n      .mode('overwrite')\\\n      .partitionBy(\"chromosome\")\\\n       .parquet(\"tcsq_variant_gene_mappings.parquet\")\n      #.parquet(\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/cadd_scores/tcsq_variant_gene_mappings.parquet\")",
      "user": "anonymous",
      "dateUpdated": "2022-06-28T18:45:15+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-139.ec2.internal:4040/jobs/job?id=91",
              "$$hashKey": "object:38149"
            },
            {
              "jobUrl": "http://ip-10-12-3-139.ec2.internal:4040/jobs/job?id=92",
              "$$hashKey": "object:38150"
            },
            {
              "jobUrl": "http://ip-10-12-3-139.ec2.internal:4040/jobs/job?id=93",
              "$$hashKey": "object:38151"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1656439220786_237490736",
      "id": "paragraph_1656439220786_237490736",
      "dateCreated": "2022-06-28T18:00:20+0000",
      "dateStarted": "2022-06-28T18:45:15+0000",
      "dateFinished": "2022-06-28T18:48:30+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32223"
    },
    {
      "text": "%pyspark\nt_csq_select_noDups = t_csq_select.dropDuplicates(['chromosome','start', 'reference','alternate'])\n\n# whats the diifference in these dups?",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T19:16:32+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655209243001_984781627",
      "id": "paragraph_1655209243001_984781627",
      "dateCreated": "2022-06-14T12:20:43+0000",
      "dateStarted": "2022-06-16T19:18:10+0000",
      "dateFinished": "2022-06-16T19:27:35+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32224"
    },
    {
      "text": "%pyspark\nvars_csq_merge = variants_cadd.join(t_csq_select_noDups,['chromosome','start', 'reference','alternate'],'left')\n\nvars_csq_merge = vars_csq_merge.withColumn('unique_variant_id',concat(col(\"chromosome\"), lit(\":\"),col(\"start\"),lit(':'),col('reference'), lit(':'),col('alternate'),lit(':'))) \n\nvars_csq_merge.count() # 1166795 w/ snps only, 247420 w/ dups in t_csq_select, 171008 w/o dups",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T19:16:35+0000",
      "progress": 99,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "171008"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=85",
              "$$hashKey": "object:38259"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654355034832_1416039543",
      "id": "paragraph_1654355034832_1416039543",
      "dateCreated": "2022-06-04T15:03:54+0000",
      "dateStarted": "2022-06-16T19:27:35+0000",
      "dateFinished": "2022-06-16T19:28:16+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32225"
    },
    {
      "text": "%pyspark\nvars_csq_merge = vars_csq_merge.dropDuplicates() # what are these duplicates? see jeremys note\n#vars_csq_merge.where(col('reference') == 'ACCACCCCAGAGCCCAC').show() # why are there doubles still (after dropping doubles in vars_csq_merge )? \n#d = vars_csq_merge.groupBy(vars_csq_merge.columns).count().filter(\"count > 1\")\n#d.drop('count').show() \nprint(vars_csq_merge.count())",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T19:16:42+0000",
      "progress": 87,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "170881\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=86",
              "$$hashKey": "object:38317"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655383157893_885814470",
      "id": "paragraph_1655383157893_885814470",
      "dateCreated": "2022-06-16T12:39:17+0000",
      "dateStarted": "2022-06-16T19:27:35+0000",
      "dateFinished": "2022-06-16T19:29:59+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32226"
    },
    {
      "text": "%pyspark\ndf_snps = vars_csq_merge.toPandas()",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T12:13:18+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-137.ec2.internal:4040/jobs/job?id=97",
              "$$hashKey": "object:38365"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654439613778_1729676544",
      "id": "paragraph_1654439613778_1729676544",
      "dateCreated": "2022-06-05T14:33:33+0000",
      "dateStarted": "2022-06-16T12:13:18+0000",
      "dateFinished": "2022-06-16T12:14:57+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32227"
    },
    {
      "text": "%pyspark\n#df_snps#.duplicated()\n\nCounter(df_snps['impact'])",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T12:13:24+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Counter({'MODERATE': 87021,\n         None: 14798,\n         'MODIFIER': 60619,\n         'HIGH': 6768,\n         'LOW': 1675})"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654439885810_298185868",
      "id": "paragraph_1654439885810_298185868",
      "dateCreated": "2022-06-05T14:38:05+0000",
      "dateStarted": "2022-06-16T12:13:24+0000",
      "dateFinished": "2022-06-16T12:14:57+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32228"
    },
    {
      "text": "%md\n### Take HIGH impact variations from our results df and compare with the highImpacts file to find which HIGH impact variations we did NOT pick up with the CADD > 20 filtering. We want to find the CADD scores for these variants even if they are not greater than 20. \n",
      "user": "anonymous",
      "dateUpdated": "2022-06-13T17:44:46+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<h3>Take HIGH impact variations from our results df and compare with the highImpacts file to find which HIGH impact variations we did NOT pick up with the CADD &gt; 20 filtering. We want to find the CADD scores for these variants even if they are not greater than 20.</h3>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655141591319_1601270587",
      "id": "paragraph_1655141591319_1601270587",
      "dateCreated": "2022-06-13T17:33:11+0000",
      "dateStarted": "2022-06-13T17:44:46+0000",
      "dateFinished": "2022-06-13T17:44:46+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32229"
    },
    {
      "text": "%pyspark\n'''# Load the huge CADD file (80GB) and remove first 2 lines, they are headers.\nwhole_genome_cadd = spark.read.csv('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/whole_genome_SNVs.tsv.gz',\n                    header=False,sep=' ')\nwhole_genome_cadd = whole_genome_cadd.select(['_c0']).where(~col('_c0').startswith('#'))\nwhole_genome_cadd = whole_genome_cadd.withColumn('chromosome', F.split(whole_genome_cadd['_c0'], '\\t').getItem(0)) \\\n                               .withColumn('start', F.split(whole_genome_cadd['_c0'], '\\t').getItem(1)) \\\n                               .withColumn('reference', F.split(whole_genome_cadd['_c0'], '\\t').getItem(2)) \\\n                                .withColumn('alternate', F.split(whole_genome_cadd['_c0'], '\\t').getItem(3)) \\\n                                .withColumn('raw', F.split(whole_genome_cadd['_c0'], '\\t').getItem(4)) \\\n                                 .withColumn('PHRED', F.split(whole_genome_cadd['_c0'], '\\t').getItem(5)).drop('_c0')'''                                 \n                                 \n#highImpact = spark.read.parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/highImpact_noDups')\nhighImpact_all = t_csq_select.where(col('impact')=='HIGH')\n\nhighImpact_CADD = vars_csq_merge.where(col('impact')=='HIGH')\nprint(highImpact_all.count())\nprint(highImpact_CADD.count())\n\nhighImpact_all = highImpact_all.withColumn('unique_variant_id',concat(col(\"chromosome\"), lit(\":\"),col(\"start\"),lit(':'),col('reference'), lit(':'),col('alternate'),lit(':')))\nhighImpact_CADD = highImpact_CADD.withColumn('unique_variant_id',concat(col(\"chromosome\"), lit(\":\"),col(\"start\"),lit(':'),col('reference'), lit(':'),col('alternate'),lit(':'))) ",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T19:16:49+0000",
      "progress": 75,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "13667\n6768\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=87",
              "$$hashKey": "object:38521"
            },
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=89",
              "$$hashKey": "object:38522"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655141587708_1336115650",
      "id": "paragraph_1655141587708_1336115650",
      "dateCreated": "2022-06-13T17:33:07+0000",
      "dateStarted": "2022-06-16T19:28:16+0000",
      "dateFinished": "2022-06-16T19:32:03+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32230"
    },
    {
      "text": "%pyspark\n\nhighImpact_sub = highImpact_all.select('unique_variant_id').subtract(highImpact_CADD.select('unique_variant_id'))\nhighImpact_sub.count() # 10726 , do we get variants w/ cadd score gt20 with this method?\n# should be 6899",
      "user": "anonymous",
      "dateUpdated": "2022-06-28T18:39:34+0000",
      "progress": 87,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "6688"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=91",
              "$$hashKey": "object:38584"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655143348326_989993075",
      "id": "paragraph_1655143348326_989993075",
      "dateCreated": "2022-06-13T18:02:28+0000",
      "dateStarted": "2022-06-16T19:29:59+0000",
      "dateFinished": "2022-06-16T19:34:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32231"
    },
    {
      "text": "%pyspark\nhighImpact_sub.count()",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T13:33:06+0000",
      "progress": 80,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "6688"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-137.ec2.internal:4040/jobs/job?id=127",
              "$$hashKey": "object:38642"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655386380792_599277973",
      "id": "paragraph_1655386380792_599277973",
      "dateCreated": "2022-06-16T13:33:00+0000",
      "dateStarted": "2022-06-16T13:33:06+0000",
      "dateFinished": "2022-06-16T13:35:06+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32232"
    },
    {
      "text": "%pyspark\nhighImpact_sub_2 = highImpact_sub.join(vars_csq_merge,'unique_variant_id','inner')\n\nprint(highImpact_sub_2.count())\nhighImpact_sub_2.columns",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T19:16:59+0000",
      "progress": 95,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1811\n['unique_variant_id',\n 'chromosome',\n 'start',\n 'reference',\n 'alternate',\n 'CADD_score',\n 'rsID',\n 'impact',\n 'symbol',\n 'biotype',\n 'hgvsc',\n 'hgvsg',\n 'feature_type',\n 'strand',\n 'consequences']"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=93",
              "$$hashKey": "object:38700"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655382739506_1832779800",
      "id": "paragraph_1655382739506_1832779800",
      "dateCreated": "2022-06-16T12:32:19+0000",
      "dateStarted": "2022-06-16T19:32:03+0000",
      "dateFinished": "2022-06-16T19:37:44+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32233"
    },
    {
      "text": "%pyspark\nhighImpact_sub_2.show(1)",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T14:46:48+0000",
      "progress": 91,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------+----------+--------+---------+---------+----------+----+--------+-------+-------+-----+-------------------+------------+------+--------------------+\n|unique_variant_id|chromosome|   start|reference|alternate|CADD_score|rsID|  impact| symbol|biotype|hgvsc|              hgvsg|feature_type|strand|        consequences|\n+-----------------+----------+--------+---------+---------+----------+----+--------+-------+-------+-----+-------------------+------------+------+--------------------+\n| 10:13222121:G:T:|        10|13222121|        G|        T|        37|null|MODIFIER|RNU6-6P|  snRNA| null|chr10:g.13222121G>T|  Transcript|     1|[downstream_gene_...|\n+-----------------+----------+--------+---------+---------+----------+----+--------+-------+-------+-----+-------------------+------------+------+--------------------+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-137.ec2.internal:4040/jobs/job?id=129",
              "$$hashKey": "object:38758"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655383826934_2083098320",
      "id": "paragraph_1655383826934_2083098320",
      "dateCreated": "2022-06-16T12:50:26+0000",
      "dateStarted": "2022-06-16T14:46:48+0000",
      "dateFinished": "2022-06-16T14:50:24+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32234"
    },
    {
      "text": "%pyspark\n#vars_csq_merge.select('symbol').where(col('symbol').isNull()).count()\n#highImpact_sub.dropDuplicates(['chromosome','start','reference','alternate']).count()",
      "user": "anonymous",
      "dateUpdated": "2022-06-14T14:10:36+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654626248178_1638705437",
      "id": "paragraph_1654626248178_1638705437",
      "dateCreated": "2022-06-07T18:24:08+0000",
      "dateStarted": "2022-06-14T14:10:36+0000",
      "dateFinished": "2022-06-14T14:10:38+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32235"
    },
    {
      "text": "%pyspark\nhighImpact_indels = highImpact_sub_2.where(  (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1)  )\nhighImpact_SNPs = highImpact_sub_2.where(  ~( (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1) ) )\n\nprint(highImpact_indels.count())\nprint(highImpact_SNPs.count())",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T20:16:14+0000",
      "progress": 88,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "375\n1436\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=99",
              "$$hashKey": "object:38858"
            },
            {
              "jobUrl": "http://ip-10-12-3-211.ec2.internal:4040/jobs/job?id=101",
              "$$hashKey": "object:38859"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655144066536_633219181",
      "id": "paragraph_1655144066536_633219181",
      "dateCreated": "2022-06-13T18:14:26+0000",
      "dateStarted": "2022-06-16T20:16:14+0000",
      "dateFinished": "2022-06-16T20:23:35+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32236"
    },
    {
      "title": "Find CADD scores for High Impact SNPs (below 20)",
      "text": "%pyspark\nchroms = ['1', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '2', '20', '22', '3', '4', '5', '6', '7','8', '9', 'X','Y']\n\nfor CHROM in chroms:\n    cadd_chrom = spark.read.parquet(f's3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/cadd_chrom_files/chr{CHROM}')\n\n    cadd_chrom = cadd_chrom.select(col(\"0\").alias(\"chromosome\"), col(\"1\").alias(\"start\"),\n                    col(\"2\").alias(\"reference\"),col(\"3\").alias(\"alternate\"),col('5').alias('CADD_score'))\n    highImpact_SNPs_chrom = highImpact_SNPs.where(col('chromosome') == CHROM)\n    \n    print(f'Joining CADD scores for chromosome {CHROM} ({highImpact_SNPs_chrom.count()} x {cadd_chrom.count()})...',end='')\n    highImpact_results_chrom = highImpact_SNPs_chrom.join(cadd_chrom, [\"chromosome\",\"start\",\"reference\", \"alternate\"], \"inner\")\n    print(f'Done...Result is {highImpact_results_chrom.count()} rows long.')\n    \n    if CHROM == '1': highImpact_SNPs_full =  highImpact_results_chrom\n    else: highImpact_SNPs_full = highImpact_SNPs_full.union(highImpact_results_chrom)\n    #if CHROM == '12': break",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:54:44+0000",
      "progress": 11,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655144883675_739271720",
      "id": "paragraph_1655144883675_739271720",
      "dateCreated": "2022-06-13T18:28:03+0000",
      "dateStarted": "2022-06-16T20:16:23+0000",
      "dateFinished": "2022-06-16T20:38:54+0000",
      "status": "ABORT",
      "$$hashKey": "object:32237"
    },
    {
      "text": "%pyspark\nhighImpact_SNPs_full.count()",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T13:11:25+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "9400"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=234",
              "$$hashKey": "object:38963"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655219142991_1550988381",
      "id": "paragraph_1655219142991_1550988381",
      "dateCreated": "2022-06-14T15:05:42+0000",
      "dateStarted": "2022-06-15T13:11:26+0000",
      "dateFinished": "2022-06-15T13:13:26+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32238"
    },
    {
      "text": "%pyspark\nhighImpact_results_chrom.where(col('CADD_score').isNull()).show()",
      "user": "anonymous",
      "dateUpdated": "2022-06-14T22:52:59+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655219144813_755931468",
      "id": "paragraph_1655219144813_755931468",
      "dateCreated": "2022-06-14T15:05:44+0000",
      "dateStarted": "2022-06-14T22:52:59+0000",
      "dateFinished": "2022-06-14T22:53:06+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32239"
    },
    {
      "title": "Find the CADD score for HIGH impact indels (below 20). Use gnomad CADD file",
      "text": "%pyspark\n\n\n# this file, cadd_gnomad_parquet contains only scores gt 20, NOT all cadd scores which is what we want here.\ncadd_gnomad_chrom = spark.read.parquet('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/cadd_scores/cadd_gnomad_parquet/')\n\nfor CHROM in chroms:\n\n    cadd_chrom =  cadd_gnomad_chrom.where(col('chromosome') == CHROM)\n    highImpact_indels_chrom = highImpact_indels.where(col('chromosome') == CHROM)\n    \n\n    print(f'Joining CADD scores for chromosome {CHROM} ({cadd_chrom.count()} x {highImpact_indels_chrom.count()})...',end='')\n    \n    highImpact_results_chrom = highImpact_indels_chrom.join(cadd_chrom, [\"chromosome\",\"start\",\"reference\", \"alternate\"], \"inner\")\n    \n    print(f'Done...Result is {highImpact_results_chrom.count()} rows long.')\n    \n    if CHROM == '1': highImpact_indels_full =  highImpact_results_chrom\n    else: highImpact_indels_full = highImpact_indels_full.union(highImpact_results_chrom)\n",
      "user": "anonymous",
      "dateUpdated": "2022-06-21T12:10:00+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655238672961_1629676760",
      "id": "paragraph_1655238672961_1629676760",
      "dateCreated": "2022-06-14T20:31:12+0000",
      "dateStarted": "2022-06-15T13:18:59+0000",
      "dateFinished": "2022-06-15T13:20:29+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32240"
    },
    {
      "text": "%pyspark\nhighImpact_indels_full.count() ",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T14:41:40+0000",
      "progress": 2,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "432"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=346",
              "$$hashKey": "object:39105"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655238674835_2127175502",
      "id": "paragraph_1655238674835_2127175502",
      "dateCreated": "2022-06-14T20:31:14+0000",
      "dateStarted": "2022-06-15T13:21:05+0000",
      "dateFinished": "2022-06-15T13:21:33+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32241"
    },
    {
      "text": "%pyspark\nhighImpact_MERGED =  highImpact_SNPs_full.union(highImpact_indels_full)  \nhighImpact_MERGED.count()",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T15:10:55+0000",
      "progress": 99,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "10259"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=625",
              "$$hashKey": "object:39163"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655238676627_1866993945",
      "id": "paragraph_1655238676627_1866993945",
      "dateCreated": "2022-06-14T20:31:16+0000",
      "dateStarted": "2022-06-15T15:10:55+0000",
      "dateFinished": "2022-06-15T15:13:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32242"
    },
    {
      "text": "%pyspark\nhighImpact_MERGED.count()",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T14:47:22+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "9832"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=436",
              "$$hashKey": "object:39221"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655304192486_55188026",
      "id": "paragraph_1655304192486_55188026",
      "dateCreated": "2022-06-15T14:43:12+0000",
      "dateStarted": "2022-06-15T14:44:31+0000",
      "dateFinished": "2022-06-15T14:47:06+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32243"
    },
    {
      "text": "%pyspark\n# no strand column\nhighImpact_MERGED = highImpact_MERGED.drop('CADD_phred','CADD_raw','CADD_raw_rankscore','GTEx_V8_gene','GTEx_V8_tissue','end','hgvsp','ensembl_gene_id')#.show(2)\nhighImpact_MERGED = highImpact_MERGED.withColumn('strand', lit(None).cast(StringType()))",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T15:26:45+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655304979135_1409862857",
      "id": "paragraph_1655304979135_1409862857",
      "dateCreated": "2022-06-15T14:56:19+0000",
      "dateStarted": "2022-06-15T15:11:06+0000",
      "dateFinished": "2022-06-15T15:13:55+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32244"
    },
    {
      "text": "%pyspark\nordered_cols = ['chromosome', 'start', 'reference', 'alternate', 'CADD_score', 'rsID', 'impact',\n                 'symbol', 'biotype', 'hgvsc', 'hgvsg','feature_type', 'strand', 'consequences', 'unique_variant_id']\n                 \ndf_vars = vars_csq_merge.select(ordered_cols).union(highImpact_MERGED.select(ordered_cols))\ndf_vars.count()",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T15:18:04+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "181140"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=671",
              "$$hashKey": "object:39321"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655304273583_1448404308",
      "id": "paragraph_1655304273583_1448404308",
      "dateCreated": "2022-06-15T14:44:33+0000",
      "dateStarted": "2022-06-15T15:18:04+0000",
      "dateFinished": "2022-06-15T15:22:21+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32245"
    },
    {
      "text": "%md\n### Now find CADD scores for eQTLs\n",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T15:20:45+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<h3>Now find CADD scores for eQTLs</h3>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655306289639_1075592621",
      "id": "paragraph_1655306289639_1075592621",
      "dateCreated": "2022-06-15T15:18:09+0000",
      "dateStarted": "2022-06-15T15:20:45+0000",
      "dateFinished": "2022-06-15T15:20:48+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32246"
    },
    {
      "text": "%pyspark\neqtls = spark.read.csv('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/eqtls_gtexV8.csv',header=True)\n\n\neqtls_select = eqtls.select(col(\"chr\").alias(\"chromosome\"), col(\"variant_pos\").alias(\"start\"),\n                             col(\"ref\").alias(\"reference\"),col(\"alt\").alias(\"alternate\"),col('gene_name'),col('rs_id_dbSNP151_GRCh38p7'))\n                             \neqtls_select = eqtls_select.withColumn('chromosome',F.regexp_replace(col(\"chromosome\"), \"[chr,]\", \"\") )\n\neqtls_indels = eqtls_select.where(  (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1)  )\neqtls_SNPs = eqtls_select.where(  ~( (F.length(\"reference\") > 1) | (F.length(\"alternate\") > 1) ) )\n\n#eqtls_select.show(3)",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T15:31:26+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=681",
              "$$hashKey": "object:39415"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655306412686_716965116",
      "id": "paragraph_1655306412686_716965116",
      "dateCreated": "2022-06-15T15:20:12+0000",
      "dateStarted": "2022-06-15T15:31:27+0000",
      "dateFinished": "2022-06-15T15:31:27+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32247"
    },
    {
      "text": "%pyspark\neqtls_indels.show()",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T15:31:17+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655306412404_1449280703",
      "id": "paragraph_1655306412404_1449280703",
      "dateCreated": "2022-06-15T15:20:12+0000",
      "dateStarted": "2022-06-15T15:27:29+0000",
      "dateFinished": "2022-06-15T15:27:30+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32248"
    },
    {
      "title": "Find CADD scores for indel eQTLs ",
      "text": "%pyspark\nfor CHROM in chroms:\n    cadd_chrom = spark.read.parquet(f's3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/cadd_chrom_files/chr{CHROM}')\n\n    cadd_chrom = cadd_chrom.select(col(\"0\").alias(\"chromosome\"), col(\"1\").alias(\"start\"),\n                    col(\"2\").alias(\"reference\"),col(\"3\").alias(\"alternate\"),col('5').alias('CADD_score'))\n         \n    eqtls_SNPs_chrom = eqtls_SNPs.where(col('chromosome') == CHROM)\n    \n    print(f'Joining CADD scores for chromosome {CHROM} ({eqtls_SNPs_chrom.count()} x {cadd_chrom.count()})...',end='')\n    \n    eqtls_results_chrom = eqtls_SNPs_chrom.join(cadd_chrom, [\"chromosome\",\"start\",\"reference\", \"alternate\"], \"inner\")\n    \n    print(f'Done...Result is {eqtls_results_chrom.count()} rows long.')\n    \n    \n    if CHROM == '1': eqtls_SNPs_full =  eqtls_results_chrom\n    else: eqtls_SNPs_full = eqtls_SNPs_full.union(eqtls_results_chrom)\n          \n    #if CHROM == '12': break\n",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T14:46:14+0000",
      "progress": 38,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655307271913_1893403752",
      "id": "paragraph_1655307271913_1893403752",
      "dateCreated": "2022-06-15T15:34:31+0000",
      "dateStarted": "2022-06-15T15:37:34+0000",
      "dateFinished": "2022-06-15T15:45:00+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32249"
    },
    {
      "text": "%pyspark\neqtl_MERGED = eqtls_SNPs_full.union(eqtls_indels_full)\neqtl_MERGED.count()",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T15:46:29+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1102119"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=897",
              "$$hashKey": "object:39557"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655307271747_2085370435",
      "id": "paragraph_1655307271747_2085370435",
      "dateCreated": "2022-06-15T15:34:31+0000",
      "dateStarted": "2022-06-15T15:46:29+0000",
      "dateFinished": "2022-06-15T15:50:37+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32250"
    },
    {
      "text": "%pyspark\neqtl_MERGED.show(1)",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T17:19:37+0000",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+------+---------+---------+-------------+-----------------------+----------+\n|chromosome| start|reference|alternate|    gene_name|rs_id_dbSNP151_GRCh38p7|CADD_score|\n+----------+------+---------+---------+-------------+-----------------------+----------+\n|         1|599167|        G|        A|RP11-34P13.18|            rs188376087|     2.161|\n+----------+------+---------+---------+-------------+-----------------------+----------+\nonly showing top 1 row\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=991",
              "$$hashKey": "object:39615"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655308419895_2107301473",
      "id": "paragraph_1655308419895_2107301473",
      "dateCreated": "2022-06-15T15:53:39+0000",
      "dateStarted": "2022-06-15T17:19:38+0000",
      "dateFinished": "2022-06-15T17:22:33+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32251"
    },
    {
      "text": "%pyspark\neqtl.show(1)",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T17:25:23+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)\n\u001b[0;32m/tmp/ipykernel_4046/2267529639.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0meqtl\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshow\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\n\u001b[0;31mNameError\u001b[0m: name 'eqtl' is not defined"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655313860078_260191421",
      "id": "paragraph_1655313860078_260191421",
      "dateCreated": "2022-06-15T17:24:20+0000",
      "dateStarted": "2022-06-15T17:25:23+0000",
      "dateFinished": "2022-06-15T17:25:24+0000",
      "status": "ERROR",
      "$$hashKey": "object:32252"
    },
    {
      "text": "%pyspark\n\n#df_snps = df_vars.toPandas()\n\ndf_snps_noGene  = df_snps[df_snps.symbol.isnull()]\ndf_snps_Gene  = df_snps[~df_snps.symbol.isnull()]",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T15:37:20+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654626389924_1558739216",
      "id": "paragraph_1654626389924_1558739216",
      "dateCreated": "2022-06-07T18:26:29+0000",
      "dateStarted": "2022-06-13T19:35:43+0000",
      "dateFinished": "2022-06-13T19:35:43+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32253"
    },
    {
      "title": "Save variants we want to input into SNPnexus to find their genes",
      "text": "%pyspark\n'''\nSNPnexus_df = df_snps_noGene[['chromosome','start','reference','alternate','strand']] \n#SNPnexus_df.columns = ['#CHROM','POS','ID','REF','ALT']\n#SNPnexus_df['ID'] = '.'\n#SNPnexus_df.    #fix dels \nSNPnexus_df['strand'] = 1\n\nSNPnexus_df['chromosome_col'] = 'Chromosome'\nSNPnexus_df = SNPnexus_df[['chromosome_col','chromosome','start','reference','alternate','strand']]\nassert SNPnexus_df.isna().sum().sum() == 0\n\nSNPnexus_df.to_csv('/home/notebook/cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/SNPnexus_df.csv',index=False,sep=' ',header=False)'''",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T14:45:10+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\"\\nSNPnexus_df = df_snps_noGene[['chromosome','start','reference','alternate','strand']] \\n#SNPnexus_df.columns = ['#CHROM','POS','ID','REF','ALT']\\n#SNPnexus_df['ID'] = '.'\\n#SNPnexus_df.    #fix dels \\nSNPnexus_df['strand'] = 1\\n\\nSNPnexus_df['chromosome_col'] = 'Chromosome'\\nSNPnexus_df = SNPnexus_df[['chromosome_col','chromosome','start','reference','alternate','strand']]\\nassert SNPnexus_df.isna().sum().sum() == 0\\n\\nSNPnexus_df.to_csv('/home/notebook/cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/SNPnexus_df.csv',index=False,sep=' ',header=False)\""
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654631397434_1606527862",
      "id": "paragraph_1654631397434_1606527862",
      "dateCreated": "2022-06-07T19:49:57+0000",
      "dateStarted": "2022-06-16T14:45:10+0000",
      "dateFinished": "2022-06-16T14:45:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32254"
    },
    {
      "title": "Load in results from SNPnexus",
      "text": "%pyspark\n'''SNPnexus_RESULTS = pd.read_csv('/home/notebook/cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/near_gens_edc7a0e5.txt',sep='\\t')\n\nSNPnexus_RESULTS['chromosome'] =  [i.replace('chr','') for i in SNPnexus_RESULTS['Chromosome']]\nSNPnexus_RESULTS['start'] =  SNPnexus_RESULTS['Position']\nSNPnexus_RESULTS['reference'] =  [i.split(':')[2].split('/')[0] for i in SNPnexus_RESULTS['Variation ID']]\nSNPnexus_RESULTS['alternate'] =  [i.split(':')[2].split('/')[1] for i in SNPnexus_RESULTS['Variation ID']]\n\nSNPnexus_nearest = SNPnexus_RESULTS[SNPnexus_RESULTS['Overlapped Gene'] == 'None']\nSNPnexus_genes = SNPnexus_RESULTS[~(SNPnexus_RESULTS['Overlapped Gene'] == 'None')]\nSNPnexus_genes['symbol'] = SNPnexus_genes['Overlapped Gene']\n\nSNPnexus_genes.head(3)'''",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T14:45:03+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\"SNPnexus_RESULTS = pd.read_csv('/home/notebook/cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/near_gens_edc7a0e5.txt',sep='\\t')\\n\\nSNPnexus_RESULTS['chromosome'] =  [i.replace('chr','') for i in SNPnexus_RESULTS['Chromosome']]\\nSNPnexus_RESULTS['start'] =  SNPnexus_RESULTS['Position']\\nSNPnexus_RESULTS['reference'] =  [i.split(':')[2].split('/')[0] for i in SNPnexus_RESULTS['Variation ID']]\\nSNPnexus_RESULTS['alternate'] =  [i.split(':')[2].split('/')[1] for i in SNPnexus_RESULTS['Variation ID']]\\n\\nSNPnexus_nearest = SNPnexus_RESULTS[SNPnexus_RESULTS['Overlapped Gene'] == 'None']\\nSNPnexus_genes = SNPnexus_RESULTS[~(SNPnexus_RESULTS['Overlapped Gene'] == 'None')]\\nSNPnexus_genes['symbol'] = SNPnexus_genes['Overlapped Gene']\\n\\nSNPnexus_genes.head(3)\""
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654719919526_761172766",
      "id": "paragraph_1654719919526_761172766",
      "dateCreated": "2022-06-08T20:25:19+0000",
      "dateStarted": "2022-06-16T14:45:03+0000",
      "dateFinished": "2022-06-16T14:45:03+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32255"
    },
    {
      "text": "%md\n## How to add these back to the df_snps_noGene dataframe?\n",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T14:35:00+0000",
      "progress": 0,
      "config": {
        "tableHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<h2>How to add these back to the df_snps_noGene dataframe?</h2>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654721266752_977035877",
      "id": "paragraph_1654721266752_977035877",
      "dateCreated": "2022-06-08T20:47:46+0000",
      "dateStarted": "2022-06-08T20:48:44+0000",
      "dateFinished": "2022-06-08T20:48:48+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32256"
    },
    {
      "text": "%pyspark\n# filter for genes that appear more than once (meaning the variant is overlapped by 2 genes)\nSNPnexus_multi = SNPnexus_genes[SNPnexus_genes.groupby('Overlapped Gene')['Overlapped Gene'].transform('size') > 1]\n\n# pick closest gene for variants assigned to multiple genes.\n\n# filter for the other genes that just show up once. these can be added directly to the \nSNPnexus_single = SNPnexus_genes[SNPnexus_genes.groupby('Overlapped Gene')['Overlapped Gene'].transform('size') == 1]",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T19:14:06+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654720455873_763474583",
      "id": "paragraph_1654720455873_763474583",
      "dateCreated": "2022-06-08T20:34:15+0000",
      "dateStarted": "2022-06-13T19:54:23+0000",
      "dateFinished": "2022-06-13T19:54:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32257"
    },
    {
      "text": "%pyspark\nupstream_mask = SNPnexus_nearest['Distance to Nearest Upstream Gene'] > SNPnexus_nearest['Distance to Nearest Downstream Gene']",
      "user": "anonymous",
      "dateUpdated": "2022-06-09T00:19:32+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654732835096_1844838474",
      "id": "paragraph_1654732835096_1844838474",
      "dateCreated": "2022-06-09T00:00:35+0000",
      "dateStarted": "2022-06-09T00:19:32+0000",
      "dateFinished": "2022-06-09T00:19:32+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32258"
    },
    {
      "text": "%pyspark\nSNPnexus_upstream = SNPnexus_nearest[upstream_mask]   \nSNPnexus_downstream = SNPnexus_nearest[~upstream_mask]\n\n# take the names of these in a loop? and then make it a series",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T14:52:26+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654733854721_856064963",
      "id": "paragraph_1654733854721_856064963",
      "dateCreated": "2022-06-09T00:17:34+0000",
      "dateStarted": "2022-06-09T00:20:22+0000",
      "dateFinished": "2022-06-09T00:20:22+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32259"
    },
    {
      "text": "%pyspark\nnp.all(SNPnexus_downstream['Distance to Nearest Upstream Gene'] < SNPnexus_downstream['Distance to Nearest Downstream Gene'])",
      "user": "anonymous",
      "dateUpdated": "2022-06-09T00:25:47+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "True"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654734024944_261735192",
      "id": "paragraph_1654734024944_261735192",
      "dateCreated": "2022-06-09T00:20:24+0000",
      "dateStarted": "2022-06-09T00:25:47+0000",
      "dateFinished": "2022-06-09T00:25:47+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32260"
    },
    {
      "text": "%pyspark\ndf_snps_noGene.drop('symbol',axis=1,inplace=True) # we'll merge in a new symbol column, but we need to do it only for the correct rows",
      "user": "anonymous",
      "dateUpdated": "2022-06-08T20:50:53+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654720993548_504535365",
      "id": "paragraph_1654720993548_504535365",
      "dateCreated": "2022-06-08T20:43:13+0000",
      "dateStarted": "2022-06-08T20:50:53+0000",
      "dateFinished": "2022-06-08T20:50:54+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32261"
    },
    {
      "text": "%pyspark\nlen(np.unique(SNPnexus_multi['Overlapped Gene'].values))",
      "user": "anonymous",
      "dateUpdated": "2022-06-08T23:58:07+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "2051"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654732660304_1933060960",
      "id": "paragraph_1654732660304_1933060960",
      "dateCreated": "2022-06-08T23:57:40+0000",
      "dateStarted": "2022-06-08T23:58:07+0000",
      "dateFinished": "2022-06-08T23:58:07+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32262"
    },
    {
      "text": "%pyspark\nCounter(SNPnexus_multi['Overlapped Gene'].values).most_common()",
      "user": "anonymous",
      "dateUpdated": "2022-06-08T23:56:37+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654732493642_1380140108",
      "id": "paragraph_1654732493642_1380140108",
      "dateCreated": "2022-06-08T23:54:53+0000",
      "dateStarted": "2022-06-08T23:56:37+0000",
      "dateFinished": "2022-06-08T23:56:37+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32263"
    },
    {
      "text": "%pyspark\nprint(vars_csq_merge.select('symbol').where(col('symbol').isNull()).count())\nprint(vars_csq_merge.select('rsID').where(col('rsID').isNull()).count())",
      "user": "anonymous",
      "dateUpdated": "2022-06-07T18:24:55+0000",
      "progress": 92,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "7312"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-68.ec2.internal:4040/jobs/job?id=88",
              "$$hashKey": "object:40233"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654384430135_1613688036",
      "id": "paragraph_1654384430135_1613688036",
      "dateCreated": "2022-06-04T23:13:50+0000",
      "dateStarted": "2022-06-05T14:30:22+0000",
      "dateFinished": "2022-06-05T14:32:00+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32264"
    },
    {
      "text": "%pyspark\nCounter(df_snps['symbol']).most_common(5)   # normalize by size of gene?",
      "user": "anonymous",
      "dateUpdated": "2022-06-05T15:16:22+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "[(None, 7312),\n ('RF00019', 555),\n ('TTN', 537),\n ('TTN-AS1', 308),\n ('PCDHGA1', 250)]"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654385078230_766387431",
      "id": "paragraph_1654385078230_766387431",
      "dateCreated": "2022-06-04T23:24:38+0000",
      "dateStarted": "2022-06-05T15:16:22+0000",
      "dateFinished": "2022-06-05T15:16:22+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32265"
    },
    {
      "text": "%pyspark\ndf_snps = df_vars.toPandas()\ndf_snps['CADD_score'] = df_snps['CADD_score'].astype(np.float64)",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:55:29+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=1083",
              "$$hashKey": "object:40333"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654442463755_1634005693",
      "id": "paragraph_1654442463755_1634005693",
      "dateCreated": "2022-06-05T15:21:03+0000",
      "dateStarted": "2022-06-15T18:53:45+0000",
      "dateFinished": "2022-06-15T18:58:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32266"
    },
    {
      "text": "%pyspark\nsymbol_freqs = dict(Counter(df_snps['symbol']))\nsymbol_freq_df = pd.DataFrame.from_dict(symbol_freqs,orient='index',columns=['frequency']) \nsymbol_freq_df.index.name = 'symbol'\nsymbol_freq_df.head(3)",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:55:35+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>frequency</th>\n    </tr>\n    <tr>\n      <th>symbol</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>MIR1180</th>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>CPAMD8</th>\n      <td>35</td>\n    </tr>\n    <tr>\n      <th>NaN</th>\n      <td>14798</td>\n    </tr>\n  </tbody>\n</table>\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654442508127_1836554761",
      "id": "paragraph_1654442508127_1836554761",
      "dateCreated": "2022-06-05T15:21:48+0000",
      "dateStarted": "2022-06-15T19:15:18+0000",
      "dateFinished": "2022-06-15T19:15:19+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32267"
    },
    {
      "text": "%pyspark\ngene_scores = df_snps[['symbol','CADD_score']].groupby('symbol').sum()",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:55:50+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654624515849_121637280",
      "id": "paragraph_1654624515849_121637280",
      "dateCreated": "2022-06-07T17:55:15+0000",
      "dateStarted": "2022-06-15T19:15:22+0000",
      "dateFinished": "2022-06-15T19:15:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32268"
    },
    {
      "text": "%pyspark\n\n\ndf_genes = gene_scores.join(symbol_freq_df).sort_values('CADD_score',ascending=False)\ndf_genes['symbol'] = df_genes.index\ndf_genes = df_genes.reset_index(drop=True)\n\n# remove micro rna's\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:44:12+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654442541004_1301918841",
      "id": "paragraph_1654442541004_1301918841",
      "dateCreated": "2022-06-05T15:22:21+0000",
      "dateStarted": "2022-06-15T19:15:26+0000",
      "dateFinished": "2022-06-15T19:15:26+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32269"
    },
    {
      "text": "%pyspark\ndf_genes # many rows in df_genes should get mapped multiple times to the main df., unless tthe genes frequency is 1 or 0.\n# do we need to merge this gene data with the variant level stuff?",
      "user": "anonymous",
      "dateUpdated": "2022-06-13T19:38:09+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>CADD_score</th>\n      <th>frequency</th>\n      <th>symbol</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>13588.9</td>\n      <td>566</td>\n      <td>RF00019</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>12695.5</td>\n      <td>537</td>\n      <td>TTN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>7354.6</td>\n      <td>308</td>\n      <td>TTN-AS1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>6547.3</td>\n      <td>261</td>\n      <td>PCDHGA1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>6376.4</td>\n      <td>254</td>\n      <td>PCDHGA2</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>30983</th>\n      <td>20.0</td>\n      <td>1</td>\n      <td>CXorf67</td>\n    </tr>\n    <tr>\n      <th>30984</th>\n      <td>20.0</td>\n      <td>1</td>\n      <td>CUL3</td>\n    </tr>\n    <tr>\n      <th>30985</th>\n      <td>20.0</td>\n      <td>1</td>\n      <td>TEX13C</td>\n    </tr>\n    <tr>\n      <th>30986</th>\n      <td>20.0</td>\n      <td>1</td>\n      <td>AC009558.1</td>\n    </tr>\n    <tr>\n      <th>30987</th>\n      <td>20.0</td>\n      <td>1</td>\n      <td>ATP1B3-AS1</td>\n    </tr>\n  </tbody>\n</table>\n<p>30988 rows × 3 columns</p>\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654626810320_683980259",
      "id": "paragraph_1654626810320_683980259",
      "dateCreated": "2022-06-07T18:33:30+0000",
      "dateStarted": "2022-06-13T19:38:09+0000",
      "dateFinished": "2022-06-13T19:38:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32270"
    },
    {
      "text": "%md\n### Normalize gene scores by dividing by length of gene\n",
      "user": "anonymous",
      "dateUpdated": "2022-06-09T12:42:13+0000",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<h3>Normalize gene scores by dividing by length of gene</h3>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654778508525_1187235384",
      "id": "paragraph_1654778508525_1187235384",
      "dateCreated": "2022-06-09T12:41:48+0000",
      "dateStarted": "2022-06-09T12:42:13+0000",
      "dateFinished": "2022-06-09T12:42:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32271"
    },
    {
      "text": "%sh\naws s3 cp   ~/cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/gene_regions_refseq  s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/gene_regions_refseq",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:48:12+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Completed 256.0 KiB/53.4 MiB (515.6 KiB/s) with 1 file(s) remaining\rCompleted 512.0 KiB/53.4 MiB (1.0 MiB/s) with 1 file(s) remaining  \rCompleted 768.0 KiB/53.4 MiB (1.5 MiB/s) with 1 file(s) remaining  \rCompleted 1.0 MiB/53.4 MiB (2.0 MiB/s) with 1 file(s) remaining    \rCompleted 1.2 MiB/53.4 MiB (2.5 MiB/s) with 1 file(s) remaining    \rCompleted 1.5 MiB/53.4 MiB (3.0 MiB/s) with 1 file(s) remaining    \rCompleted 1.8 MiB/53.4 MiB (3.5 MiB/s) with 1 file(s) remaining    \rCompleted 2.0 MiB/53.4 MiB (4.0 MiB/s) with 1 file(s) remaining    \rCompleted 2.2 MiB/53.4 MiB (4.5 MiB/s) with 1 file(s) remaining    \rCompleted 2.5 MiB/53.4 MiB (5.0 MiB/s) with 1 file(s) remaining    \rCompleted 2.8 MiB/53.4 MiB (5.5 MiB/s) with 1 file(s) remaining    \rCompleted 3.0 MiB/53.4 MiB (5.9 MiB/s) with 1 file(s) remaining    \rCompleted 3.2 MiB/53.4 MiB (6.4 MiB/s) with 1 file(s) remaining    \rCompleted 3.5 MiB/53.4 MiB (6.9 MiB/s) with 1 file(s) remaining    \rCompleted 3.8 MiB/53.4 MiB (7.4 MiB/s) with 1 file(s) remaining    \rCompleted 4.0 MiB/53.4 MiB (7.9 MiB/s) with 1 file(s) remaining    \rCompleted 4.2 MiB/53.4 MiB (8.4 MiB/s) with 1 file(s) remaining    \rCompleted 4.5 MiB/53.4 MiB (8.8 MiB/s) with 1 file(s) remaining    \rCompleted 4.8 MiB/53.4 MiB (9.3 MiB/s) with 1 file(s) remaining    \rCompleted 5.0 MiB/53.4 MiB (9.8 MiB/s) with 1 file(s) remaining    \rCompleted 5.2 MiB/53.4 MiB (10.3 MiB/s) with 1 file(s) remaining   \rCompleted 5.5 MiB/53.4 MiB (10.7 MiB/s) with 1 file(s) remaining   \rCompleted 5.8 MiB/53.4 MiB (11.2 MiB/s) with 1 file(s) remaining   \rCompleted 6.0 MiB/53.4 MiB (11.7 MiB/s) with 1 file(s) remaining   \rCompleted 6.2 MiB/53.4 MiB (12.2 MiB/s) with 1 file(s) remaining   \rCompleted 6.5 MiB/53.4 MiB (12.6 MiB/s) with 1 file(s) remaining   \rCompleted 6.8 MiB/53.4 MiB (13.1 MiB/s) with 1 file(s) remaining   \rCompleted 7.0 MiB/53.4 MiB (13.6 MiB/s) with 1 file(s) remaining   \rCompleted 7.2 MiB/53.4 MiB (14.0 MiB/s) with 1 file(s) remaining   \rCompleted 7.5 MiB/53.4 MiB (14.5 MiB/s) with 1 file(s) remaining   \rCompleted 7.8 MiB/53.4 MiB (15.0 MiB/s) with 1 file(s) remaining   \rCompleted 8.0 MiB/53.4 MiB (15.4 MiB/s) with 1 file(s) remaining   \rCompleted 8.2 MiB/53.4 MiB (13.5 MiB/s) with 1 file(s) remaining   \rCompleted 8.5 MiB/53.4 MiB (13.9 MiB/s) with 1 file(s) remaining   \rCompleted 8.8 MiB/53.4 MiB (14.3 MiB/s) with 1 file(s) remaining   \rCompleted 9.0 MiB/53.4 MiB (14.7 MiB/s) with 1 file(s) remaining   \rCompleted 9.2 MiB/53.4 MiB (15.1 MiB/s) with 1 file(s) remaining   \rCompleted 9.5 MiB/53.4 MiB (15.5 MiB/s) with 1 file(s) remaining   \rCompleted 9.8 MiB/53.4 MiB (15.9 MiB/s) with 1 file(s) remaining   \rCompleted 10.0 MiB/53.4 MiB (16.2 MiB/s) with 1 file(s) remaining  \rCompleted 10.2 MiB/53.4 MiB (16.6 MiB/s) with 1 file(s) remaining  \rCompleted 10.5 MiB/53.4 MiB (17.0 MiB/s) with 1 file(s) remaining  \rCompleted 10.8 MiB/53.4 MiB (17.4 MiB/s) with 1 file(s) remaining  \rCompleted 11.0 MiB/53.4 MiB (17.8 MiB/s) with 1 file(s) remaining  \rCompleted 11.2 MiB/53.4 MiB (18.2 MiB/s) with 1 file(s) remaining  \rCompleted 11.5 MiB/53.4 MiB (18.5 MiB/s) with 1 file(s) remaining  \rCompleted 11.8 MiB/53.4 MiB (18.9 MiB/s) with 1 file(s) remaining  \rCompleted 12.0 MiB/53.4 MiB (19.3 MiB/s) with 1 file(s) remaining  \rCompleted 12.2 MiB/53.4 MiB (19.7 MiB/s) with 1 file(s) remaining  \rCompleted 12.5 MiB/53.4 MiB (20.1 MiB/s) with 1 file(s) remaining  \rCompleted 12.8 MiB/53.4 MiB (20.4 MiB/s) with 1 file(s) remaining  \rCompleted 13.0 MiB/53.4 MiB (20.8 MiB/s) with 1 file(s) remaining  \rCompleted 13.2 MiB/53.4 MiB (21.2 MiB/s) with 1 file(s) remaining  \rCompleted 13.5 MiB/53.4 MiB (21.6 MiB/s) with 1 file(s) remaining  \rCompleted 13.8 MiB/53.4 MiB (21.9 MiB/s) with 1 file(s) remaining  \rCompleted 14.0 MiB/53.4 MiB (22.2 MiB/s) with 1 file(s) remaining  \rCompleted 14.2 MiB/53.4 MiB (22.6 MiB/s) with 1 file(s) remaining  \rCompleted 14.5 MiB/53.4 MiB (23.0 MiB/s) with 1 file(s) remaining  \rCompleted 14.8 MiB/53.4 MiB (23.3 MiB/s) with 1 file(s) remaining  \rCompleted 15.0 MiB/53.4 MiB (23.7 MiB/s) with 1 file(s) remaining  \rCompleted 15.2 MiB/53.4 MiB (24.0 MiB/s) with 1 file(s) remaining  \rCompleted 15.5 MiB/53.4 MiB (24.4 MiB/s) with 1 file(s) remaining  \rCompleted 15.8 MiB/53.4 MiB (24.7 MiB/s) with 1 file(s) remaining  \rCompleted 16.0 MiB/53.4 MiB (24.8 MiB/s) with 1 file(s) remaining  \rCompleted 16.2 MiB/53.4 MiB (25.2 MiB/s) with 1 file(s) remaining  \rCompleted 16.5 MiB/53.4 MiB (25.6 MiB/s) with 1 file(s) remaining  \rCompleted 16.8 MiB/53.4 MiB (25.9 MiB/s) with 1 file(s) remaining  \rCompleted 17.0 MiB/53.4 MiB (26.3 MiB/s) with 1 file(s) remaining  \rCompleted 17.2 MiB/53.4 MiB (26.7 MiB/s) with 1 file(s) remaining  \rCompleted 17.5 MiB/53.4 MiB (27.0 MiB/s) with 1 file(s) remaining  \rCompleted 17.8 MiB/53.4 MiB (27.4 MiB/s) with 1 file(s) remaining  \rCompleted 18.0 MiB/53.4 MiB (27.7 MiB/s) with 1 file(s) remaining  \rCompleted 18.2 MiB/53.4 MiB (28.1 MiB/s) with 1 file(s) remaining  \rCompleted 18.5 MiB/53.4 MiB (28.5 MiB/s) with 1 file(s) remaining  \rCompleted 18.8 MiB/53.4 MiB (28.8 MiB/s) with 1 file(s) remaining  \rCompleted 19.0 MiB/53.4 MiB (29.2 MiB/s) with 1 file(s) remaining  \rCompleted 19.2 MiB/53.4 MiB (29.5 MiB/s) with 1 file(s) remaining  \rCompleted 19.5 MiB/53.4 MiB (29.9 MiB/s) with 1 file(s) remaining  \rCompleted 19.8 MiB/53.4 MiB (30.2 MiB/s) with 1 file(s) remaining  \rCompleted 20.0 MiB/53.4 MiB (30.6 MiB/s) with 1 file(s) remaining  \rCompleted 20.2 MiB/53.4 MiB (30.9 MiB/s) with 1 file(s) remaining  \rCompleted 20.5 MiB/53.4 MiB (31.3 MiB/s) with 1 file(s) remaining  \rCompleted 20.8 MiB/53.4 MiB (31.6 MiB/s) with 1 file(s) remaining  \rCompleted 21.0 MiB/53.4 MiB (32.0 MiB/s) with 1 file(s) remaining  \rCompleted 21.2 MiB/53.4 MiB (32.3 MiB/s) with 1 file(s) remaining  \rCompleted 21.5 MiB/53.4 MiB (32.7 MiB/s) with 1 file(s) remaining  \rCompleted 21.8 MiB/53.4 MiB (33.0 MiB/s) with 1 file(s) remaining  \rCompleted 22.0 MiB/53.4 MiB (33.4 MiB/s) with 1 file(s) remaining  \rCompleted 22.2 MiB/53.4 MiB (33.7 MiB/s) with 1 file(s) remaining  \rCompleted 22.5 MiB/53.4 MiB (34.1 MiB/s) with 1 file(s) remaining  \rCompleted 22.8 MiB/53.4 MiB (34.4 MiB/s) with 1 file(s) remaining  \rCompleted 23.0 MiB/53.4 MiB (34.8 MiB/s) with 1 file(s) remaining  \rCompleted 23.2 MiB/53.4 MiB (35.1 MiB/s) with 1 file(s) remaining  \rCompleted 23.5 MiB/53.4 MiB (35.4 MiB/s) with 1 file(s) remaining  \rCompleted 23.8 MiB/53.4 MiB (35.8 MiB/s) with 1 file(s) remaining  \rCompleted 24.0 MiB/53.4 MiB (36.1 MiB/s) with 1 file(s) remaining  \rCompleted 24.2 MiB/53.4 MiB (32.4 MiB/s) with 1 file(s) remaining  \rCompleted 24.5 MiB/53.4 MiB (32.7 MiB/s) with 1 file(s) remaining  \rCompleted 24.8 MiB/53.4 MiB (33.0 MiB/s) with 1 file(s) remaining  \rCompleted 25.0 MiB/53.4 MiB (33.3 MiB/s) with 1 file(s) remaining  \rCompleted 25.2 MiB/53.4 MiB (33.6 MiB/s) with 1 file(s) remaining  \rCompleted 25.5 MiB/53.4 MiB (33.9 MiB/s) with 1 file(s) remaining  \rCompleted 25.8 MiB/53.4 MiB (34.2 MiB/s) with 1 file(s) remaining  \rCompleted 26.0 MiB/53.4 MiB (34.4 MiB/s) with 1 file(s) remaining  \rCompleted 26.2 MiB/53.4 MiB (34.8 MiB/s) with 1 file(s) remaining  \rCompleted 26.5 MiB/53.4 MiB (35.0 MiB/s) with 1 file(s) remaining  \rCompleted 26.8 MiB/53.4 MiB (35.3 MiB/s) with 1 file(s) remaining  \rCompleted 27.0 MiB/53.4 MiB (35.6 MiB/s) with 1 file(s) remaining  \rCompleted 27.2 MiB/53.4 MiB (35.9 MiB/s) with 1 file(s) remaining  \rCompleted 27.5 MiB/53.4 MiB (36.1 MiB/s) with 1 file(s) remaining  \rCompleted 27.8 MiB/53.4 MiB (36.4 MiB/s) with 1 file(s) remaining  \rCompleted 28.0 MiB/53.4 MiB (36.7 MiB/s) with 1 file(s) remaining  \rCompleted 28.2 MiB/53.4 MiB (37.0 MiB/s) with 1 file(s) remaining  \rCompleted 28.5 MiB/53.4 MiB (37.3 MiB/s) with 1 file(s) remaining  \rCompleted 28.8 MiB/53.4 MiB (37.6 MiB/s) with 1 file(s) remaining  \rCompleted 29.0 MiB/53.4 MiB (37.9 MiB/s) with 1 file(s) remaining  \rCompleted 29.2 MiB/53.4 MiB (38.1 MiB/s) with 1 file(s) remaining  \rCompleted 29.5 MiB/53.4 MiB (38.4 MiB/s) with 1 file(s) remaining  \rCompleted 29.8 MiB/53.4 MiB (38.7 MiB/s) with 1 file(s) remaining  \rCompleted 30.0 MiB/53.4 MiB (39.0 MiB/s) with 1 file(s) remaining  \rCompleted 30.2 MiB/53.4 MiB (39.2 MiB/s) with 1 file(s) remaining  \rCompleted 30.5 MiB/53.4 MiB (39.6 MiB/s) with 1 file(s) remaining  \rCompleted 30.8 MiB/53.4 MiB (39.8 MiB/s) with 1 file(s) remaining  \rCompleted 31.0 MiB/53.4 MiB (40.1 MiB/s) with 1 file(s) remaining  \rCompleted 31.2 MiB/53.4 MiB (40.4 MiB/s) with 1 file(s) remaining  \rCompleted 31.5 MiB/53.4 MiB (40.7 MiB/s) with 1 file(s) remaining  \rCompleted 31.8 MiB/53.4 MiB (40.9 MiB/s) with 1 file(s) remaining  \rCompleted 32.0 MiB/53.4 MiB (41.2 MiB/s) with 1 file(s) remaining  \rCompleted 32.2 MiB/53.4 MiB (41.5 MiB/s) with 1 file(s) remaining  \rCompleted 32.5 MiB/53.4 MiB (41.8 MiB/s) with 1 file(s) remaining  \rCompleted 32.8 MiB/53.4 MiB (42.0 MiB/s) with 1 file(s) remaining  \rCompleted 33.0 MiB/53.4 MiB (42.3 MiB/s) with 1 file(s) remaining  \rCompleted 33.2 MiB/53.4 MiB (42.6 MiB/s) with 1 file(s) remaining  \rCompleted 33.5 MiB/53.4 MiB (42.9 MiB/s) with 1 file(s) remaining  \rCompleted 33.8 MiB/53.4 MiB (43.1 MiB/s) with 1 file(s) remaining  \rCompleted 34.0 MiB/53.4 MiB (43.4 MiB/s) with 1 file(s) remaining  \rCompleted 34.2 MiB/53.4 MiB (43.7 MiB/s) with 1 file(s) remaining  \rCompleted 34.5 MiB/53.4 MiB (44.0 MiB/s) with 1 file(s) remaining  \rCompleted 34.8 MiB/53.4 MiB (44.2 MiB/s) with 1 file(s) remaining  \rCompleted 35.0 MiB/53.4 MiB (44.5 MiB/s) with 1 file(s) remaining  \rCompleted 35.2 MiB/53.4 MiB (44.8 MiB/s) with 1 file(s) remaining  \rCompleted 35.5 MiB/53.4 MiB (45.0 MiB/s) with 1 file(s) remaining  \rCompleted 35.8 MiB/53.4 MiB (45.3 MiB/s) with 1 file(s) remaining  \rCompleted 36.0 MiB/53.4 MiB (45.6 MiB/s) with 1 file(s) remaining  \rCompleted 36.2 MiB/53.4 MiB (45.8 MiB/s) with 1 file(s) remaining  \rCompleted 36.5 MiB/53.4 MiB (46.1 MiB/s) with 1 file(s) remaining  \rCompleted 36.8 MiB/53.4 MiB (46.3 MiB/s) with 1 file(s) remaining  \rCompleted 37.0 MiB/53.4 MiB (46.6 MiB/s) with 1 file(s) remaining  \rCompleted 37.2 MiB/53.4 MiB (46.8 MiB/s) with 1 file(s) remaining  \rCompleted 37.5 MiB/53.4 MiB (47.1 MiB/s) with 1 file(s) remaining  \rCompleted 37.8 MiB/53.4 MiB (47.3 MiB/s) with 1 file(s) remaining  \rCompleted 38.0 MiB/53.4 MiB (47.6 MiB/s) with 1 file(s) remaining  \rCompleted 38.2 MiB/53.4 MiB (47.8 MiB/s) with 1 file(s) remaining  \rCompleted 38.5 MiB/53.4 MiB (48.1 MiB/s) with 1 file(s) remaining  \rCompleted 38.8 MiB/53.4 MiB (48.4 MiB/s) with 1 file(s) remaining  \rCompleted 39.0 MiB/53.4 MiB (48.6 MiB/s) with 1 file(s) remaining  \rCompleted 39.2 MiB/53.4 MiB (48.9 MiB/s) with 1 file(s) remaining  \rCompleted 39.5 MiB/53.4 MiB (49.1 MiB/s) with 1 file(s) remaining  \rCompleted 39.8 MiB/53.4 MiB (49.4 MiB/s) with 1 file(s) remaining  \rCompleted 40.0 MiB/53.4 MiB (49.7 MiB/s) with 1 file(s) remaining  \rCompleted 40.2 MiB/53.4 MiB (49.3 MiB/s) with 1 file(s) remaining  \rCompleted 40.5 MiB/53.4 MiB (49.5 MiB/s) with 1 file(s) remaining  \rCompleted 40.8 MiB/53.4 MiB (49.8 MiB/s) with 1 file(s) remaining  \rCompleted 41.0 MiB/53.4 MiB (50.0 MiB/s) with 1 file(s) remaining  \rCompleted 41.2 MiB/53.4 MiB (50.3 MiB/s) with 1 file(s) remaining  \rCompleted 41.5 MiB/53.4 MiB (50.5 MiB/s) with 1 file(s) remaining  \rCompleted 41.8 MiB/53.4 MiB (50.8 MiB/s) with 1 file(s) remaining  \rCompleted 42.0 MiB/53.4 MiB (51.0 MiB/s) with 1 file(s) remaining  \rCompleted 42.2 MiB/53.4 MiB (51.3 MiB/s) with 1 file(s) remaining  \rCompleted 42.5 MiB/53.4 MiB (51.5 MiB/s) with 1 file(s) remaining  \rCompleted 42.8 MiB/53.4 MiB (51.8 MiB/s) with 1 file(s) remaining  \rCompleted 43.0 MiB/53.4 MiB (52.0 MiB/s) with 1 file(s) remaining  \rCompleted 43.2 MiB/53.4 MiB (52.2 MiB/s) with 1 file(s) remaining  \rCompleted 43.5 MiB/53.4 MiB (52.5 MiB/s) with 1 file(s) remaining  \rCompleted 43.8 MiB/53.4 MiB (52.7 MiB/s) with 1 file(s) remaining  \rCompleted 44.0 MiB/53.4 MiB (53.0 MiB/s) with 1 file(s) remaining  \rCompleted 44.2 MiB/53.4 MiB (53.2 MiB/s) with 1 file(s) remaining  \rCompleted 44.5 MiB/53.4 MiB (53.4 MiB/s) with 1 file(s) remaining  \rCompleted 44.8 MiB/53.4 MiB (53.7 MiB/s) with 1 file(s) remaining  \rCompleted 45.0 MiB/53.4 MiB (53.9 MiB/s) with 1 file(s) remaining  \rCompleted 45.2 MiB/53.4 MiB (54.1 MiB/s) with 1 file(s) remaining  \rCompleted 45.5 MiB/53.4 MiB (54.4 MiB/s) with 1 file(s) remaining  \rCompleted 45.8 MiB/53.4 MiB (54.6 MiB/s) with 1 file(s) remaining  \rCompleted 46.0 MiB/53.4 MiB (54.8 MiB/s) with 1 file(s) remaining  \rCompleted 46.2 MiB/53.4 MiB (55.1 MiB/s) with 1 file(s) remaining  \rCompleted 46.5 MiB/53.4 MiB (55.3 MiB/s) with 1 file(s) remaining  \rCompleted 46.8 MiB/53.4 MiB (55.5 MiB/s) with 1 file(s) remaining  \rCompleted 47.0 MiB/53.4 MiB (55.7 MiB/s) with 1 file(s) remaining  \rCompleted 47.2 MiB/53.4 MiB (56.0 MiB/s) with 1 file(s) remaining  \rCompleted 47.5 MiB/53.4 MiB (56.2 MiB/s) with 1 file(s) remaining  \rCompleted 47.8 MiB/53.4 MiB (56.5 MiB/s) with 1 file(s) remaining  \rCompleted 48.0 MiB/53.4 MiB (56.7 MiB/s) with 1 file(s) remaining  \rCompleted 48.2 MiB/53.4 MiB (56.9 MiB/s) with 1 file(s) remaining  \rCompleted 48.5 MiB/53.4 MiB (57.1 MiB/s) with 1 file(s) remaining  \rCompleted 48.8 MiB/53.4 MiB (57.4 MiB/s) with 1 file(s) remaining  \rCompleted 49.0 MiB/53.4 MiB (57.6 MiB/s) with 1 file(s) remaining  \rCompleted 49.2 MiB/53.4 MiB (57.8 MiB/s) with 1 file(s) remaining  \rCompleted 49.5 MiB/53.4 MiB (58.0 MiB/s) with 1 file(s) remaining  \rCompleted 49.8 MiB/53.4 MiB (58.3 MiB/s) with 1 file(s) remaining  \rCompleted 50.0 MiB/53.4 MiB (58.5 MiB/s) with 1 file(s) remaining  \rCompleted 50.2 MiB/53.4 MiB (58.8 MiB/s) with 1 file(s) remaining  \rCompleted 50.5 MiB/53.4 MiB (59.0 MiB/s) with 1 file(s) remaining  \rCompleted 50.8 MiB/53.4 MiB (59.2 MiB/s) with 1 file(s) remaining  \rCompleted 51.0 MiB/53.4 MiB (59.5 MiB/s) with 1 file(s) remaining  \rCompleted 51.2 MiB/53.4 MiB (59.7 MiB/s) with 1 file(s) remaining  \rCompleted 51.5 MiB/53.4 MiB (60.0 MiB/s) with 1 file(s) remaining  \rCompleted 51.8 MiB/53.4 MiB (60.2 MiB/s) with 1 file(s) remaining  \rCompleted 52.0 MiB/53.4 MiB (60.4 MiB/s) with 1 file(s) remaining  \rCompleted 52.2 MiB/53.4 MiB (60.7 MiB/s) with 1 file(s) remaining  \rCompleted 52.5 MiB/53.4 MiB (60.9 MiB/s) with 1 file(s) remaining  \rCompleted 52.8 MiB/53.4 MiB (61.1 MiB/s) with 1 file(s) remaining  \rCompleted 53.0 MiB/53.4 MiB (61.3 MiB/s) with 1 file(s) remaining  \rCompleted 53.2 MiB/53.4 MiB (61.6 MiB/s) with 1 file(s) remaining  \rCompleted 53.4 MiB/53.4 MiB (56.3 MiB/s) with 1 file(s) remaining  \rupload: cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/gene_regions_refseq to s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/gene_regions_refseq\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654624522656_1812254452",
      "id": "paragraph_1654624522656_1812254452",
      "dateCreated": "2022-06-07T17:55:22+0000",
      "dateStarted": "2022-07-26T18:48:13+0000",
      "dateFinished": "2022-07-26T18:48:15+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32272"
    },
    {
      "text": "%pyspark\ngenome_bed = spark.read.csv('s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/gene_regions_refseq',header=True,sep='\\t')\n\ngenome_bed = genome_bed.withColumn('symbol',col('name2')).drop('name2')\ngenome_bed.show()",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:48:24+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654624601696_478430481",
      "id": "paragraph_1654624601696_478430481",
      "dateCreated": "2022-06-07T17:56:41+0000",
      "dateStarted": "2022-07-26T18:48:24+0000",
      "dateFinished": "2022-07-26T18:48:25+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32273"
    },
    {
      "text": "%pyspark\n\ngenome_bed_select = genome_bed.select(['chrom','txStart','txEnd','cdsStart','cdsEnd','symbol'])\nprint(genome_bed_select.count())\n\ngenome_bed_noDups = genome_bed_select.dropDuplicates(['symbol'])\nprint(genome_bed_noDups.count())\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:50:20+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "172809\n38537\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=1086",
              "$$hashKey": "object:40711"
            },
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=1087",
              "$$hashKey": "object:40712"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655124510637_1606050926",
      "id": "paragraph_1655124510637_1606050926",
      "dateCreated": "2022-06-13T12:48:30+0000",
      "dateStarted": "2022-06-15T19:16:17+0000",
      "dateFinished": "2022-06-15T19:16:18+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32274"
    },
    {
      "text": "%pyspark\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:50:51+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1658861421060_957380736",
      "id": "paragraph_1658861421060_957380736",
      "dateCreated": "2022-07-26T18:50:21+0000",
      "status": "READY",
      "$$hashKey": "object:32275"
    },
    {
      "text": "%pyspark\n\ngenome_bed_noDups = genome_bed_noDups.withColumn('txDiff',col('txEnd') - col('txStart'))\n\ngenome_bed_noDups.show(3)",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:49:08+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+--------+--------+--------+--------+------+-------+\n|chrom| txStart|   txEnd|cdsStart|  cdsEnd|symbol| txDiff|\n+-----+--------+--------+--------+--------+------+-------+\n|chr16|70252294|70289509|70289509|70289509| AARS1|37215.0|\n|chr16|16149564|16221292|16150132|16219824| ABCC6|71728.0|\n| chr5|81309044|81358614|81310974|81347811|ACOT12|49570.0|\n+-----+--------+--------+--------+--------+------+-------+\nonly showing top 3 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=1088",
              "$$hashKey": "object:40816"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655147618863_1224174441",
      "id": "paragraph_1655147618863_1224174441",
      "dateCreated": "2022-06-13T19:13:38+0000",
      "dateStarted": "2022-06-15T19:16:21+0000",
      "dateFinished": "2022-06-15T19:16:21+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32276"
    },
    {
      "text": "%pyspark\n\nbed_genes = genome_bed_noDups.select('symbol').collect()\n\nmy_genes = set(list(np.unique(df_genes['symbol']))) # 30988\nbed_genes = set(list(np.unique([i[0] for i in bed_genes])))\n\nlen(bed_genes.intersection(my_genes))\n",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:51:10+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "20279"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=1089",
              "$$hashKey": "object:40874"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655146230884_569814820",
      "id": "paragraph_1655146230884_569814820",
      "dateCreated": "2022-06-13T18:50:30+0000",
      "dateStarted": "2022-06-15T19:16:27+0000",
      "dateFinished": "2022-06-15T19:16:27+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32277"
    },
    {
      "text": "%pyspark\ndf_snps_Gene_spark = spark.createDataFrame(df_genes)   # How did CADD_score get so many decimals?\ndf_snps_Gene_spark.show(10)",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T19:20:38+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------------------+---------+-------+\n|        CADD_score|frequency| symbol|\n+------------------+---------+-------+\n| 7910.399999999998|      332|    TTN|\n| 6006.800000000004|      255|RF00019|\n|4177.0999999999985|      194|  ZFHX3|\n| 4111.100000000001|      197|  NPAS3|\n|4086.3999999999974|      194| RBFOX1|\n|3834.3000000000006|      153|    NEB|\n|3282.6999999999975|      136|   PLEC|\n|3174.9190000000003|      129|  OBSCN|\n|3156.6000000000013|      151|  LRMDA|\n| 3006.499999999998|      143|  FOXP1|\n+------------------+---------+-------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=1095",
              "$$hashKey": "object:40932"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655147410361_241416375",
      "id": "paragraph_1655147410361_241416375",
      "dateCreated": "2022-06-13T19:10:10+0000",
      "dateStarted": "2022-06-15T19:20:39+0000",
      "dateFinished": "2022-06-15T19:20:39+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32278"
    },
    {
      "text": "%pyspark\n\nnormed = genome_bed_noDups.select(['symbol','txDiff']).join(df_snps_Gene_spark,['symbol'])\n\nnormed = normed.withColumn('normed_CADD_score', F.round(1000*(col('CADD_score')/col('txDiff')),3 )).drop('hgvsc','hgvsg','strand')\n\nnormed.sort('normed_CADD_score',ascending=False).show(50)",
      "user": "anonymous",
      "dateUpdated": "2022-07-26T18:56:26+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------+------+------------------+---------+-----------------+\n|   symbol|txDiff|        CADD_score|frequency|normed_CADD_score|\n+---------+------+------------------+---------+-----------------+\n|  MIR6832|  72.0|415.00000000000006|       17|         5763.889|\n|MIR6511B1|  85.0|             482.1|       20|         5671.765|\n|  MIR6891|  93.0|             436.6|       18|         4694.624|\n|  MIR6501|  67.0|             306.4|       13|         4573.134|\n|  MIR4273|  84.0|             359.9|       16|         4284.524|\n|     MDN1| 302.0|1263.0999999999997|       51|          4182.45|\n|  MIR4758|  71.0|             266.7|       11|         3756.338|\n|  MIR1229|  69.0|248.80000000000004|        9|         3605.797|\n|  MIR7152|  54.0|             188.5|        8|         3490.741|\n|  MIR6822|  61.0|             205.1|        8|         3362.295|\n|  MIR4752|  72.0|             237.9|       10|         3304.167|\n|  MIR6846|  60.0|             192.7|        8|         3211.667|\n|   MIR324|  83.0|             262.0|       10|         3156.627|\n|  MIR4260|  67.0|             205.1|        8|         3061.194|\n|  MIR6871|  56.0|             171.4|        6|         3060.714|\n|  MIR7705|  57.0|             172.8|        7|         3031.579|\n|  MIR6757|  69.0|             198.2|        8|         2872.464|\n|  MIR6766|  72.0|198.89999999999998|        8|           2762.5|\n|  MIR6880|  62.0|165.20000000000002|        7|         2664.516|\n|  MIR6726|  61.0|             162.2|        6|         2659.016|\n|  MIR7112|  65.0|             166.3|        7|         2558.462|\n|   MIR662|  95.0|             242.9|       10|         2556.842|\n|  MIR7160|  52.0|             130.5|        5|         2509.615|\n|  MIR6795|  68.0|             170.4|        7|         2505.882|\n|  MIR6819|  61.0|             145.4|        6|         2383.607|\n|  MIR642B|  77.0|183.39999999999998|        7|         2381.818|\n|  MIR4656|  75.0|             176.6|        7|         2354.667|\n|   MIR631|  75.0|176.39999999999998|        7|           2352.0|\n|  MIR6735|  73.0|             170.4|        6|         2334.247|\n|  MIR6882|  66.0|153.79999999999998|        6|         2330.303|\n|  MIR6727|  65.0|             151.4|        6|         2329.231|\n|  MIR8077|  75.0|             171.6|        7|           2288.0|\n|  MIR6851|  67.0|150.20000000000002|        6|         2241.791|\n|    CDH12| 272.0| 600.8000000000001|       28|         2208.824|\n|  MIR3974|  96.0|212.00000000000003|       10|         2208.333|\n|  MIR6510|  54.0|118.69999999999999|        5|         2198.148|\n|  MIR208A|  71.0|             155.0|        6|         2183.099|\n|  MIR6855|  67.0|             146.2|        6|          2182.09|\n|  MIR4475|  61.0|127.80000000000001|        6|         2095.082|\n|  MIR6729|  65.0|             136.1|        5|         2093.846|\n|   MIR939|  82.0|             162.1|        7|         1976.829|\n|  MIR4701|  63.0|124.30000000000001|        5|         1973.016|\n|  MIR4297|  76.0|             149.6|        7|         1968.421|\n|  MIR499B|  73.0|             143.2|        5|         1961.644|\n|  MIR3132|  75.0|             146.8|        5|         1957.333|\n|  MIR1228|  73.0|             140.9|        6|         1930.137|\n|  MIR6763|  65.0|122.30000000000001|        5|         1881.538|\n|  MIR3145|  82.0|147.20000000000002|        6|         1795.122|\n|  MIR4673|  59.0|104.30000000000001|        4|         1767.797|\n|   CABIN1| 401.0| 704.8000000000002|       28|         1757.606|\n+---------+------+------------------+---------+-----------------+\nonly showing top 50 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-63.ec2.internal:4040/jobs/job?id=1094",
              "$$hashKey": "object:40990"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655146294960_351747447",
      "id": "paragraph_1655146294960_351747447",
      "dateCreated": "2022-06-13T18:51:34+0000",
      "dateStarted": "2022-06-15T19:17:09+0000",
      "dateFinished": "2022-06-15T19:17:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32279"
    },
    {
      "text": "%md\n### may need to use mean/median CADD score\n",
      "user": "anonymous",
      "dateUpdated": "2022-06-15T19:18:36+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655320692029_104277166",
      "id": "paragraph_1655320692029_104277166",
      "dateCreated": "2022-06-15T19:18:12+0000",
      "status": "READY",
      "$$hashKey": "object:32280"
    },
    {
      "text": "%pyspark\n # as expected, we lose about a third of the rows. we only have about 2/3 coverage on\n#'symbol' with this BED file\nprint(df_snps_Gene_spark.count())\nprint(normed.count())",
      "user": "anonymous",
      "dateUpdated": "2022-06-13T19:32:28+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "232508\n186808\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-244.ec2.internal:4040/jobs/job?id=189",
              "$$hashKey": "object:41090"
            },
            {
              "jobUrl": "http://ip-10-12-3-244.ec2.internal:4040/jobs/job?id=191",
              "$$hashKey": "object:41091"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655148586312_867986067",
      "id": "paragraph_1655148586312_867986067",
      "dateCreated": "2022-06-13T19:29:46+0000",
      "dateStarted": "2022-06-13T19:31:21+0000",
      "dateFinished": "2022-06-13T19:31:22+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32281"
    },
    {
      "text": "%pyspark\nplt.figure(figsize=(10,10))\nplt.plot(df_genes.frequency,df_genes.CADD_score,'.-',color='r',linewidth='1')\nplt.ylim([0,6000])\nplt.xlim([0,300])\nz.show(plt, width='700px')\nplt.close()",
      "user": "anonymous",
      "dateUpdated": "2022-06-05T15:33:37+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654442984563_1414553230",
      "id": "paragraph_1654442984563_1414553230",
      "dateCreated": "2022-06-05T15:29:44+0000",
      "dateStarted": "2022-06-05T15:33:38+0000",
      "dateFinished": "2022-06-05T15:33:38+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32282"
    },
    {
      "text": "%sh\nwget https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_40/gencode.v40.annotation.gtf.gz\n",
      "user": "anonymous",
      "dateUpdated": "2022-06-17T17:02:56+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655163567281_1621161183",
      "id": "paragraph_1655163567281_1621161183",
      "dateCreated": "2022-06-13T23:39:27+0000",
      "dateStarted": "2022-06-17T17:02:56+0000",
      "dateFinished": "2022-06-17T17:03:32+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32283"
    },
    {
      "text": "%pyspark\ngencode = pd.read_csv('gencode.v40.annotation.gtf.gz',skiprows=5,sep='\\t',header=None)\n\ngencode.columns = ['chromosome','source','type','start','end','5','strand','7','INFO']\n\ngencode_genes = gencode[gencode['type'] == 'gene']\nprint(gencode_genes.shape)\n\n#Counter([len(k) for k in [i[4].split(' ') for i in gencode_genes['INFO'].str.split(';')]])\n#gencode_genes['hgnc_id'] =\ngencode_genes['gene_type'] = [i[1].split(' ')[2][1:-1] for i in gencode_genes['INFO'].str.split(';')]\ngencode_genes['symbol'] = [i[2].split(' ')[2][1:-1] for i in gencode_genes['INFO'].str.split(';')]\ngencode_genes['gene_id'] = [i[0].split(' ')[1][1:-1] for i in gencode_genes['INFO'].str.split(';')]\n\n\n#Counter(gencode_genes['gene_type']).most_common()\ngencode_genes_protein_coding = gencode_genes[gencode_genes['gene_type'] == 'protein_coding']\n\ngencode_genes_protein_coding = gencode_genes_protein_coding[gencode_genes_protein_coding['chromosome'] != 'chrM']\n\nbed = gencode_genes_protein_coding[['chromosome','start','end','strand','symbol','gene_id']].reset_index(drop=True)\n\nbed_pos = bed[bed['strand'] == '+']\nbed_neg = bed[bed['strand'] == '-']\n\nbed_pos['start_upstream15kb'] = bed_pos['start'] - 15000\nbed_pos['start_downstream15kb'] = bed_pos['end'] + 5000\n\nbed_neg['start_upstream15kb'] = bed_neg['start'] - 5000\nbed_neg['start_downstream15kb'] = bed_neg['end'] + 15000\n\nbed_buffer = pd.concat([bed_pos,bed_neg]).sort_values(['chromosome','start'])",
      "user": "anonymous",
      "dateUpdated": "2022-06-17T17:03:37+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "(61544, 9)\n/tmp/ipykernel_6064/221167709.py:10: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  gencode_genes['gene_type'] = [i[1].split(' ')[2][1:-1] for i in gencode_genes['INFO'].str.split(';')]\n/tmp/ipykernel_6064/221167709.py:11: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  gencode_genes['symbol'] = [i[2].split(' ')[2][1:-1] for i in gencode_genes['INFO'].str.split(';')]\n/tmp/ipykernel_6064/221167709.py:12: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  gencode_genes['gene_id'] = [i[0].split(' ')[1][1:-1] for i in gencode_genes['INFO'].str.split(';')]\n/tmp/ipykernel_6064/221167709.py:25: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  bed_pos['start_upstream15kb'] = bed_pos['start'] - 15000\n/tmp/ipykernel_6064/221167709.py:26: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  bed_pos['start_downstream15kb'] = bed_pos['end'] + 5000\n/tmp/ipykernel_6064/221167709.py:28: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  bed_neg['start_upstream15kb'] = bed_neg['start'] - 5000\n/tmp/ipykernel_6064/221167709.py:29: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  bed_neg['start_downstream15kb'] = bed_neg['end'] + 15000\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655468540793_716925494",
      "id": "paragraph_1655468540793_716925494",
      "dateCreated": "2022-06-17T12:22:20+0000",
      "dateStarted": "2022-06-17T17:03:37+0000",
      "dateFinished": "2022-06-17T17:03:52+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32284"
    },
    {
      "text": "%pyspark\n\nbed_buffer_spark = spark.createDataFrame(bed_buffer)\nbed_buffer_spark.show()",
      "user": "anonymous",
      "dateUpdated": "2022-06-17T17:04:04+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+-------+-------+------+--------+------------------+------------------+--------------------+\n|chromosome|  start|    end|strand|  symbol|           gene_id|start_upstream15kb|start_downstream15kb|\n+----------+-------+-------+------+--------+------------------+------------------+--------------------+\n|      chr1|  65419|  71585|     +|   OR4F5| ENSG00000186092.7|             50419|               76585|\n|      chr1| 450740| 451678|     -|  OR4F29| ENSG00000284733.2|            445740|              466678|\n|      chr1| 685716| 686654|     -|  OR4F16| ENSG00000284662.2|            680716|              701654|\n|      chr1| 923923| 944575|     +|  SAMD11|ENSG00000187634.13|            908923|              949575|\n|      chr1| 944203| 959309|     -|   NOC2L|ENSG00000188976.11|            939203|              974309|\n|      chr1| 960584| 965719|     +|  KLHL17|ENSG00000187961.15|            945584|              970719|\n|      chr1| 966482| 975865|     +| PLEKHN1|ENSG00000187583.11|            951482|              980865|\n|      chr1| 975198| 982117|     -|   PERM1|ENSG00000187642.10|            970198|              997117|\n|      chr1| 998962|1000172|     -|    HES4|ENSG00000188290.11|            993962|             1015172|\n|      chr1|1001138|1014540|     +|   ISG15|ENSG00000187608.10|            986138|             1019540|\n|      chr1|1020120|1056118|     +|    AGRN|ENSG00000188157.15|           1005120|             1061118|\n|      chr1|1070967|1074306|     -|  RNF223| ENSG00000237330.3|           1065967|             1089306|\n|      chr1|1081818|1116361|     -|C1orf159|ENSG00000131591.18|           1076818|             1131361|\n|      chr1|1173880|1197936|     +|  TTLL10|ENSG00000162571.14|           1158880|             1202936|\n|      chr1|1203508|1206592|     -|TNFRSF18|ENSG00000186891.14|           1198508|             1221592|\n|      chr1|1211340|1214153|     -| TNFRSF4|ENSG00000186827.11|           1206340|             1229153|\n|      chr1|1216909|1232067|     -|    SDF4|ENSG00000078808.19|           1211909|             1247067|\n|      chr1|1232237|1235041|     +| B3GALT6| ENSG00000176022.7|           1217237|             1240041|\n|      chr1|1242446|1246722|     -|C1QTNF12| ENSG00000184163.3|           1237446|             1261722|\n|      chr1|1253909|1273864|     -|  UBE2J2|ENSG00000160087.21|           1248909|             1288864|\n+----------+-------+-------+------+--------+------------------+------------------+--------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-181.ec2.internal:4040/jobs/job?id=0",
              "$$hashKey": "object:41289"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655470238153_558881462",
      "id": "paragraph_1655470238153_558881462",
      "dateCreated": "2022-06-17T12:50:38+0000",
      "dateStarted": "2022-06-17T17:04:04+0000",
      "dateFinished": "2022-06-17T17:04:27+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32285"
    },
    {
      "text": "%pyspark\nbed_buffer_spark.repartitionByRange(30, \"chromosome\", \"start\").write\\\n      .mode('overwrite')\\\n      .partitionBy(\"chromosome\")\\\n      .parquet(\"s3a://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet\")",
      "user": "anonymous",
      "dateUpdated": "2022-06-17T17:04:38+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/python",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ip-10-12-3-181.ec2.internal:4040/jobs/job?id=1",
              "$$hashKey": "object:41337"
            },
            {
              "jobUrl": "http://ip-10-12-3-181.ec2.internal:4040/jobs/job?id=2",
              "$$hashKey": "object:41338"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655472931127_2122018951",
      "id": "paragraph_1655472931127_2122018951",
      "dateCreated": "2022-06-17T13:35:31+0000",
      "dateStarted": "2022-06-17T17:04:38+0000",
      "dateFinished": "2022-06-17T17:05:39+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32286"
    },
    {
      "text": "%sh\naws s3 ls s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/\n",
      "user": "anonymous",
      "dateUpdated": "2022-06-17T17:08:03+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "2022-06-17 17:05:31      27106 part-00000-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\n2022-06-17 17:05:17      27096 part-00001-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\n2022-06-17 17:05:07      27448 part-00002-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\n2022-06-17 17:05:23       4045 part-00003-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655484091634_811685814",
      "id": "paragraph_1655484091634_811685814",
      "dateCreated": "2022-06-17T16:41:31+0000",
      "dateStarted": "2022-06-17T17:07:07+0000",
      "dateFinished": "2022-06-17T17:07:07+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32287"
    },
    {
      "text": "%sh\naws s3 cp s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet  ~/cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet --recursive",
      "user": "anonymous",
      "dateUpdated": "2022-06-17T17:09:16+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Completed 6.7 KiB/845.8 KiB (72.0 KiB/s) with 54 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr10/part-00004-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr10/part-00004-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 6.7 KiB/845.8 KiB (72.0 KiB/s) with 53 file(s) remaining\rCompleted 33.2 KiB/845.8 KiB (345.5 KiB/s) with 53 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr1/part-00000-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr1/part-00000-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 33.2 KiB/845.8 KiB (345.5 KiB/s) with 52 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/_SUCCESS to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/_SUCCESS\nCompleted 33.2 KiB/845.8 KiB (345.5 KiB/s) with 51 file(s) remaining\rCompleted 37.1 KiB/845.8 KiB (341.3 KiB/s) with 51 file(s) remaining\rCompleted 59.0 KiB/845.8 KiB (537.0 KiB/s) with 51 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr1/part-00003-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr1/part-00003-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 59.0 KiB/845.8 KiB (537.0 KiB/s) with 50 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr11/part-00004-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr11/part-00004-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 59.0 KiB/845.8 KiB (537.0 KiB/s) with 49 file(s) remaining\rCompleted 85.5 KiB/845.8 KiB (731.6 KiB/s) with 49 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr1/part-00001-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr1/part-00001-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 85.5 KiB/845.8 KiB (731.6 KiB/s) with 48 file(s) remaining\rCompleted 94.9 KiB/845.8 KiB (793.3 KiB/s) with 48 file(s) remaining\rCompleted 118.2 KiB/845.8 KiB (986.6 KiB/s) with 48 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr13/part-00007-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr13/part-00007-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 118.2 KiB/845.8 KiB (986.6 KiB/s) with 47 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr12/part-00006-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr12/part-00006-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 118.2 KiB/845.8 KiB (986.6 KiB/s) with 46 file(s) remaining\rCompleted 142.4 KiB/845.8 KiB (1.1 MiB/s) with 46 file(s) remaining  \rCompleted 149.3 KiB/845.8 KiB (1.1 MiB/s) with 46 file(s) remaining  \rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr15/part-00009-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr15/part-00009-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 149.3 KiB/845.8 KiB (1.1 MiB/s) with 45 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr13/part-00008-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr13/part-00008-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 149.3 KiB/845.8 KiB (1.1 MiB/s) with 44 file(s) remaining\rCompleted 155.0 KiB/845.8 KiB (1.1 MiB/s) with 44 file(s) remaining\rCompleted 174.0 KiB/845.8 KiB (1.2 MiB/s) with 44 file(s) remaining\rCompleted 198.8 KiB/845.8 KiB (1.4 MiB/s) with 44 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr12/part-00007-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr12/part-00007-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 198.8 KiB/845.8 KiB (1.4 MiB/s) with 43 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr11/part-00006-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr11/part-00006-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 198.8 KiB/845.8 KiB (1.4 MiB/s) with 42 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr10/part-00003-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr10/part-00003-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 198.8 KiB/845.8 KiB (1.4 MiB/s) with 41 file(s) remaining\rCompleted 224.9 KiB/845.8 KiB (1.5 MiB/s) with 41 file(s) remaining\rCompleted 251.7 KiB/845.8 KiB (1.7 MiB/s) with 41 file(s) remaining\rCompleted 273.4 KiB/845.8 KiB (1.8 MiB/s) with 41 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr16/part-00010-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr16/part-00010-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 273.4 KiB/845.8 KiB (1.8 MiB/s) with 40 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr14/part-00008-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr14/part-00008-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 273.4 KiB/845.8 KiB (1.8 MiB/s) with 39 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr1/part-00002-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr1/part-00002-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 273.4 KiB/845.8 KiB (1.8 MiB/s) with 38 file(s) remaining\rCompleted 299.6 KiB/845.8 KiB (1.9 MiB/s) with 38 file(s) remaining\rCompleted 308.9 KiB/845.8 KiB (2.0 MiB/s) with 38 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr11/part-00005-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr11/part-00005-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 308.9 KiB/845.8 KiB (2.0 MiB/s) with 37 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr16/part-00011-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr16/part-00011-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 308.9 KiB/845.8 KiB (2.0 MiB/s) with 36 file(s) remaining\rCompleted 313.9 KiB/845.8 KiB (2.0 MiB/s) with 36 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr14/part-00009-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr14/part-00009-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 313.9 KiB/845.8 KiB (2.0 MiB/s) with 35 file(s) remaining\rCompleted 333.2 KiB/845.8 KiB (2.0 MiB/s) with 35 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr17/part-00011-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr17/part-00011-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 333.2 KiB/845.8 KiB (2.0 MiB/s) with 34 file(s) remaining\rCompleted 335.3 KiB/845.8 KiB (2.0 MiB/s) with 34 file(s) remaining\rCompleted 347.5 KiB/845.8 KiB (2.1 MiB/s) with 34 file(s) remaining\rCompleted 373.4 KiB/845.8 KiB (2.2 MiB/s) with 34 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr18/part-00013-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr18/part-00013-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 373.4 KiB/845.8 KiB (2.2 MiB/s) with 33 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr15/part-00010-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr15/part-00010-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 373.4 KiB/845.8 KiB (2.2 MiB/s) with 32 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr17/part-00012-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr17/part-00012-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 373.4 KiB/845.8 KiB (2.2 MiB/s) with 31 file(s) remaining\rCompleted 399.1 KiB/845.8 KiB (2.3 MiB/s) with 31 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr19/part-00014-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr19/part-00014-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 399.1 KiB/845.8 KiB (2.3 MiB/s) with 30 file(s) remaining\rCompleted 413.9 KiB/845.8 KiB (2.4 MiB/s) with 30 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr19/part-00013-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr19/part-00013-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 413.9 KiB/845.8 KiB (2.4 MiB/s) with 29 file(s) remaining\rCompleted 441.0 KiB/845.8 KiB (2.5 MiB/s) with 29 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr2/part-00016-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr2/part-00016-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 441.0 KiB/845.8 KiB (2.5 MiB/s) with 28 file(s) remaining\rCompleted 453.9 KiB/845.8 KiB (2.5 MiB/s) with 28 file(s) remaining\rCompleted 464.0 KiB/845.8 KiB (2.6 MiB/s) with 28 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr20/part-00017-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr20/part-00017-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 464.0 KiB/845.8 KiB (2.6 MiB/s) with 27 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr2/part-00015-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr2/part-00015-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 464.0 KiB/845.8 KiB (2.6 MiB/s) with 26 file(s) remaining\rCompleted 482.3 KiB/845.8 KiB (2.6 MiB/s) with 26 file(s) remaining\rCompleted 486.3 KiB/845.8 KiB (2.6 MiB/s) with 26 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr19/part-00015-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr19/part-00015-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 486.3 KiB/845.8 KiB (2.6 MiB/s) with 25 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr17/part-00013-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr17/part-00013-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 486.3 KiB/845.8 KiB (2.6 MiB/s) with 24 file(s) remaining\rCompleted 496.9 KiB/845.8 KiB (2.6 MiB/s) with 24 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr21/part-00018-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr21/part-00018-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 496.9 KiB/845.8 KiB (2.6 MiB/s) with 23 file(s) remaining\rCompleted 505.3 KiB/845.8 KiB (2.6 MiB/s) with 23 file(s) remaining\rCompleted 516.5 KiB/845.8 KiB (2.7 MiB/s) with 23 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr22/part-00018-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr22/part-00018-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 516.5 KiB/845.8 KiB (2.7 MiB/s) with 22 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr20/part-00018-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr20/part-00018-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 516.5 KiB/845.8 KiB (2.7 MiB/s) with 21 file(s) remaining\rCompleted 543.4 KiB/845.8 KiB (2.7 MiB/s) with 21 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr3/part-00020-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr3/part-00020-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 543.4 KiB/845.8 KiB (2.7 MiB/s) with 20 file(s) remaining\rCompleted 558.9 KiB/845.8 KiB (2.8 MiB/s) with 20 file(s) remaining\rCompleted 560.9 KiB/845.8 KiB (2.8 MiB/s) with 20 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr2/part-00017-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr2/part-00017-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 560.9 KiB/845.8 KiB (2.8 MiB/s) with 19 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr3/part-00021-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr3/part-00021-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 560.9 KiB/845.8 KiB (2.8 MiB/s) with 18 file(s) remaining\rCompleted 573.0 KiB/845.8 KiB (2.8 MiB/s) with 18 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr22/part-00019-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr22/part-00019-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 573.0 KiB/845.8 KiB (2.8 MiB/s) with 17 file(s) remaining\rCompleted 596.2 KiB/845.8 KiB (2.8 MiB/s) with 17 file(s) remaining\rCompleted 613.4 KiB/845.8 KiB (2.9 MiB/s) with 17 file(s) remaining\rCompleted 640.5 KiB/845.8 KiB (3.0 MiB/s) with 17 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr5/part-00022-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr5/part-00022-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 640.5 KiB/845.8 KiB (3.0 MiB/s) with 16 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr4/part-00021-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr4/part-00021-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 640.5 KiB/845.8 KiB (3.0 MiB/s) with 15 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr3/part-00019-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr3/part-00019-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 640.5 KiB/845.8 KiB (3.0 MiB/s) with 14 file(s) remaining\rCompleted 655.3 KiB/845.8 KiB (3.0 MiB/s) with 14 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr6/part-00023-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr6/part-00023-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 655.3 KiB/845.8 KiB (3.0 MiB/s) with 13 file(s) remaining\rCompleted 668.9 KiB/845.8 KiB (3.0 MiB/s) with 13 file(s) remaining\rCompleted 671.6 KiB/845.8 KiB (3.0 MiB/s) with 13 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr6/part-00025-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr6/part-00025-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 671.6 KiB/845.8 KiB (3.0 MiB/s) with 12 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr5/part-00023-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr5/part-00023-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 671.6 KiB/845.8 KiB (3.0 MiB/s) with 11 file(s) remaining\rCompleted 698.1 KiB/845.8 KiB (3.1 MiB/s) with 11 file(s) remaining\rCompleted 703.4 KiB/845.8 KiB (3.1 MiB/s) with 11 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr7/part-00025-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr7/part-00025-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 703.4 KiB/845.8 KiB (3.1 MiB/s) with 10 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr4/part-00022-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr4/part-00022-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 703.4 KiB/845.8 KiB (3.1 MiB/s) with 9 file(s) remaining\rCompleted 719.6 KiB/845.8 KiB (3.1 MiB/s) with 9 file(s) remaining\rCompleted 746.5 KiB/845.8 KiB (3.2 MiB/s) with 9 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr9/part-00027-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr9/part-00027-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 746.5 KiB/845.8 KiB (3.2 MiB/s) with 8 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr6/part-00024-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr6/part-00024-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 746.5 KiB/845.8 KiB (3.2 MiB/s) with 7 file(s) remaining\rCompleted 763.1 KiB/845.8 KiB (3.3 MiB/s) with 7 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr8/part-00026-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr8/part-00026-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 763.1 KiB/845.8 KiB (3.3 MiB/s) with 6 file(s) remaining\rCompleted 775.3 KiB/845.8 KiB (3.3 MiB/s) with 6 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chrX/part-00028-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chrX/part-00028-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 775.3 KiB/845.8 KiB (3.3 MiB/s) with 5 file(s) remaining\rCompleted 788.5 KiB/845.8 KiB (3.3 MiB/s) with 5 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr8/part-00027-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr8/part-00027-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 788.5 KiB/845.8 KiB (3.3 MiB/s) with 4 file(s) remaining\rCompleted 800.7 KiB/845.8 KiB (3.4 MiB/s) with 4 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr7/part-00026-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr7/part-00026-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 800.7 KiB/845.8 KiB (3.4 MiB/s) with 3 file(s) remaining\rCompleted 824.6 KiB/845.8 KiB (3.4 MiB/s) with 3 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chrX/part-00029-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chrX/part-00029-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 824.6 KiB/845.8 KiB (3.4 MiB/s) with 2 file(s) remaining\rCompleted 841.3 KiB/845.8 KiB (3.4 MiB/s) with 2 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chr9/part-00028-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chr9/part-00028-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\nCompleted 841.3 KiB/845.8 KiB (3.4 MiB/s) with 1 file(s) remaining\rCompleted 845.8 KiB/845.8 KiB (3.4 MiB/s) with 1 file(s) remaining\rdownload: s3://kf-strides-variant-parquet-prd/notebooks/5175e6e3-c3d7-4c19-b51f-6f1ea4dd3700/tables/bed_protein_coding.parquet/chromosome=chrY/part-00029-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet to cavatica/projects/taylordm/taylor-urbs-r03-kf-cardiac/bed_protein_coding.parquet/chromosome=chrY/part-00029-9b723546-971a-4f5e-b5f0-168ec6c5b883.c000.snappy.parquet\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1655473042837_1633345293",
      "id": "paragraph_1655473042837_1633345293",
      "dateCreated": "2022-06-17T13:37:22+0000",
      "dateStarted": "2022-06-17T17:09:16+0000",
      "dateFinished": "2022-06-17T17:09:17+0000",
      "status": "FINISHED",
      "$$hashKey": "object:32288"
    },
    {
      "text": "%pyspark\n'''vars_csq_merge_HIGH = vars_csq_merge.where(col('impact') =='HIGH')\nprint(vars_csq_merge_HIGH.count())\n\ndiscovered_HIGH = vars_csq_merge_HIGH.select('unique_variant_id').collect()\ndiscovered_HIGH = set(list(np.unique([i[0] for i in discovered_HIGH])))\n\nUndiscovered_HIGH = highImpact.select('unique_variant_id').collect()\nUndiscovered_HIGH = set(list(np.unique([i[0] for i in Undiscovered_HIGH])))\n\nprint(len(Undiscovered_HIGH))\nprint(len(discovered_HIGH))\n\nprint(len(Undiscovered_HIGH.difference(discovered_HIGH)))\ndiscovered_HIGH.difference(Undiscovered_HIGH)\nhighImpact_sub = highImpact.where(~(F.col('unique_variant_id')).isin(discovered_HIGH))\nhighImpact_sub.count()'''\n",
      "user": "anonymous",
      "dateUpdated": "2022-06-16T14:51:16+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/python"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1654779323572_1281073781",
      "id": "paragraph_1654779323572_1281073781",
      "dateCreated": "2022-06-09T12:55:23+0000",
      "status": "READY",
      "$$hashKey": "object:32289"
    }
  ],
  "name": "map_variants_to_genes",
  "id": "2H5MRT4ND",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {},
  "path": "/gene_burden_testing/map_variants_to_genes"
}